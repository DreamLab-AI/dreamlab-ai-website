import{s as fs,d as o,r as ns,i as le,b as t,q as Fe,l as n,m as vs,g as m,c,e as v,o as Z,u as Te,f as D,j as b,h as f,v as Le,t as y,k as ds,p as us,n as Ge,a as W,z as hs,A as je,w as Qt}from"../chunks/CwRy9Tox.js";import{S as ps,i as _s,t as Qe,a as ze,c as rs,g as is,d as ms,m as bs,b as gs,e as Cs}from"../chunks/D-vqeeah.js";import{g as ks}from"../chunks/D0QH3NT1.js";import{e as Xt}from"../chunks/BFk-VQ8S.js";import{g as Ht}from"../chunks/CQ8JIY5d.js";import{d as os,w as Es,b as Bt}from"../chunks/Box6chXe.js";import{a as Ds}from"../chunks/CHLmt3N8.js";import"../chunks/2VJMwIkg.js";import{c as ys,A as Vs}from"../chunks/DuoXeAqO.js";import{a as Is}from"../chunks/BI-dgP0z.js";const Yt={pendingRequests:[],users:[],channels:[],loading:{requests:!1,users:!1,channels:!1},error:null};function Ms(){const{subscribe:i,set:e,update:s}=Es(Yt);return{subscribe:i,setLoading:(l,a)=>{s(r=>({...r,loading:{...r.loading,[l]:a}}))},setError:l=>{s(a=>({...a,error:l}))},setPendingRequests:l=>{s(a=>({...a,pendingRequests:l,loading:{...a.loading,requests:!1}}))},removePendingRequest:l=>{s(a=>({...a,pendingRequests:a.pendingRequests.filter(r=>r.id!==l)}))},setUsers:l=>{s(a=>({...a,users:l,loading:{...a.loading,users:!1}}))},updateUser:(l,a)=>{s(r=>({...r,users:r.users.map(C=>C.pubkey===l?{...C,...a}:C)}))},setChannels:l=>{s(a=>({...a,channels:l,loading:{...a.loading,channels:!1}}))},addChannel:l=>{s(a=>({...a,channels:[...a.channels,l]}))},updateChannel:(l,a)=>{s(r=>({...r,channels:r.channels.map(C=>C.id===l?{...C,...a}:C)}))},deleteChannel:l=>{s(a=>({...a,channels:a.channels.filter(r=>r.id!==l)}))},reset:()=>e(Yt)}}const cs=Ms();os(cs,i=>{const e=new Map;return i.pendingRequests.forEach(s=>{const l=e.get(s.channelId)||[];e.set(s.channelId,[...l,s])}),e});os(cs,i=>{const e=new Map;return i.users.forEach(s=>{s.cohorts.forEach(l=>{const a=e.get(l)||[];e.set(l,[...a,s])})}),e});const{document:Zt}=ks;function $t(i,e,s){const l=i.slice();return l[16]=e[s],l}function ws(i){let e,s,l,a,r='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>',C,d,h,u=fe(i[0].totalChannels)+"",g,q,_,S="Total Channels",k,V,O=i[0].activeChannels+"",J,j,E,P,H,M='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg>',w,L,B,ae=fe(i[0].totalMessages)+"",ne,F,ee,N="Total Messages",z,T,U=fe(i[9]())+"",I,ve,re,$,x,Ke='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg>',Ae,te,he,pe=fe(i[0].totalUsers)+"",Ce,at,ke,Nt="Total Users",nt,Ee,Rt=i[10]().toFixed(1)+"",rt,it,ot,me,De,qt='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 20V10"></path><path d="M12 20V4"></path><path d="M6 20v-6"></path></svg>',ct,de,ye,We=(i[0].activeChannels/i[0].totalChannels*100).toFixed(0)+"",Xe,ft,vt,Ve,Ut="Engagement Rate",dt,Ie,Ot="Based on 7-day activity",ut,be,ge,Me,jt="Channel Comparison",ht,ue,ie,pt,_t,oe,mt,bt,ce,gt,Ct,_e,we,Ft='<div class="col-channel svelte-1fbcf29">Channel</div> <div class="col-stat svelte-1fbcf29">Messages</div> <div class="col-stat svelte-1fbcf29">Members</div> <div class="col-stat svelte-1fbcf29">Avg/Day</div> <div class="col-stat svelte-1fbcf29">Peak Hour</div> <div class="col-top-poster svelte-1fbcf29">Top Poster</div>',kt,Et,Ye,He,Pe,Dt,Je=new Date(i[0].lastUpdated).toLocaleString()+"",Ze,se,yt,Gt,Q=i[1]==="messages"&&xt(i),X=i[1]==="members"&&es(i),Y=i[1]==="activity"&&ts(i),Be=Xt(i[5]),K=[];for(let p=0;p<Be.length;p+=1)K[p]=ls($t(i,Be,p));let G=i[5].length>0&&i[5][0].activityByDay.length>0&&as(i);return{c(){e=f("div"),s=f("div"),l=f("div"),a=f("div"),a.innerHTML=r,C=b(),d=f("div"),h=f("div"),g=y(u),q=b(),_=f("div"),_.textContent=S,k=b(),V=f("div"),J=y(O),j=y(" active in last 7 days"),E=b(),P=f("div"),H=f("div"),H.innerHTML=M,w=b(),L=f("div"),B=f("div"),ne=y(ae),F=b(),ee=f("div"),ee.textContent=N,z=b(),T=f("div"),I=y(U),ve=y(" including deleted"),re=b(),$=f("div"),x=f("div"),x.innerHTML=Ke,Ae=b(),te=f("div"),he=f("div"),Ce=y(pe),at=b(),ke=f("div"),ke.textContent=Nt,nt=b(),Ee=f("div"),rt=y(Rt),it=y(" avg per channel"),ot=b(),me=f("div"),De=f("div"),De.innerHTML=qt,ct=b(),de=f("div"),ye=f("div"),Xe=y(We),ft=y("%"),vt=b(),Ve=f("div"),Ve.textContent=Ut,dt=b(),Ie=f("div"),Ie.textContent=Ot,ut=b(),be=f("div"),ge=f("div"),Me=f("h2"),Me.textContent=jt,ht=b(),ue=f("div"),ie=f("button"),pt=y(`Messages
              `),Q&&Q.c(),_t=b(),oe=f("button"),mt=y(`Members
              `),X&&X.c(),bt=b(),ce=f("button"),gt=y(`Activity
              `),Y&&Y.c(),Ct=b(),_e=f("div"),we=f("div"),we.innerHTML=Ft,kt=b();for(let p=0;p<K.length;p+=1)K[p].c();Et=b(),G&&G.c(),Ye=b(),He=f("div"),Pe=f("span"),Dt=y("Last updated: "),Ze=y(Je),this.h()},l(p){e=c(p,"DIV",{class:!0});var A=v(e);s=c(A,"DIV",{class:!0});var R=v(s);l=c(R,"DIV",{class:!0});var Se=v(l);a=c(Se,"DIV",{class:!0,"data-svelte-h":!0}),Z(a)!=="svelte-1d460y5"&&(a.innerHTML=r),C=m(Se),d=c(Se,"DIV",{class:!0});var Ne=v(d);h=c(Ne,"DIV",{class:!0});var zt=v(h);g=D(zt,u),zt.forEach(o),q=m(Ne),_=c(Ne,"DIV",{class:!0,"data-svelte-h":!0}),Z(_)!=="svelte-kmoo3u"&&(_.textContent=S),k=m(Ne),V=c(Ne,"DIV",{class:!0});var Vt=v(V);J=D(Vt,O),j=D(Vt," active in last 7 days"),Vt.forEach(o),Ne.forEach(o),Se.forEach(o),E=m(R),P=c(R,"DIV",{class:!0});var $e=v(P);H=c($e,"DIV",{class:!0,"data-svelte-h":!0}),Z(H)!=="svelte-jgo8fo"&&(H.innerHTML=M),w=m($e),L=c($e,"DIV",{class:!0});var Re=v(L);B=c(Re,"DIV",{class:!0});var Kt=v(B);ne=D(Kt,ae),Kt.forEach(o),F=m(Re),ee=c(Re,"DIV",{class:!0,"data-svelte-h":!0}),Z(ee)!=="svelte-1h50s8y"&&(ee.textContent=N),z=m(Re),T=c(Re,"DIV",{class:!0});var It=v(T);I=D(It,U),ve=D(It," including deleted"),It.forEach(o),Re.forEach(o),$e.forEach(o),re=m(R),$=c(R,"DIV",{class:!0});var xe=v($);x=c(xe,"DIV",{class:!0,"data-svelte-h":!0}),Z(x)!=="svelte-1y6t97o"&&(x.innerHTML=Ke),Ae=m(xe),te=c(xe,"DIV",{class:!0});var qe=v(te);he=c(qe,"DIV",{class:!0});var Wt=v(he);Ce=D(Wt,pe),Wt.forEach(o),at=m(qe),ke=c(qe,"DIV",{class:!0,"data-svelte-h":!0}),Z(ke)!=="svelte-1bt02cg"&&(ke.textContent=Nt),nt=m(qe),Ee=c(qe,"DIV",{class:!0});var Mt=v(Ee);rt=D(Mt,Rt),it=D(Mt," avg per channel"),Mt.forEach(o),qe.forEach(o),xe.forEach(o),ot=m(R),me=c(R,"DIV",{class:!0});var et=v(me);De=c(et,"DIV",{class:!0,"data-svelte-h":!0}),Z(De)!=="svelte-1wtw24s"&&(De.innerHTML=qt),ct=m(et),de=c(et,"DIV",{class:!0});var Ue=v(de);ye=c(Ue,"DIV",{class:!0});var wt=v(ye);Xe=D(wt,We),ft=D(wt,"%"),wt.forEach(o),vt=m(Ue),Ve=c(Ue,"DIV",{class:!0,"data-svelte-h":!0}),Z(Ve)!=="svelte-e2rgmf"&&(Ve.textContent=Ut),dt=m(Ue),Ie=c(Ue,"DIV",{class:!0,"data-svelte-h":!0}),Z(Ie)!=="svelte-1r2kldg"&&(Ie.textContent=Ot),Ue.forEach(o),et.forEach(o),R.forEach(o),ut=m(A),be=c(A,"DIV",{class:!0});var tt=v(be);ge=c(tt,"DIV",{class:!0});var st=v(ge);Me=c(st,"H2",{class:!0,"data-svelte-h":!0}),Z(Me)!=="svelte-1p1nxo2"&&(Me.textContent=jt),ht=m(st),ue=c(st,"DIV",{class:!0});var Oe=v(ue);ie=c(Oe,"BUTTON",{class:!0});var Pt=v(ie);pt=D(Pt,`Messages
              `),Q&&Q.l(Pt),Pt.forEach(o),_t=m(Oe),oe=c(Oe,"BUTTON",{class:!0});var St=v(oe);mt=D(St,`Members
              `),X&&X.l(St),St.forEach(o),bt=m(Oe),ce=c(Oe,"BUTTON",{class:!0});var Tt=v(ce);gt=D(Tt,`Activity
              `),Y&&Y.l(Tt),Tt.forEach(o),Oe.forEach(o),st.forEach(o),Ct=m(tt),_e=c(tt,"DIV",{class:!0});var lt=v(_e);we=c(lt,"DIV",{class:!0,"data-svelte-h":!0}),Z(we)!=="svelte-j9vcbj"&&(we.innerHTML=Ft),kt=m(lt);for(let At=0;At<K.length;At+=1)K[At].l(lt);lt.forEach(o),tt.forEach(o),Et=m(A),G&&G.l(A),Ye=m(A),He=c(A,"DIV",{class:!0});var Jt=v(He);Pe=c(Jt,"SPAN",{class:!0});var Lt=v(Pe);Dt=D(Lt,"Last updated: "),Ze=D(Lt,Je),Lt.forEach(o),Jt.forEach(o),A.forEach(o),this.h()},h(){n(a,"class","metric-icon channels svelte-1fbcf29"),n(h,"class","metric-value svelte-1fbcf29"),n(_,"class","metric-label svelte-1fbcf29"),n(V,"class","metric-detail svelte-1fbcf29"),n(d,"class","metric-content svelte-1fbcf29"),n(l,"class","metric-card svelte-1fbcf29"),n(H,"class","metric-icon messages svelte-1fbcf29"),n(B,"class","metric-value svelte-1fbcf29"),n(ee,"class","metric-label svelte-1fbcf29"),n(T,"class","metric-detail svelte-1fbcf29"),n(L,"class","metric-content svelte-1fbcf29"),n(P,"class","metric-card svelte-1fbcf29"),n(x,"class","metric-icon users svelte-1fbcf29"),n(he,"class","metric-value svelte-1fbcf29"),n(ke,"class","metric-label svelte-1fbcf29"),n(Ee,"class","metric-detail svelte-1fbcf29"),n(te,"class","metric-content svelte-1fbcf29"),n($,"class","metric-card svelte-1fbcf29"),n(De,"class","metric-icon engagement svelte-1fbcf29"),n(ye,"class","metric-value svelte-1fbcf29"),n(Ve,"class","metric-label svelte-1fbcf29"),n(Ie,"class","metric-detail svelte-1fbcf29"),n(de,"class","metric-content svelte-1fbcf29"),n(me,"class","metric-card svelte-1fbcf29"),n(s,"class","global-metrics svelte-1fbcf29"),n(Me,"class","svelte-1fbcf29"),n(ie,"class","sort-button svelte-1fbcf29"),je(ie,"active",i[1]==="messages"),n(oe,"class","sort-button svelte-1fbcf29"),je(oe,"active",i[1]==="members"),n(ce,"class","sort-button svelte-1fbcf29"),je(ce,"active",i[1]==="activity"),n(ue,"class","sort-controls svelte-1fbcf29"),n(ge,"class","section-header svelte-1fbcf29"),n(we,"class","table-header svelte-1fbcf29"),n(_e,"class","channel-table svelte-1fbcf29"),n(be,"class","section svelte-1fbcf29"),n(Pe,"class","last-updated svelte-1fbcf29"),n(He,"class","stats-footer svelte-1fbcf29"),n(e,"class","stats-content svelte-1fbcf29")},m(p,A){le(p,e,A),t(e,s),t(s,l),t(l,a),t(l,C),t(l,d),t(d,h),t(h,g),t(d,q),t(d,_),t(d,k),t(d,V),t(V,J),t(V,j),t(s,E),t(s,P),t(P,H),t(P,w),t(P,L),t(L,B),t(B,ne),t(L,F),t(L,ee),t(L,z),t(L,T),t(T,I),t(T,ve),t(s,re),t(s,$),t($,x),t($,Ae),t($,te),t(te,he),t(he,Ce),t(te,at),t(te,ke),t(te,nt),t(te,Ee),t(Ee,rt),t(Ee,it),t(s,ot),t(s,me),t(me,De),t(me,ct),t(me,de),t(de,ye),t(ye,Xe),t(ye,ft),t(de,vt),t(de,Ve),t(de,dt),t(de,Ie),t(e,ut),t(e,be),t(be,ge),t(ge,Me),t(ge,ht),t(ge,ue),t(ue,ie),t(ie,pt),Q&&Q.m(ie,null),t(ue,_t),t(ue,oe),t(oe,mt),X&&X.m(oe,null),t(ue,bt),t(ue,ce),t(ce,gt),Y&&Y.m(ce,null),t(be,Ct),t(be,_e),t(_e,we),t(_e,kt);for(let R=0;R<K.length;R+=1)K[R]&&K[R].m(_e,null);t(e,Et),G&&G.m(e,null),t(e,Ye),t(e,He),t(He,Pe),t(Pe,Dt),t(Pe,Ze),se=!0,yt||(Gt=[Fe(ie,"click",i[11]),Fe(oe,"click",i[12]),Fe(ce,"click",i[13])],yt=!0)},p(p,A){if((!se||A&1)&&u!==(u=fe(p[0].totalChannels)+"")&&W(g,u),(!se||A&1)&&O!==(O=p[0].activeChannels+"")&&W(J,O),(!se||A&1)&&ae!==(ae=fe(p[0].totalMessages)+"")&&W(ne,ae),(!se||A&1)&&pe!==(pe=fe(p[0].totalUsers)+"")&&W(Ce,pe),(!se||A&1)&&We!==(We=(p[0].activeChannels/p[0].totalChannels*100).toFixed(0)+"")&&W(Xe,We),p[1]==="messages"?Q?Q.p(p,A):(Q=xt(p),Q.c(),Q.m(ie,null)):Q&&(Q.d(1),Q=null),(!se||A&2)&&je(ie,"active",p[1]==="messages"),p[1]==="members"?X?X.p(p,A):(X=es(p),X.c(),X.m(oe,null)):X&&(X.d(1),X=null),(!se||A&2)&&je(oe,"active",p[1]==="members"),p[1]==="activity"?Y?Y.p(p,A):(Y=ts(p),Y.c(),Y.m(ce,null)):Y&&(Y.d(1),Y=null),(!se||A&2)&&je(ce,"active",p[1]==="activity"),A&32){Be=Xt(p[5]);let R;for(R=0;R<Be.length;R+=1){const Se=$t(p,Be,R);K[R]?K[R].p(Se,A):(K[R]=ls(Se),K[R].c(),K[R].m(_e,null))}for(;R<K.length;R+=1)K[R].d(1);K.length=Be.length}p[5].length>0&&p[5][0].activityByDay.length>0?G?(G.p(p,A),A&32&&ze(G,1)):(G=as(p),G.c(),ze(G,1),G.m(e,Ye)):G&&(is(),Qe(G,1,1,()=>{G=null}),rs()),(!se||A&1)&&Je!==(Je=new Date(p[0].lastUpdated).toLocaleString()+"")&&W(Ze,Je)},i(p){se||(ze(G),se=!0)},o(p){Qe(G),se=!1},d(p){p&&o(e),Q&&Q.d(),X&&X.d(),Y&&Y.d(),hs(K,p),G&&G.d(),yt=!1,ns(Gt)}}}function Ps(i){let e,s,l,a,r,C="Retry",d,h;return{c(){e=f("div"),s=f("p"),l=y(i[4]),a=b(),r=f("button"),r.textContent=C,this.h()},l(u){e=c(u,"DIV",{class:!0});var g=v(e);s=c(g,"P",{class:!0});var q=v(s);l=D(q,i[4]),q.forEach(o),a=m(g),r=c(g,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(r)!=="svelte-17bkin7"&&(r.textContent=C),g.forEach(o),this.h()},h(){n(s,"class","error-message svelte-1fbcf29"),n(r,"class","retry-button svelte-1fbcf29"),n(e,"class","error-state svelte-1fbcf29")},m(u,g){le(u,e,g),t(e,s),t(s,l),t(e,a),t(e,r),d||(h=Fe(r,"click",i[6]),d=!0)},p(u,g){g&16&&W(l,u[4])},i:Ge,o:Ge,d(u){u&&o(e),d=!1,h()}}}function Ss(i){let e,s='<div class="spinner svelte-1fbcf29"></div> <p>Loading platform statistics...</p>';return{c(){e=f("div"),e.innerHTML=s,this.h()},l(l){e=c(l,"DIV",{class:!0,"data-svelte-h":!0}),Z(e)!=="svelte-kzwwaj"&&(e.innerHTML=s),this.h()},h(){n(e,"class","loading-state svelte-1fbcf29")},m(l,a){le(l,e,a)},p:Ge,i:Ge,o:Ge,d(l){l&&o(e)}}}function xt(i){let e,s=i[2]==="desc"?"↓":"↑",l;return{c(){e=f("span"),l=y(s),this.h()},l(a){e=c(a,"SPAN",{class:!0});var r=v(e);l=D(r,s),r.forEach(o),this.h()},h(){n(e,"class","sort-arrow svelte-1fbcf29")},m(a,r){le(a,e,r),t(e,l)},p(a,r){r&4&&s!==(s=a[2]==="desc"?"↓":"↑")&&W(l,s)},d(a){a&&o(e)}}}function es(i){let e,s=i[2]==="desc"?"↓":"↑",l;return{c(){e=f("span"),l=y(s),this.h()},l(a){e=c(a,"SPAN",{class:!0});var r=v(e);l=D(r,s),r.forEach(o),this.h()},h(){n(e,"class","sort-arrow svelte-1fbcf29")},m(a,r){le(a,e,r),t(e,l)},p(a,r){r&4&&s!==(s=a[2]==="desc"?"↓":"↑")&&W(l,s)},d(a){a&&o(e)}}}function ts(i){let e,s=i[2]==="desc"?"↓":"↑",l;return{c(){e=f("span"),l=y(s),this.h()},l(a){e=c(a,"SPAN",{class:!0});var r=v(e);l=D(r,s),r.forEach(o),this.h()},h(){n(e,"class","sort-arrow svelte-1fbcf29")},m(a,r){le(a,e,r),t(e,l)},p(a,r){r&4&&s!==(s=a[2]==="desc"?"↓":"↑")&&W(l,s)},d(a){a&&o(e)}}}function Ts(i){let e,s="N/A";return{c(){e=f("span"),e.textContent=s,this.h()},l(l){e=c(l,"SPAN",{class:!0,"data-svelte-h":!0}),Z(e)!=="svelte-1xu032k"&&(e.textContent=s),this.h()},h(){n(e,"class","text-muted svelte-1fbcf29")},m(l,a){le(l,e,a)},p:Ge,d(l){l&&o(e)}}}function Ls(i){let e,s,l,a=(i[16].topPosters[0].name||`${i[16].topPosters[0].pubkey.slice(0,8)}...`)+"",r,C,d,h,u=i[16].topPosters[0].messageCount+"",g,q,_=i[16].topPosters[0].avatar&&ss(i);return{c(){e=f("div"),_&&_.c(),s=b(),l=f("span"),r=y(a),C=b(),d=f("span"),h=y("("),g=y(u),q=y(")"),this.h()},l(S){e=c(S,"DIV",{class:!0});var k=v(e);_&&_.l(k),s=m(k),l=c(k,"SPAN",{});var V=v(l);r=D(V,a),V.forEach(o),C=m(k),d=c(k,"SPAN",{class:!0});var O=v(d);h=D(O,"("),g=D(O,u),q=D(O,")"),O.forEach(o),k.forEach(o),this.h()},h(){n(d,"class","poster-count svelte-1fbcf29"),n(e,"class","top-poster svelte-1fbcf29")},m(S,k){le(S,e,k),_&&_.m(e,null),t(e,s),t(e,l),t(l,r),t(e,C),t(e,d),t(d,h),t(d,g),t(d,q)},p(S,k){S[16].topPosters[0].avatar?_?_.p(S,k):(_=ss(S),_.c(),_.m(e,s)):_&&(_.d(1),_=null),k&32&&a!==(a=(S[16].topPosters[0].name||`${S[16].topPosters[0].pubkey.slice(0,8)}...`)+"")&&W(r,a),k&32&&u!==(u=S[16].topPosters[0].messageCount+"")&&W(g,u)},d(S){S&&o(e),_&&_.d()}}}function ss(i){let e,s;return{c(){e=f("img"),this.h()},l(l){e=c(l,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){Qt(e.src,s=i[16].topPosters[0].avatar)||n(e,"src",s),n(e,"alt",""),n(e,"class","poster-avatar-small svelte-1fbcf29")},m(l,a){le(l,e,a)},p(l,a){a&32&&!Qt(e.src,s=l[16].topPosters[0].avatar)&&n(e,"src",s)},d(l){l&&o(e)}}}function ls(i){let e,s,l,a=i[16].channelId.slice(0,16)+"",r,C,d,h,u,g=fe(i[16].messageCount)+"",q,_,S,k,V=fe(i[16].uniquePosters)+"",O,J,j,E,P=i[16].avgMessagesPerDay.toFixed(1)+"",H,M,w,L=i[16].peakHour+"",B,ae,ne,F,ee;function N(U,I){return U[16].topPosters[0]?Ls:Ts}let z=N(i),T=z(i);return{c(){e=f("div"),s=f("div"),l=f("div"),r=y(a),C=y("..."),d=b(),h=f("div"),u=f("strong"),q=y(g),_=b(),S=f("div"),k=f("strong"),O=y(V),J=b(),j=f("div"),E=f("strong"),H=y(P),M=b(),w=f("div"),B=y(L),ae=y(":00"),ne=b(),F=f("div"),T.c(),ee=b(),this.h()},l(U){e=c(U,"DIV",{class:!0});var I=v(e);s=c(I,"DIV",{class:!0});var ve=v(s);l=c(ve,"DIV",{class:!0});var re=v(l);r=D(re,a),C=D(re,"..."),re.forEach(o),ve.forEach(o),d=m(I),h=c(I,"DIV",{class:!0});var $=v(h);u=c($,"STRONG",{});var x=v(u);q=D(x,g),x.forEach(o),$.forEach(o),_=m(I),S=c(I,"DIV",{class:!0});var Ke=v(S);k=c(Ke,"STRONG",{});var Ae=v(k);O=D(Ae,V),Ae.forEach(o),Ke.forEach(o),J=m(I),j=c(I,"DIV",{class:!0});var te=v(j);E=c(te,"STRONG",{});var he=v(E);H=D(he,P),he.forEach(o),te.forEach(o),M=m(I),w=c(I,"DIV",{class:!0});var pe=v(w);B=D(pe,L),ae=D(pe,":00"),pe.forEach(o),ne=m(I),F=c(I,"DIV",{class:!0});var Ce=v(F);T.l(Ce),Ce.forEach(o),ee=m(I),I.forEach(o),this.h()},h(){n(l,"class","channel-id svelte-1fbcf29"),n(s,"class","col-channel svelte-1fbcf29"),n(h,"class","col-stat svelte-1fbcf29"),n(S,"class","col-stat svelte-1fbcf29"),n(j,"class","col-stat svelte-1fbcf29"),n(w,"class","col-stat svelte-1fbcf29"),n(F,"class","col-top-poster svelte-1fbcf29"),n(e,"class","table-row svelte-1fbcf29")},m(U,I){le(U,e,I),t(e,s),t(s,l),t(l,r),t(l,C),t(e,d),t(e,h),t(h,u),t(u,q),t(e,_),t(e,S),t(S,k),t(k,O),t(e,J),t(e,j),t(j,E),t(E,H),t(e,M),t(e,w),t(w,B),t(w,ae),t(e,ne),t(e,F),T.m(F,null),t(e,ee)},p(U,I){I&32&&a!==(a=U[16].channelId.slice(0,16)+"")&&W(r,a),I&32&&g!==(g=fe(U[16].messageCount)+"")&&W(q,g),I&32&&V!==(V=fe(U[16].uniquePosters)+"")&&W(O,V),I&32&&P!==(P=U[16].avgMessagesPerDay.toFixed(1)+"")&&W(H,P),I&32&&L!==(L=U[16].peakHour+"")&&W(B,L),z===(z=N(U))&&T?T.p(U,I):(T.d(1),T=z(U),T&&(T.c(),T.m(F,null)))},d(U){U&&o(e),T.d()}}}function as(i){let e,s,l="Platform Activity Trend",a,r,C;return r=new Vs({props:{data:i[5][0].activityByDay,days:30,height:300}}),{c(){e=f("div"),s=f("h2"),s.textContent=l,a=b(),Cs(r.$$.fragment),this.h()},l(d){e=c(d,"DIV",{class:!0});var h=v(e);s=c(h,"H2",{class:!0,"data-svelte-h":!0}),Z(s)!=="svelte-25o3vf"&&(s.textContent=l),a=m(h),gs(r.$$.fragment,h),h.forEach(o),this.h()},h(){n(s,"class","svelte-1fbcf29"),n(e,"class","section svelte-1fbcf29")},m(d,h){le(d,e,h),t(e,s),t(e,a),bs(r,e,null),C=!0},p(d,h){const u={};h&32&&(u.data=d[5][0].activityByDay),r.$set(u)},i(d){C||(ze(r.$$.fragment,d),C=!0)},o(d){Qe(r.$$.fragment,d),C=!1},d(d){d&&o(e),ms(r)}}}function As(i){let e,s,l,a,r='<h1 class="svelte-1fbcf29">Platform Statistics</h1> <p class="subtitle svelte-1fbcf29">Comprehensive analytics for all channels</p>',C,d,h,u,g,q,_,S,k,V,O,J,j,E,P,H,M,w,L,B,ae;const ne=[Ss,Ps,ws],F=[];function ee(N,z){return N[3]?0:N[4]?1:N[0]?2:-1}return~(M=ee(i))&&(w=F[M]=ne[M](i)),{c(){e=b(),s=f("div"),l=f("div"),a=f("div"),a.innerHTML=r,C=b(),d=f("div"),h=f("button"),u=Le("svg"),g=Le("path"),q=Le("path"),_=y(`
        Refresh`),S=b(),k=f("button"),V=Le("svg"),O=Le("path"),J=Le("polyline"),j=Le("line"),E=y(`
        Export CSV`),H=b(),w&&w.c(),this.h()},l(N){vs("svelte-bmu1xn",Zt.head).forEach(o),e=m(N),s=c(N,"DIV",{class:!0});var T=v(s);l=c(T,"DIV",{class:!0});var U=v(l);a=c(U,"DIV",{class:!0,"data-svelte-h":!0}),Z(a)!=="svelte-ap9gjh"&&(a.innerHTML=r),C=m(U),d=c(U,"DIV",{class:!0});var I=v(d);h=c(I,"BUTTON",{class:!0});var ve=v(h);u=Te(ve,"svg",{width:!0,height:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0});var re=v(u);g=Te(re,"path",{d:!0}),v(g).forEach(o),q=Te(re,"path",{d:!0}),v(q).forEach(o),re.forEach(o),_=D(ve,`
        Refresh`),ve.forEach(o),S=m(I),k=c(I,"BUTTON",{class:!0});var $=v(k);V=Te($,"svg",{width:!0,height:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0});var x=v(V);O=Te(x,"path",{d:!0}),v(O).forEach(o),J=Te(x,"polyline",{points:!0}),v(J).forEach(o),j=Te(x,"line",{x1:!0,y1:!0,x2:!0,y2:!0}),v(j).forEach(o),x.forEach(o),E=D($,`
        Export CSV`),$.forEach(o),I.forEach(o),U.forEach(o),H=m(T),w&&w.l(T),T.forEach(o),this.h()},h(){Zt.title="Platform Statistics - Admin",n(a,"class","header-content svelte-1fbcf29"),n(g,"d","M23 4v6h-6M1 20v-6h6"),n(q,"d","M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"),n(u,"width","16"),n(u,"height","16"),n(u,"viewBox","0 0 24 24"),n(u,"fill","none"),n(u,"stroke","currentColor"),n(u,"stroke-width","2"),n(h,"class","refresh-button svelte-1fbcf29"),h.disabled=i[3],n(O,"d","M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"),n(J,"points","7 10 12 15 17 10"),n(j,"x1","12"),n(j,"y1","15"),n(j,"x2","12"),n(j,"y2","3"),n(V,"width","16"),n(V,"height","16"),n(V,"viewBox","0 0 24 24"),n(V,"fill","none"),n(V,"stroke","currentColor"),n(V,"stroke-width","2"),n(k,"class","export-button svelte-1fbcf29"),k.disabled=P=!i[0],n(d,"class","header-actions svelte-1fbcf29"),n(l,"class","page-header svelte-1fbcf29"),n(s,"class","admin-stats-page svelte-1fbcf29")},m(N,z){le(N,e,z),le(N,s,z),t(s,l),t(l,a),t(l,C),t(l,d),t(d,h),t(h,u),t(u,g),t(u,q),t(h,_),t(d,S),t(d,k),t(k,V),t(V,O),t(V,J),t(V,j),t(k,E),t(s,H),~M&&F[M].m(s,null),L=!0,B||(ae=[Fe(h,"click",i[6]),Fe(k,"click",i[8])],B=!0)},p(N,[z]){(!L||z&8)&&(h.disabled=N[3]),(!L||z&1&&P!==(P=!N[0]))&&(k.disabled=P);let T=M;M=ee(N),M===T?~M&&F[M].p(N,z):(w&&(is(),Qe(F[T],1,1,()=>{F[T]=null}),rs()),~M?(w=F[M],w?w.p(N,z):(w=F[M]=ne[M](N),w.c()),ze(w,1),w.m(s,null)):w=null)},i(N){L||(ze(w),L=!0)},o(N){Qe(w),L=!1},d(N){N&&(o(e),o(s)),~M&&F[M].d(),B=!1,ns(ae)}}}function fe(i){return i.toLocaleString()}function Hs(i,e,s){let l,a;ds(i,Ds,E=>s(15,a=E));let r=null,C=!1,d=null,h=!1,u="messages",g="desc";us(async()=>{if(!a.publicKey){Ht(`${Bt}/`);return}try{if(h=(await Is(a.publicKey)).isAdmin,!h){s(4,d="Access denied: Admin privileges required"),setTimeout(()=>Ht(`${Bt}/chat`),2e3);return}q()}catch(E){console.error("Failed to verify admin status:",E),s(4,d="Failed to verify admin privileges"),setTimeout(()=>Ht(`${Bt}/chat`),2e3)}});async function q(){s(3,C=!0),s(4,d=null);try{s(0,r=await ys.getPlatformStats())}catch(E){s(4,d=E instanceof Error?E.message:"Failed to load statistics"),console.error("Failed to load platform stats:",E)}finally{s(3,C=!1)}}function _(E){u===E?s(2,g=g==="desc"?"asc":"desc"):(s(1,u=E),s(2,g="desc"))}async function S(){if(!r)return;const E=["Channel ID","Messages","Members","Avg Messages/Day","Peak Hour","Top Poster","Top Poster Messages"],P=r.channelStats.map(B=>[B.channelId,B.messageCount.toString(),B.uniquePosters.toString(),B.avgMessagesPerDay.toFixed(2),B.peakHour.toString(),B.topPosters[0]?.name||B.topPosters[0]?.pubkey.slice(0,16)||"N/A",B.topPosters[0]?.messageCount.toString()||"0"]),H=[E.join(","),...P.map(B=>B.join(","))].join(`
`),M=new Blob([H],{type:"text/csv"}),w=URL.createObjectURL(M),L=document.createElement("a");L.href=w,L.download=`platform-stats-${new Date().toISOString().split("T")[0]}.csv`,L.click(),URL.revokeObjectURL(w)}function k(){return r?r.channelStats.reduce((E,P)=>E+P.messageCount,0):0}function V(){return!r||r.totalChannels===0?0:r.channelStats.reduce((P,H)=>P+H.uniquePosters,0)/r.totalChannels}const O=()=>_("messages"),J=()=>_("members"),j=()=>_("activity");return i.$$.update=()=>{i.$$.dirty&7&&s(5,l=r?.channelStats?[...r.channelStats].sort((E,P)=>{let H,M;switch(u){case"messages":H=E.messageCount,M=P.messageCount;break;case"members":H=E.uniquePosters,M=P.uniquePosters;break;case"activity":H=E.avgMessagesPerDay,M=P.avgMessagesPerDay;break}return g==="desc"?M-H:H-M}):[])},[r,u,g,C,d,l,q,_,S,k,V,O,J,j]}class Ks extends ps{constructor(e){super(),_s(this,e,Hs,As,fs,{})}}export{Ks as component};
