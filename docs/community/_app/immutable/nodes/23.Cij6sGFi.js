import{s as ye,K as Ge,L as Je,p as Xe,d as a,z as Qe,a as me,i as N,b as c,l as o,c as h,e as v,u as Q,ad as Ze,g as K,f as q,h as m,v as Z,ae as et,j as L,t as F,q as X,n as ae,o as U,r as De,k as tt,C as Se,P as je,A as Ae,m as nt,x as Pe}from"../chunks/CwRy9Tox.js";import{S as we,i as Ce,f as st,d as ve,t as ue,a as de,m as be,b as ke,e as _e,c as rt,g as lt}from"../chunks/D-vqeeah.js";import{g as ot,b as at,e as it}from"../chunks/CP-hDz56.js";import{a as fe,g as Fe,u as ct,N as ut}from"../chunks/I2mpdA09.js";import{e as Ve}from"../chunks/BFk-VQ8S.js";import{M as dt}from"../chunks/DlVBslhT.js";import{p as ft}from"../chunks/ic1NEA3a.js";import{isConnected as pt,connectRelay as ht,ndk as mt}from"../chunks/DRx8R66N.js";import{R as vt}from"../chunks/CsmHjMo3.js";import{P as bt}from"../chunks/z2CtwCc9.js";import{g as Be}from"../chunks/DKfTTBpB.js";import{b as Ne}from"../chunks/BrNZSoMP.js";import{c as kt,p as _t}from"../chunks/CdekQoOB.js";function He(r,e,n){const t=r.slice();return t[8]=e[n],t[10]=n,t}function Oe(r){let e,n,t,s;function l(){return r[6](r[10])}return{c(){e=m("button"),this.h()},l(i){e=h(i,"BUTTON",{class:!0,"aria-label":!0}),v(e).forEach(a),this.h()},h(){o(e,"class",n="w-2 h-2 rounded-full transition-all "+(r[10]===r[1]?"bg-primary w-8":"bg-base-content/20")),o(e,"aria-label","Go to slide "+(r[10]+1))},m(i,f){N(i,e,f),t||(s=X(e,"click",l),t=!0)},p(i,f){r=i,f&2&&n!==(n="w-2 h-2 rounded-full transition-all "+(r[10]===r[1]?"bg-primary w-8":"bg-base-content/20"))&&o(e,"class",n)},d(i){i&&a(e),t=!1,s()}}}function Ue(r){let e,n="Back",t,s;return{c(){e=m("button"),e.textContent=n,this.h()},l(l){e=h(l,"BUTTON",{class:!0,"data-svelte-h":!0}),U(e)!=="svelte-embpm3"&&(e.textContent=n),this.h()},h(){o(e,"class","btn btn-ghost flex-1")},m(l,i){N(l,e,i),t||(s=X(e,"click",r[4]),t=!0)},p:ae,d(l){l&&a(e),t=!1,s()}}}function gt(r){let e,n="Get Started",t,s;return{c(){e=m("button"),e.textContent=n,this.h()},l(l){e=h(l,"BUTTON",{class:!0,"data-svelte-h":!0}),U(e)!=="svelte-1pfi481"&&(e.textContent=n),this.h()},h(){o(e,"class","btn btn-primary flex-1")},m(l,i){N(l,e,i),t||(s=X(e,"click",r[5]),t=!0)},p:ae,d(l){l&&a(e),t=!1,s()}}}function yt(r){let e,n="Next",t,s;return{c(){e=m("button"),e.textContent=n,this.h()},l(l){e=h(l,"BUTTON",{class:!0,"data-svelte-h":!0}),U(e)!=="svelte-vck9o8"&&(e.textContent=n),this.h()},h(){o(e,"class","btn btn-primary flex-1")},m(l,i){N(l,e,i),t||(s=X(e,"click",r[3]),t=!0)},p:ae,d(l){l&&a(e),t=!1,s()}}}function $e(r){let e,n="Skip Tutorial",t,s;return{c(){e=m("button"),e.textContent=n,this.h()},l(l){e=h(l,"BUTTON",{class:!0,"data-svelte-h":!0}),U(e)!=="svelte-1122ecg"&&(e.textContent=n),this.h()},h(){o(e,"class","btn btn-ghost btn-sm mt-4")},m(l,i){N(l,e,i),t||(s=X(e,"click",r[5]),t=!0)},p:ae,d(l){l&&a(e),t=!1,s()}}}function wt(r){let e,n,t,s,l=r[2][r[1]].icon+"",i,f,u=r[2][r[1]].title+"",p,d,k,x=r[2][r[1]].content+"",B,C,E,I,g,V,W,j=Ve(r[2]),_=[];for(let y=0;y<j.length;y+=1)_[y]=Oe(He(r,j,y));let M=r[1]>0&&Ue(r);function G(y,T){return y[1]<y[2].length-1?yt:gt}let $=G(r),D=$(r),S=r[1]<r[2].length-1&&$e(r);return{c(){e=m("div"),n=m("div"),t=Z("svg"),s=new et(!0),i=L(),f=m("h2"),p=F(u),d=L(),k=m("p"),B=F(x),C=L(),E=m("div");for(let y=0;y<_.length;y+=1)_[y].c();I=L(),g=m("div"),M&&M.c(),V=L(),D.c(),W=L(),S&&S.c(),this.h()},l(y){e=h(y,"DIV",{class:!0});var T=v(e);n=h(T,"DIV",{class:!0});var b=v(n);t=Q(b,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var P=v(t);s=Ze(P,!0),P.forEach(a),b.forEach(a),i=K(T),f=h(T,"H2",{class:!0});var R=v(f);p=q(R,u),R.forEach(a),d=K(T),k=h(T,"P",{class:!0});var O=v(k);B=q(O,x),O.forEach(a),C=K(T),E=h(T,"DIV",{class:!0});var re=v(E);for(let ee=0;ee<_.length;ee+=1)_[ee].l(re);re.forEach(a),I=K(T),g=h(T,"DIV",{class:!0});var J=v(g);M&&M.l(J),V=K(J),D.l(J),J.forEach(a),W=K(T),S&&S.l(T),T.forEach(a),this.h()},h(){s.a=null,o(t,"xmlns","http://www.w3.org/2000/svg"),o(t,"class","h-16 w-16 text-primary"),o(t,"fill","none"),o(t,"viewBox","0 0 24 24"),o(t,"stroke","currentColor"),o(n,"class","bg-primary/10 rounded-full p-6 mb-6"),o(f,"class","text-2xl font-bold mb-4"),o(k,"class","text-base-content/80 mb-8 max-w-md leading-relaxed"),o(E,"class","flex gap-2 mb-8"),o(g,"class","flex gap-3 w-full max-w-md"),o(e,"class","flex flex-col items-center text-center py-6")},m(y,T){N(y,e,T),c(e,n),c(n,t),s.m(l,t),c(e,i),c(e,f),c(f,p),c(e,d),c(e,k),c(k,B),c(e,C),c(e,E);for(let b=0;b<_.length;b+=1)_[b]&&_[b].m(E,null);c(e,I),c(e,g),M&&M.m(g,null),c(g,V),D.m(g,null),c(e,W),S&&S.m(e,null)},p(y,T){if(T&2&&l!==(l=y[2][y[1]].icon+"")&&s.p(l),T&2&&u!==(u=y[2][y[1]].title+"")&&me(p,u),T&2&&x!==(x=y[2][y[1]].content+"")&&me(B,x),T&2){j=Ve(y[2]);let b;for(b=0;b<j.length;b+=1){const P=He(y,j,b);_[b]?_[b].p(P,T):(_[b]=Oe(P),_[b].c(),_[b].m(E,null))}for(;b<_.length;b+=1)_[b].d(1);_.length=j.length}y[1]>0?M?M.p(y,T):(M=Ue(y),M.c(),M.m(g,V)):M&&(M.d(1),M=null),$===($=G(y))&&D?D.p(y,T):(D.d(1),D=$(y),D&&(D.c(),D.m(g,null))),y[1]<y[2].length-1?S?S.p(y,T):(S=$e(y),S.c(),S.m(e,null)):S&&(S.d(1),S=null)},d(y){y&&a(e),Qe(_,y),M&&M.d(),D.d(),S&&S.d()}}}function Ct(r){let e,n,t;function s(i){r[7](i)}let l={size:"md",title:"",closeOnBackdrop:!1,closeOnEscape:!1,$$slots:{default:[wt]},$$scope:{ctx:r}};return r[0]!==void 0&&(l.open=r[0]),e=new dt({props:l}),Ge.push(()=>st(e,"open",s)),{c(){_e(e.$$.fragment)},l(i){ke(e.$$.fragment,i)},m(i,f){be(e,i,f),t=!0},p(i,[f]){const u={};f&2050&&(u.$$scope={dirty:f,ctx:i}),!n&&f&1&&(n=!0,u.open=i[0],Je(()=>n=!1)),e.$set(u)},i(i){t||(de(e.$$.fragment,i),t=!0)},o(i){ue(e.$$.fragment,i),t=!1},d(i){ve(e,i)}}}function xt(r,e,n){let{open:t=!1}=e,s=0;const l=[{title:"Welcome to Nostr",content:"Nostr is a simple, open protocol for decentralized social networking. No central authority, no censorship.",icon:'<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />'},{title:"Your Keys, Your Identity",content:"You control your identity with cryptographic keys. Your public key (npub) is like your username - safe to share. Your private key (nsec) must be kept secret.",icon:'<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z" />'},{title:"Relays Connect You",content:"Relays are servers that store and forward messages. Connect to multiple relays for better reach and reliability. Messages are encrypted end-to-end.",icon:'<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01" />'},{title:"Get Started",content:"Create your account to get started. You'll receive a 12-word recovery phrase - write it down and keep it safe. This is the only way to recover your account.",icon:'<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />'}];function i(){s<l.length-1&&n(1,s++,s)}function f(){s>0&&n(1,s--,s)}function u(){localStorage.setItem("hasSeenOnboarding","true"),n(0,t=!1)}Xe(()=>{localStorage.getItem("hasSeenOnboarding")||n(0,t=!0)});const p=k=>n(1,s=k);function d(k){t=k,n(0,t)}return r.$$set=k=>{"open"in k&&n(0,t=k.open)},[t,s,l,i,f,u,p,d]}class Et extends we{constructor(e){super(),Ce(this,e,xt,Ct,ye,{open:0})}}function Re(r){let e,n,t,s,l,i=r[1].error+"",f;return{c(){e=m("div"),n=Z("svg"),t=Z("path"),s=L(),l=m("span"),f=F(i),this.h()},l(u){e=h(u,"DIV",{class:!0});var p=v(e);n=Q(p,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0});var d=v(n);t=Q(d,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),v(t).forEach(a),d.forEach(a),s=K(p),l=h(p,"SPAN",{});var k=v(l);f=q(k,i),k.forEach(a),p.forEach(a),this.h()},h(){o(t,"stroke-linecap","round"),o(t,"stroke-linejoin","round"),o(t,"stroke-width","2"),o(t,"d","M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"),o(n,"xmlns","http://www.w3.org/2000/svg"),o(n,"class","stroke-current shrink-0 h-6 w-6"),o(n,"fill","none"),o(n,"viewBox","0 0 24 24"),o(e,"class","alert alert-error mb-4")},m(u,p){N(u,e,p),c(e,n),c(n,t),c(e,s),c(e,l),c(l,f)},p(u,p){p&2&&i!==(i=u[1].error+"")&&me(f,i)},d(u){u&&a(e)}}}function It(r){let e;return{c(){e=F("Create Account")},l(n){e=q(n,"Create Account")},m(n,t){N(n,e,t)},d(n){n&&a(e)}}}function Tt(r){let e,n;return{c(){e=m("span"),n=F(`
            Generating...`),this.h()},l(t){e=h(t,"SPAN",{class:!0}),v(e).forEach(a),n=q(t,`
            Generating...`),this.h()},h(){o(e,"class","loading loading-spinner")},m(t,s){N(t,e,s),N(t,n,s)},d(t){t&&(a(e),a(n))}}}function Bt(r){let e,n,t,s,l,i,f,u,p,d,k='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="stroke-current shrink-0 w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span class="text-sm">You&#39;ll receive a private key to backup. Keep it safe!</span>',x,B,C,E,I,g,V="OR",W,j,_="Already have a private key?",M,G,$;e=new Et({});let D=r[1].error&&Re(r);function S(b,P){return b[0]?Tt:It}let y=S(r),T=y(r);return{c(){_e(e.$$.fragment),n=L(),t=m("div"),s=m("div"),l=m("div"),i=m("h2"),f=F("Welcome to "),u=F(r[2]),p=L(),d=m("div"),d.innerHTML=k,x=L(),D&&D.c(),B=L(),C=m("div"),E=m("button"),T.c(),I=L(),g=m("div"),g.textContent=V,W=L(),j=m("button"),j.textContent=_,this.h()},l(b){ke(e.$$.fragment,b),n=K(b),t=h(b,"DIV",{class:!0});var P=v(t);s=h(P,"DIV",{class:!0});var R=v(s);l=h(R,"DIV",{class:!0});var O=v(l);i=h(O,"H2",{class:!0});var re=v(i);f=q(re,"Welcome to "),u=q(re,r[2]),re.forEach(a),p=K(O),d=h(O,"DIV",{class:!0,"data-svelte-h":!0}),U(d)!=="svelte-1d88lo"&&(d.innerHTML=k),x=K(O),D&&D.l(O),B=K(O),C=h(O,"DIV",{class:!0});var J=v(C);E=h(J,"BUTTON",{class:!0});var ee=v(E);T.l(ee),ee.forEach(a),J.forEach(a),I=K(O),g=h(O,"DIV",{class:!0,"data-svelte-h":!0}),U(g)!=="svelte-cr75gt"&&(g.textContent=V),W=K(O),j=h(O,"BUTTON",{class:!0,"data-svelte-h":!0}),U(j)!=="svelte-3nfy78"&&(j.textContent=_),O.forEach(a),R.forEach(a),P.forEach(a),this.h()},h(){o(i,"class","card-title text-2xl justify-center mb-4"),o(d,"class","alert alert-info mb-4"),o(E,"class","btn btn-primary btn-lg w-full"),E.disabled=r[0],o(C,"class","card-actions justify-center mt-4"),o(g,"class","divider"),o(j,"class","btn btn-ghost btn-sm"),o(l,"class","card-body"),o(s,"class","card w-full max-w-md bg-base-100 shadow-xl"),o(t,"class","flex flex-col items-center justify-center min-h-screen p-4 bg-base-200 gradient-mesh")},m(b,P){be(e,b,P),N(b,n,P),N(b,t,P),c(t,s),c(s,l),c(l,i),c(i,f),c(i,u),c(l,p),c(l,d),c(l,x),D&&D.m(l,null),c(l,B),c(l,C),c(C,E),T.m(E,null),c(l,I),c(l,g),c(l,W),c(l,j),M=!0,G||($=[X(E,"click",r[4]),X(j,"click",r[5])],G=!0)},p(b,[P]){b[1].error?D?D.p(b,P):(D=Re(b),D.c(),D.m(l,B)):D&&(D.d(1),D=null),y!==(y=S(b))&&(T.d(1),T=y(b),T&&(T.c(),T.m(E,null))),(!M||P&1)&&(E.disabled=b[0])},i(b){M||(de(e.$$.fragment,b),M=!0)},o(b){ue(e.$$.fragment,b),M=!1},d(b){b&&(a(n),a(t)),ve(e,b),D&&D.d(),T.d(),G=!1,De($)}}}function Nt(r,e,n){let t;tt(r,fe,d=>n(1,t=d));const l=Fe().name.split(" - ")[0],i=Se();let f=!1;async function u(){n(0,f=!0),fe.clearError();try{await new Promise(x=>setTimeout(x,100));const{publicKey:d,privateKey:k}=ot();i("next",{publicKey:d,privateKey:k})}catch(d){fe.setError(d instanceof Error?d.message:"Failed to generate keys")}finally{n(0,f=!1)}}return[f,t,l,i,u,()=>i("next",{publicKey:"",privateKey:""})]}class Mt extends we{constructor(e){super(),Ce(this,e,Nt,Bt,ye,{})}}const Me=new Uint8Array([231,1]),Dt="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";function We(r){const e=r.toLowerCase().trim();if(!/^[a-f0-9]{64}$/.test(e))throw new Error("Invalid pubkey: must be 64 lowercase hex characters");return`did:nostr:${e}`}function St(r){let e=BigInt(0);for(const t of r)e=e*BigInt(256)+BigInt(t);let n="";for(;e>0;){const t=e%BigInt(58);n=Dt[Number(t)]+n,e=e/BigInt(58)}for(const t of r)if(t===0)n="1"+n;else break;return n||"1"}function Kt(r){const e=ct.hexToBytes(r),n=new Uint8Array(Me.length+e.length);return n.set(Me,0),n.set(e,Me.length),"z"+St(n)}function Lt(r,e){const n=We(r),t=`${n}#key-0`,s=Kt(r);return{"@context":["https://www.w3.org/ns/did/v1","https://w3id.org/security/multikey/v1","https://w3id.org/security/data-integrity/v2"],id:n,verificationMethod:[{id:t,type:"Multikey",controller:n,publicKeyMultibase:s}],authentication:[t],assertionMethod:[t],capabilityInvocation:[t],capabilityDelegation:[t]}}function jt(r){let e,n,t,s,l,i,f;return{c(){e=m("div"),n=m("div"),t=m("button"),s=Z("svg"),l=Z("path"),this.h()},l(u){e=h(u,"DIV",{class:!0});var p=v(e);n=h(p,"DIV",{class:!0,"data-tip":!0});var d=v(n);t=h(d,"BUTTON",{class:!0,type:!0});var k=v(t);s=Q(k,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var x=v(s);l=Q(x,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),v(l).forEach(a),x.forEach(a),k.forEach(a),d.forEach(a),p.forEach(a),this.h()},h(){o(l,"stroke-linecap","round"),o(l,"stroke-linejoin","round"),o(l,"stroke-width","2"),o(l,"d",At(r[2].icon)),o(s,"xmlns","http://www.w3.org/2000/svg"),o(s,"class","h-5 w-5 "+r[2].color+" svelte-1nxq475"),o(s,"fill","none"),o(s,"viewBox","0 0 24 24"),o(s,"stroke","currentColor"),o(t,"class","btn btn-circle btn-ghost btn-xs"),o(t,"type","button"),o(n,"class",i="tooltip tooltip-"+r[0]+" svelte-1nxq475"),o(n,"data-tip",r[2].title+": "+r[2].text),o(e,"class",f="security-tooltip "+(r[1]?"inline-block":"")+" svelte-1nxq475")},m(u,p){N(u,e,p),c(e,n),c(n,t),c(t,s),c(s,l)},p(u,[p]){p&1&&i!==(i="tooltip tooltip-"+u[0]+" svelte-1nxq475")&&o(n,"class",i),p&2&&f!==(f="security-tooltip "+(u[1]?"inline-block":"")+" svelte-1nxq475")&&o(e,"class",f)},i:ae,o:ae,d(u){u&&a(e)}}}function At(r){switch(r){case"key":return"M15.75 5.25a3 3 0 013 3m3 0a6 6 0 01-7.029 5.912c-.563-.097-1.159.026-1.563.43L10.5 17.25H8.25v2.25H6v2.25H2.25v-2.818c0-.597.237-1.17.659-1.591l6.499-6.499c.404-.404.527-1 .43-1.563A6 6 0 1121.75 8.25z";case"lock-open":return"M13.5 10.5V6.75a4.5 4.5 0 119 0v3.75M3.75 21.75h10.5a2.25 2.25 0 002.25-2.25v-6.75a2.25 2.25 0 00-2.25-2.25H3.75a2.25 2.25 0 00-2.25 2.25v6.75a2.25 2.25 0 002.25 2.25z";case"shield":return"M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285z";case"key-pair":return"M16.5 10.5V6.75a4.5 4.5 0 10-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 002.25-2.25v-6.75a2.25 2.25 0 00-2.25-2.25H6.75a2.25 2.25 0 00-2.25 2.25v6.75a2.25 2.25 0 002.25 2.25z";default:return""}}function Pt(r,e,n){let{type:t}=e,{position:s="top"}=e,{inline:l=!1}=e;const f={"private-key":{icon:"key",title:"What is a Private Key?",text:"Your private key (nsec) is like a master password for your Nostr account. It proves you own the account and lets you create posts, messages, and reactions. Anyone with your private key can impersonate you, so NEVER share it.",color:"text-error"},"public-key":{icon:"lock-open",title:"What is a Public Key?",text:"Your public key (npub) is your Nostr identity that others use to find and message you. It's safe to share publicly - think of it like your email address or username.",color:"text-info"},backup:{icon:"shield",title:"Why Backup is Important",text:"Nostr accounts are controlled by cryptographic keys, not passwords. If you lose your recovery phrase, there is NO way to recover your account - not even Nostr developers can help. Write it down on paper and store it somewhere safe.",color:"text-warning"},"nostr-keys":{icon:"key-pair",title:"How Nostr Keys Work",text:"Nostr uses two keys: a public key (npub) that identifies you, and a private key (nsec) that proves you control that identity. This is similar to Bitcoin and other cryptocurrencies. Your keys stay with you, not on any server.",color:"text-primary"}}[t];return r.$$set=u=>{"type"in u&&n(3,t=u.type),"position"in u&&n(0,s=u.position),"inline"in u&&n(1,l=u.inline)},[s,l,f,t]}class Vt extends we{constructor(e){super(),Ce(this,e,Pt,jt,ye,{type:3,position:0,inline:1})}}function Ht(r){let e,n,t=`<div class="badge badge-error badge-lg gap-1 animate-pulse"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path></svg>
              PRIVATE - Keep Secret</div>`,s,l,i,f="Your Private Key (nsec)",u,p,d,k,x,B,C,E,I,g,V,W,j,_,M,G,$,D,S='<span class="label-text font-medium">I have securely backed up my private key</span> <span class="text-xs text-base-content/60">I understand I cannot recover my account without it</span>',y,T,b,P,R,O,re;function J(w,H){return w[2]?$t:Ut}let ee=J(r),le=ee(r);function xe(w,H){return w[3]?zt:Rt}let pe=xe(r),te=pe(r);function ne(w,H){return w[0]?qt:Yt}let z=ne(r),oe=z(r);function he(w,H){return w[0]?w[1]?Ft:Wt:Gt}let se=he(r),A=se(r);return{c(){e=m("div"),n=m("div"),n.innerHTML=t,s=L(),l=m("div"),i=m("label"),i.textContent=f,u=L(),p=m("p"),d=F(r[6]),k=L(),x=m("div"),B=m("button"),le.c(),E=L(),I=m("button"),te.c(),V=L(),oe.c(),W=L(),j=m("div"),_=m("label"),M=m("input"),$=L(),D=m("div"),D.innerHTML=S,T=L(),b=m("div"),P=m("button"),A.c(),this.h()},l(w){e=h(w,"DIV",{class:!0});var H=v(e);n=h(H,"DIV",{class:!0,"data-svelte-h":!0}),U(n)!=="svelte-1lsxknd"&&(n.innerHTML=t),s=K(H),l=h(H,"DIV",{class:!0});var Y=v(l);i=h(Y,"LABEL",{class:!0,"data-svelte-h":!0}),U(i)!=="svelte-1puowlp"&&(i.textContent=f),u=K(Y),p=h(Y,"P",{class:!0});var ie=v(p);d=q(ie,r[6]),ie.forEach(a),Y.forEach(a),k=K(H),x=h(H,"DIV",{class:!0});var ce=v(x);B=h(ce,"BUTTON",{class:!0});var ge=v(B);le.l(ge),ge.forEach(a),E=K(ce),I=h(ce,"BUTTON",{class:!0});var Ee=v(I);te.l(Ee),Ee.forEach(a),ce.forEach(a),V=K(H),oe.l(H),W=K(H),j=h(H,"DIV",{class:!0});var Ie=v(j);_=h(Ie,"LABEL",{class:!0});var Te=v(_);M=h(Te,"INPUT",{type:!0,class:!0}),$=K(Te),D=h(Te,"DIV",{class:!0,"data-svelte-h":!0}),U(D)!=="svelte-1nkp8fb"&&(D.innerHTML=S),Te.forEach(a),Ie.forEach(a),H.forEach(a),T=K(w),b=h(w,"DIV",{class:!0});var Ke=v(b);P=h(Ke,"BUTTON",{class:!0});var Le=v(P);A.l(Le),Le.forEach(a),Ke.forEach(a),this.h()},h(){o(n,"class","flex items-center gap-2 mb-3"),o(i,"class","text-sm text-base-content/60 mb-2 block"),o(p,"class","font-mono text-sm break-all bg-base-100 p-3 rounded border border-base-300"),o(l,"class","bg-base-200 rounded-lg p-6 mb-4 border-2 border-error/30"),o(B,"class",C="btn flex-1 gap-2 "+(r[2]||r[0]&&!r[3]?"btn-success":"btn-outline")),o(I,"class",g="btn flex-1 gap-2 "+(r[3]?"btn-success":"btn-outline")),o(x,"class","flex flex-col sm:flex-row gap-3 mb-4"),o(M,"type","checkbox"),o(M,"class","checkbox checkbox-success"),M.disabled=G=!r[0],o(D,"class","flex flex-col"),o(_,"class",y="label cursor-pointer justify-start gap-3 bg-base-200 rounded-lg p-4 border-2 "+(r[1]?"border-success":"border-base-300")),o(j,"class","form-control mb-4"),o(e,"class","mb-6"),o(P,"class","btn btn-primary btn-lg w-full sm:w-auto px-8"),P.disabled=R=!r[5],o(b,"class","card-actions justify-center")},m(w,H){N(w,e,H),c(e,n),c(e,s),c(e,l),c(l,i),c(l,u),c(l,p),c(p,d),c(e,k),c(e,x),c(x,B),le.m(B,null),c(x,E),c(x,I),te.m(I,null),c(e,V),oe.m(e,null),c(e,W),c(e,j),c(j,_),c(_,M),M.checked=r[1],c(_,$),c(_,D),N(w,T,H),N(w,b,H),c(b,P),A.m(P,null),O||(re=[X(B,"click",r[7]),X(I,"click",r[8]),X(M,"change",r[13]),X(P,"click",r[10])],O=!0)},p(w,H){H&64&&me(d,w[6]),ee!==(ee=J(w))&&(le.d(1),le=ee(w),le&&(le.c(),le.m(B,null))),H&13&&C!==(C="btn flex-1 gap-2 "+(w[2]||w[0]&&!w[3]?"btn-success":"btn-outline"))&&o(B,"class",C),pe!==(pe=xe(w))&&(te.d(1),te=pe(w),te&&(te.c(),te.m(I,null))),H&8&&g!==(g="btn flex-1 gap-2 "+(w[3]?"btn-success":"btn-outline"))&&o(I,"class",g),z!==(z=ne(w))&&(oe.d(1),oe=z(w),oe&&(oe.c(),oe.m(e,W))),H&1&&G!==(G=!w[0])&&(M.disabled=G),H&2&&(M.checked=w[1]),H&2&&y!==(y="label cursor-pointer justify-start gap-3 bg-base-200 rounded-lg p-4 border-2 "+(w[1]?"border-success":"border-base-300"))&&o(_,"class",y),se!==(se=he(w))&&(A.d(1),A=se(w),A&&(A.c(),A.m(P,null))),H&32&&R!==(R=!w[5])&&(P.disabled=R)},d(w){w&&(a(e),a(T),a(b)),le.d(),te.d(),oe.d(),A.d(),O=!1,De(re)}}}function Ot(r){let e,n,t=`<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path></svg>
            Reveal Private Key`,s,l,i="Click to reveal your private key for backup",f,u;return{c(){e=m("div"),n=m("button"),n.innerHTML=t,s=L(),l=m("p"),l.textContent=i,this.h()},l(p){e=h(p,"DIV",{class:!0});var d=v(e);n=h(d,"BUTTON",{class:!0,"data-svelte-h":!0}),U(n)!=="svelte-be77x5"&&(n.innerHTML=t),d.forEach(a),s=K(p),l=h(p,"P",{class:!0,"data-svelte-h":!0}),U(l)!=="svelte-t2d4h0"&&(l.textContent=i),this.h()},h(){o(n,"class","btn btn-warning btn-lg gap-2"),o(e,"class","flex justify-center mb-4"),o(l,"class","text-center text-base-content/60 text-sm")},m(p,d){N(p,e,d),c(e,n),N(p,s,d),N(p,l,d),f||(u=X(n,"click",r[9]),f=!0)},p:ae,d(p){p&&(a(e),a(s),a(l)),f=!1,u()}}}function Ut(r){let e,n,t;return{c(){e=Z("svg"),n=Z("path"),t=F(`
                Copy to Clipboard`),this.h()},l(s){e=Q(s,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var l=v(e);n=Q(l,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),v(n).forEach(a),l.forEach(a),t=q(s,`
                Copy to Clipboard`),this.h()},h(){o(n,"stroke-linecap","round"),o(n,"stroke-linejoin","round"),o(n,"stroke-width","2"),o(n,"d","M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"),o(e,"xmlns","http://www.w3.org/2000/svg"),o(e,"class","h-5 w-5"),o(e,"fill","none"),o(e,"viewBox","0 0 24 24"),o(e,"stroke","currentColor")},m(s,l){N(s,e,l),c(e,n),N(s,t,l)},d(s){s&&(a(e),a(t))}}}function $t(r){let e,n,t;return{c(){e=Z("svg"),n=Z("path"),t=F(`
                Copied!`),this.h()},l(s){e=Q(s,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var l=v(e);n=Q(l,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),v(n).forEach(a),l.forEach(a),t=q(s,`
                Copied!`),this.h()},h(){o(n,"stroke-linecap","round"),o(n,"stroke-linejoin","round"),o(n,"stroke-width","2"),o(n,"d","M5 13l4 4L19 7"),o(e,"xmlns","http://www.w3.org/2000/svg"),o(e,"class","h-5 w-5"),o(e,"fill","none"),o(e,"viewBox","0 0 24 24"),o(e,"stroke","currentColor")},m(s,l){N(s,e,l),c(e,n),N(s,t,l)},d(s){s&&(a(e),a(t))}}}function Rt(r){let e,n,t;return{c(){e=Z("svg"),n=Z("path"),t=F(`
                Download Backup File`),this.h()},l(s){e=Q(s,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var l=v(e);n=Q(l,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),v(n).forEach(a),l.forEach(a),t=q(s,`
                Download Backup File`),this.h()},h(){o(n,"stroke-linecap","round"),o(n,"stroke-linejoin","round"),o(n,"stroke-width","2"),o(n,"d","M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"),o(e,"xmlns","http://www.w3.org/2000/svg"),o(e,"class","h-5 w-5"),o(e,"fill","none"),o(e,"viewBox","0 0 24 24"),o(e,"stroke","currentColor")},m(s,l){N(s,e,l),c(e,n),N(s,t,l)},d(s){s&&(a(e),a(t))}}}function zt(r){let e,n,t;return{c(){e=Z("svg"),n=Z("path"),t=F(`
                Downloaded!`),this.h()},l(s){e=Q(s,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var l=v(e);n=Q(l,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),v(n).forEach(a),l.forEach(a),t=q(s,`
                Downloaded!`),this.h()},h(){o(n,"stroke-linecap","round"),o(n,"stroke-linejoin","round"),o(n,"stroke-width","2"),o(n,"d","M5 13l4 4L19 7"),o(e,"xmlns","http://www.w3.org/2000/svg"),o(e,"class","h-5 w-5"),o(e,"fill","none"),o(e,"viewBox","0 0 24 24"),o(e,"stroke","currentColor")},m(s,l){N(s,e,l),c(e,n),N(s,t,l)},d(s){s&&(a(e),a(t))}}}function Yt(r){let e,n='<svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg> <span>You must copy or download your key before continuing.</span>';return{c(){e=m("div"),e.innerHTML=n,this.h()},l(t){e=h(t,"DIV",{class:!0,"data-svelte-h":!0}),U(e)!=="svelte-y8porn"&&(e.innerHTML=n),this.h()},h(){o(e,"class","alert alert-warning mb-4")},m(t,s){N(t,e,s)},d(t){t&&a(e)}}}function qt(r){let e,n='<svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span>Backup action completed. Please store your key securely.</span>';return{c(){e=m("div"),e.innerHTML=n,this.h()},l(t){e=h(t,"DIV",{class:!0,"data-svelte-h":!0}),U(e)!=="svelte-1wvvajp"&&(e.innerHTML=n),this.h()},h(){o(e,"class","alert alert-success mb-4")},m(t,s){N(t,e,s)},d(t){t&&a(e)}}}function Ft(r){let e;return{c(){e=F("Continue")},l(n){e=q(n,"Continue")},m(n,t){N(n,e,t)},d(n){n&&a(e)}}}function Wt(r){let e;return{c(){e=F("Confirm Backup to Continue")},l(n){e=q(n,"Confirm Backup to Continue")},m(n,t){N(n,e,t)},d(n){n&&a(e)}}}function Gt(r){let e;return{c(){e=F("Backup Required First")},l(n){e=q(n,"Backup Required First")},m(n,t){N(n,e,t)},d(n){n&&a(e)}}}function Jt(r){let e,n,t,s,l,i="Backup Your Private Key",f,u,p,d,k='<div class="flex-1"><div class="flex items-start gap-3"><svg xmlns="http://www.w3.org/2000/svg" class="stroke-error shrink-0 h-8 w-8 mt-1" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg> <div class="flex-1"><p class="font-bold text-error text-lg mb-2">CRITICAL: Backup Required</p> <ul class="text-sm space-y-1 text-base-content"><li class="flex items-start gap-2"><span class="text-error font-bold">1.</span> <span>This is your <strong>ONLY way to recover your account</strong></span></li> <li class="flex items-start gap-2"><span class="text-error font-bold">2.</span> <span><strong>Never share this</strong> with anyone - not even support staff</span></li> <li class="flex items-start gap-2"><span class="text-error font-bold">3.</span> <span><strong>Store it securely offline</strong> - paper backup recommended</span></li> <li class="flex items-start gap-2"><span class="text-error font-bold">4.</span> <span>We <strong>cannot recover</strong> lost private keys</span></li></ul></div></div></div>',x,B;u=new Vt({props:{type:"private-key",position:"bottom"}});function C(g,V){return g[4]?Ht:Ot}let E=C(r),I=E(r);return{c(){e=m("div"),n=m("div"),t=m("div"),s=m("div"),l=m("h2"),l.textContent=i,f=L(),_e(u.$$.fragment),p=L(),d=m("div"),d.innerHTML=k,x=L(),I.c(),this.h()},l(g){e=h(g,"DIV",{class:!0});var V=v(e);n=h(V,"DIV",{class:!0});var W=v(n);t=h(W,"DIV",{class:!0});var j=v(t);s=h(j,"DIV",{class:!0});var _=v(s);l=h(_,"H2",{class:!0,"data-svelte-h":!0}),U(l)!=="svelte-1wta1g9"&&(l.textContent=i),f=K(_),ke(u.$$.fragment,_),_.forEach(a),p=K(j),d=h(j,"DIV",{class:!0,"data-svelte-h":!0}),U(d)!=="svelte-ynjkm0"&&(d.innerHTML=k),x=K(j),I.l(j),j.forEach(a),W.forEach(a),V.forEach(a),this.h()},h(){o(l,"class","card-title text-2xl"),o(s,"class","flex items-center justify-center gap-2 mb-4"),o(d,"class","alert bg-error/10 border-2 border-error mb-6 animate-pulse-slow svelte-10y5ct5"),o(t,"class","card-body"),o(n,"class","card w-full max-w-2xl bg-base-100 shadow-xl"),o(e,"class","flex flex-col items-center justify-center min-h-screen p-4 bg-base-200")},m(g,V){N(g,e,V),c(e,n),c(n,t),c(t,s),c(s,l),c(s,f),be(u,s,null),c(t,p),c(t,d),c(t,x),I.m(t,null),B=!0},p(g,[V]){E===(E=C(g))&&I?I.p(g,V):(I.d(1),I=E(g),I&&(I.c(),I.m(t,null)))},i(g){B||(de(u.$$.fragment,g),B=!0)},o(g){ue(u.$$.fragment,g),B=!1},d(g){g&&a(e),ve(u),I.d()}}}function Xt(r,e,n){let t,s,l,i,f,{privateKey:u}=e,{publicKey:p}=e;const d=Se();let k=!1,x=!1,B=!1,C=!1,E=!1;async function I(){try{await navigator.clipboard.writeText(t),n(2,B=!0),n(0,k=!0),setTimeout(()=>{n(2,B=!1)},2e3)}catch(_){console.error("Failed to copy:",_)}}function g(){const _=`NOSTR PRIVATE KEY BACKUP
========================

DO NOT SHARE THIS FILE WITH ANYONE!
This is your ONLY way to recover your account.

Private Key (nsec format):
${t}

Public Key (npub format):
${s}

Decentralized Identifier (DID):
${l}

========================
DID Document (W3C Compliant):
${JSON.stringify(i,null,2)}

========================
Generated: ${new Date().toISOString()}
Store this file securely offline.
`,M=new Blob([_],{type:"text/plain"}),G=URL.createObjectURL(M),$=document.createElement("a");$.href=G,$.download=`nostr-key-backup-${new Date().toISOString().slice(0,10)}.txt`,document.body.appendChild($),$.click(),document.body.removeChild($),URL.revokeObjectURL(G),n(3,C=!0),n(0,k=!0)}function V(){n(4,E=!0)}function W(){f&&d("continue")}function j(){x=this.checked,n(1,x)}return r.$$set=_=>{"privateKey"in _&&n(11,u=_.privateKey),"publicKey"in _&&n(12,p=_.publicKey)},r.$$.update=()=>{r.$$.dirty&2048&&n(6,t=at(u)),r.$$.dirty&4096&&(s=it(p)),r.$$.dirty&4096&&(l=We(p)),r.$$.dirty&4096&&(i=Lt(p)),r.$$.dirty&3&&n(5,f=k&&x)},[k,x,B,C,E,f,t,I,g,V,W,u,p,j]}class Qt extends we{constructor(e){super(),Ce(this,e,Xt,Jt,ye,{privateKey:11,publicKey:12})}}function Zt(r){let e,n="2-50 characters, letters, numbers, and symbols allowed";return{c(){e=m("span"),e.textContent=n,this.h()},l(t){e=h(t,"SPAN",{class:!0,"data-svelte-h":!0}),U(e)!=="svelte-1vzq00z"&&(e.textContent=n),this.h()},h(){o(e,"class","label-text-alt text-base-content/60 mt-1")},m(t,s){N(t,e,s)},p:ae,d(t){t&&a(e)}}}function en(r){let e,n;return{c(){e=m("span"),n=F(r[4]),this.h()},l(t){e=h(t,"SPAN",{class:!0});var s=v(e);n=q(s,r[4]),s.forEach(a),this.h()},h(){o(e,"class","label-text-alt text-error mt-1")},m(t,s){N(t,e,s),c(e,n)},p(t,s){s&16&&me(n,t[4])},d(t){t&&a(e)}}}function ze(r){let e,n,t,s,l,i;return{c(){e=m("div"),n=Z("svg"),t=Z("path"),s=L(),l=m("span"),i=F(r[3]),this.h()},l(f){e=h(f,"DIV",{class:!0});var u=v(e);n=Q(u,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0});var p=v(n);t=Q(p,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),v(t).forEach(a),p.forEach(a),s=K(u),l=h(u,"SPAN",{});var d=v(l);i=q(d,r[3]),d.forEach(a),u.forEach(a),this.h()},h(){o(t,"stroke-linecap","round"),o(t,"stroke-linejoin","round"),o(t,"stroke-width","2"),o(t,"d","M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"),o(n,"xmlns","http://www.w3.org/2000/svg"),o(n,"class","stroke-current shrink-0 h-6 w-6"),o(n,"fill","none"),o(n,"viewBox","0 0 24 24"),o(e,"class","alert alert-error mb-4")},m(f,u){N(f,e,u),c(e,n),c(n,t),c(e,s),c(e,l),c(l,i)},p(f,u){u&8&&me(i,f[3])},d(f){f&&a(e)}}}function tn(r){let e;return{c(){e=F("Continue")},l(n){e=q(n,"Continue")},m(n,t){N(n,e,t)},d(n){n&&a(e)}}}function nn(r){let e,n;return{c(){e=m("span"),n=F(`
            Saving...`),this.h()},l(t){e=h(t,"SPAN",{class:!0}),v(e).forEach(a),n=q(t,`
            Saving...`),this.h()},h(){o(e,"class","loading loading-spinner")},m(t,s){N(t,e,s),N(t,n,s)},d(t){t&&(a(e),a(n))}}}function sn(r){let e,n,t,s,l="Choose Your Nickname",i,f,u="Pick a display name that others will see. You can change this later in your profile settings.",p,d,k='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="stroke-current shrink-0 w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <div class="text-sm"><p class="font-bold">This is how you&#39;ll appear to others</p> <p>Your nickname will be shown instead of your public key throughout the system.</p></div>',x,B,C='<svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg> <div class="text-sm"><p class="font-bold">Nickname required for permissions</p> <p>You must set a nickname to appear on the admin permissions list. Without a nickname, admins cannot grant you additional access to other areas.</p></div>',E,I,g,V,W="Nickname / Handle",j,_,M=r[0].length+"",G,$,D,S,y,T,b,P,R,O,re,J,ee="You can add an avatar and update your profile anytime in Settings.",le,xe;function pe(A,w){return A[4]?en:Zt}let te=pe(r),ne=te(r),z=r[3]&&ze(r);function oe(A,w){return A[2]?nn:tn}let he=oe(r),se=he(r);return{c(){e=m("div"),n=m("div"),t=m("div"),s=m("h2"),s.textContent=l,i=L(),f=m("p"),f.textContent=u,p=L(),d=m("div"),d.innerHTML=k,x=L(),B=m("div"),B.innerHTML=C,E=L(),I=m("div"),g=m("label"),V=m("span"),V.textContent=W,j=L(),_=m("span"),G=F(M),$=F("/50"),D=L(),S=m("input"),y=L(),ne.c(),T=L(),z&&z.c(),b=L(),P=m("div"),R=m("button"),se.c(),re=L(),J=m("p"),J.textContent=ee,this.h()},l(A){e=h(A,"DIV",{class:!0});var w=v(e);n=h(w,"DIV",{class:!0});var H=v(n);t=h(H,"DIV",{class:!0});var Y=v(t);s=h(Y,"H2",{class:!0,"data-svelte-h":!0}),U(s)!=="svelte-18uxpuw"&&(s.textContent=l),i=K(Y),f=h(Y,"P",{class:!0,"data-svelte-h":!0}),U(f)!=="svelte-h06ju"&&(f.textContent=u),p=K(Y),d=h(Y,"DIV",{class:!0,"data-svelte-h":!0}),U(d)!=="svelte-15p70ua"&&(d.innerHTML=k),x=K(Y),B=h(Y,"DIV",{class:!0,"data-svelte-h":!0}),U(B)!=="svelte-1ir8gd0"&&(B.innerHTML=C),E=K(Y),I=h(Y,"DIV",{class:!0});var ie=v(I);g=h(ie,"LABEL",{class:!0,for:!0});var ce=v(g);V=h(ce,"SPAN",{class:!0,"data-svelte-h":!0}),U(V)!=="svelte-1u308jh"&&(V.textContent=W),j=K(ce),_=h(ce,"SPAN",{class:!0});var ge=v(_);G=q(ge,M),$=q(ge,"/50"),ge.forEach(a),ce.forEach(a),D=K(ie),S=h(ie,"INPUT",{type:!0,id:!0,placeholder:!0,class:!0,maxlength:!0}),y=K(ie),ne.l(ie),ie.forEach(a),T=K(Y),z&&z.l(Y),b=K(Y),P=h(Y,"DIV",{class:!0});var Ee=v(P);R=h(Ee,"BUTTON",{class:!0});var Ie=v(R);se.l(Ie),Ie.forEach(a),Ee.forEach(a),re=K(Y),J=h(Y,"P",{class:!0,"data-svelte-h":!0}),U(J)!=="svelte-1dfs5vl"&&(J.textContent=ee),Y.forEach(a),H.forEach(a),w.forEach(a),this.h()},h(){o(s,"class","card-title text-2xl justify-center mb-2"),o(f,"class","text-center text-base-content/70 mb-4"),o(d,"class","alert alert-info mb-4"),o(B,"class","alert alert-warning mb-4"),o(V,"class","label-text font-semibold"),o(_,"class","label-text-alt text-base-content/50"),o(g,"class","label"),o(g,"for","nickname-input"),o(S,"type","text"),o(S,"id","nickname-input"),o(S,"placeholder","e.g., Alice, Bob123, CoolUser"),o(S,"class","input input-bordered input-lg w-full"),o(S,"maxlength","50"),S.disabled=r[2],Ae(S,"input-error",r[4]),o(I,"class","form-control mb-4"),o(R,"class","btn btn-primary btn-lg w-full"),R.disabled=O=!r[1]||r[2],o(P,"class","card-actions flex-col gap-2 mt-4"),o(J,"class","text-xs text-center text-base-content/50 mt-4"),o(t,"class","card-body"),o(n,"class","card w-full max-w-md bg-base-100 shadow-xl"),o(e,"class","flex flex-col items-center justify-center min-h-screen p-4 bg-base-200")},m(A,w){N(A,e,w),c(e,n),c(n,t),c(t,s),c(t,i),c(t,f),c(t,p),c(t,d),c(t,x),c(t,B),c(t,E),c(t,I),c(I,g),c(g,V),c(g,j),c(g,_),c(_,G),c(_,$),c(I,D),c(I,S),je(S,r[0]),c(I,y),ne.m(I,null),c(t,T),z&&z.m(t,null),c(t,b),c(t,P),c(P,R),se.m(R,null),c(t,re),c(t,J),le||(xe=[X(S,"input",r[8]),X(S,"keydown",r[9]),X(R,"click",r[5])],le=!0)},p(A,[w]){w&1&&M!==(M=A[0].length+"")&&me(G,M),w&4&&(S.disabled=A[2]),w&1&&S.value!==A[0]&&je(S,A[0]),w&16&&Ae(S,"input-error",A[4]),te===(te=pe(A))&&ne?ne.p(A,w):(ne.d(1),ne=te(A),ne&&(ne.c(),ne.m(I,null))),A[3]?z?z.p(A,w):(z=ze(A),z.c(),z.m(t,b)):z&&(z.d(1),z=null),he!==(he=oe(A))&&(se.d(1),se=he(A),se&&(se.c(),se.m(R,null))),w&6&&O!==(O=!A[1]||A[2])&&(R.disabled=O)},i:ae,o:ae,d(A){A&&a(e),ne.d(),z&&z.d(),se.d(),le=!1,De(xe)}}}function rn(r,e,n){let t,s,{publicKey:l}=e,{privateKey:i}=e;const f=Se();let u="",p=!1,d=null;async function k(){if(t){n(2,p=!0),n(3,d=null);try{pt()||await ht(vt,i);const C=mt();if(!C)throw new Error("Failed to initialize NDK");const E=new ut(C);E.kind=0,E.content=JSON.stringify({name:u.trim(),display_name:u.trim()}),await E.sign(),await E.publish(),fe.setProfile(u.trim(),null),ft.updateCurrentUserProfile(l,u.trim(),null),f("continue",{nickname:u.trim()})}catch(C){console.error("[NicknameSetup] Failed to publish profile:",C),n(3,d=C instanceof Error?C.message:"Failed to save profile")}finally{n(2,p=!1)}}}function x(){u=this.value,n(0,u)}const B=C=>C.key==="Enter"&&t&&k();return r.$$set=C=>{"publicKey"in C&&n(6,l=C.publicKey),"privateKey"in C&&n(7,i=C.privateKey)},r.$$.update=()=>{r.$$.dirty&1&&n(1,t=u.trim().length>=2&&u.trim().length<=50),r.$$.dirty&3&&n(4,s=u.length>0&&!t?u.trim().length<2?"Nickname must be at least 2 characters":"Nickname must be 50 characters or less":null)},[u,t,p,d,s,k,l,i,x,B]}class ln extends we{constructor(e){super(),Ce(this,e,rn,sn,ye,{publicKey:6,privateKey:7})}}const on="wss://nostr-relay-617806532906.us-central1.run.app";function an(){return on.replace("wss://","https://").replace("ws://","http://")}async function cn(r,e,n=5e3){if(!/^[0-9a-f]{64}$/i.test(r))return console.warn("[ProfileSync] Invalid pubkey format"),!1;const t=Date.now();let s=100,l=0;const i=10;for(;Date.now()-t<n&&l<i;){l++;try{const f=await un(r);if(f)if(e){if((f.name||f.display_name||"").toLowerCase().includes(e.toLowerCase()))return!0}else return!0;await qe(s),s=Math.min(s*2,1e3)}catch{await qe(s),s=Math.min(s*2,1e3)}}return console.warn(`[ProfileSync] Timeout after ${l} attempts (${Date.now()-t}ms)`),!1}async function un(r){const e=an();try{const n=await fetch(`${e}/api/profile?pubkey=${encodeURIComponent(r)}`,{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(2e3)});return n.ok?await n.json():n.status===404?await Ye(r,e):null}catch(n){if(n instanceof TypeError)return await Ye(r,e);throw n}}async function Ye(r,e){try{const n=await fetch(`${e}/api/events?authors=${encodeURIComponent(r)}&kinds=0&limit=1`,{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(2e3)});if(n.ok){const t=await n.json();if(Array.isArray(t)&&t.length>0){const s=t[0].content;try{return JSON.parse(s)}catch{return null}}}return null}catch{return null}}function qe(r){return new Promise(e=>setTimeout(e,r))}function dn(r){let e,n;return e=new bt({props:{publicKey:r[1]}}),e.$on("approved",r[7]),{c(){_e(e.$$.fragment)},l(t){ke(e.$$.fragment,t)},m(t,s){be(e,t,s),n=!0},p(t,s){const l={};s&2&&(l.publicKey=t[1]),e.$set(l)},i(t){n||(de(e.$$.fragment,t),n=!0)},o(t){ue(e.$$.fragment,t),n=!1},d(t){ve(e,t)}}}function fn(r){let e,n;return e=new ln({props:{publicKey:r[1],privateKey:r[2]}}),e.$on("continue",r[6]),{c(){_e(e.$$.fragment)},l(t){ke(e.$$.fragment,t)},m(t,s){be(e,t,s),n=!0},p(t,s){const l={};s&2&&(l.publicKey=t[1]),s&4&&(l.privateKey=t[2]),e.$set(l)},i(t){n||(de(e.$$.fragment,t),n=!0)},o(t){ue(e.$$.fragment,t),n=!1},d(t){ve(e,t)}}}function pn(r){let e,n;return e=new Qt({props:{publicKey:r[1],privateKey:r[2]}}),e.$on("continue",r[5]),{c(){_e(e.$$.fragment)},l(t){ke(e.$$.fragment,t)},m(t,s){be(e,t,s),n=!0},p(t,s){const l={};s&2&&(l.publicKey=t[1]),s&4&&(l.privateKey=t[2]),e.$set(l)},i(t){n||(de(e.$$.fragment,t),n=!0)},o(t){ue(e.$$.fragment,t),n=!1},d(t){ve(e,t)}}}function hn(r){let e,n;return e=new Mt({}),e.$on("next",r[4]),{c(){_e(e.$$.fragment)},l(t){ke(e.$$.fragment,t)},m(t,s){be(e,t,s),n=!0},p:ae,i(t){n||(de(e.$$.fragment,t),n=!0)},o(t){ue(e.$$.fragment,t),n=!1},d(t){ve(e,t)}}}function mn(r){let e,n,t,s,l,i;document.title=e="Sign Up - "+r[3].name;const f=[hn,pn,fn,dn],u=[];function p(d,k){return d[0]==="signup"?0:d[0]==="backup"?1:d[0]==="nickname"?2:d[0]==="pending"?3:-1}return~(t=p(r))&&(s=u[t]=f[t](r)),{c(){n=L(),s&&s.c(),l=Pe()},l(d){nt("svelte-aslb9y",document.head).forEach(a),n=K(d),s&&s.l(d),l=Pe()},m(d,k){N(d,n,k),~t&&u[t].m(d,k),N(d,l,k),i=!0},p(d,[k]){(!i||k&8)&&e!==(e="Sign Up - "+d[3].name)&&(document.title=e);let x=t;t=p(d),t===x?~t&&u[t].p(d,k):(s&&(lt(),ue(u[x],1,1,()=>{u[x]=null}),rt()),~t?(s=u[t],s?s.p(d,k):(s=u[t]=f[t](d),s.c()),de(s,1),s.m(l.parentNode,l)):s=null)},i(d){i||(de(s),i=!0)},o(d){ue(s),i=!1},d(d){d&&(a(n),a(l)),~t&&u[t].d(d)}}}function vn(r,e,n){const t=Fe();let s="signup",l="",i="",f="",u=!1;function p(B){const C=B.detail;C.publicKey&&C.privateKey?(n(1,l=C.publicKey),n(2,i=C.privateKey),n(0,s="backup")):Be(`${Ne}/login`)}async function d(){await fe.setKeys(l,i,"incomplete",!1),fe.confirmNsecBackup(),n(0,s="nickname")}async function k(B){f=B.detail.nickname;const C=await kt(l);if(u=C.isApproved||C.isAdmin,u)Be(`${Ne}/chat`);else{await cn(l,f,5e3);try{const E=await _t(i,f||void 0);E.success||console.warn("[Signup] Failed to publish registration request:",E.error)}catch(E){console.warn("[Signup] Error publishing registration request:",E)}fe.setPending(!0),n(0,s="pending")}}async function x(){fe.setPending(!1),Be(`${Ne}/chat`)}return[s,l,i,t,p,d,k,x]}class Mn extends we{constructor(e){super(),Ce(this,e,vn,mn,ye,{})}}export{Mn as component};
