import{s as ke,d as u,i as j,l as i,m as we,g as B,c as v,e as b,j as H,h as g,k as re,p as ye,n as Y,o as G,a as Z,b as f,f as R,t as x,u as X,v as $,w as ne}from"../chunks/CwRy9Tox.js";import{S as Ee,i as Ce,t as ee,a as te,c as Ie,d as ie,m as ce,b as ue,e as fe,g as Ve}from"../chunks/D-vqeeah.js";import{e as de,u as De,d as Me}from"../chunks/BFk-VQ8S.js";import{g as Se}from"../chunks/DKfTTBpB.js";import{b as K}from"../chunks/BrNZSoMP.js";import{p as Ae}from"../chunks/BgttACkO.js";import{g as Be,a as he,b as He,c as je}from"../chunks/I2mpdA09.js";import{u as Fe}from"../chunks/t4_QlDax.js";import{isConnected as Le,connectRelay as Te,ndk as qe}from"../chunks/DRx8R66N.js";import{R as Pe}from"../chunks/CsmHjMo3.js";import{B as Ne}from"../chunks/CEUdN2vm.js";import"../chunks/D64q0iE0.js";import"../chunks/ic1NEA3a.js";import{Z as Re}from"../chunks/DrczVtFa.js";function me(c,e,t){const r=c.slice();return r[16]=e[t],r}function xe(c){let e,t,r,s,a,o,l,n,m=c[3].icon+"",h,w,p,C,T=c[3].name+"",M,L,S,I=c[3].description+"",d,y,k,F,V,P,O,N;e=new Ne({props:{items:c[7]}}),s=new Re({props:{category:c[2],compact:!0}});let D=c[3].calendar?.access!=="none"&&_e(c),A=c[3].allowForumCreation&&pe();function se(_,E){return _[6].length===0?Oe:Ke}let J=se(c),q=J(c);return{c(){fe(e.$$.fragment),t=H(),r=g("div"),fe(s.$$.fragment),a=H(),o=g("div"),l=g("div"),n=g("div"),h=x(m),w=H(),p=g("div"),C=g("h2"),M=x(T),L=H(),S=g("p"),d=x(I),y=H(),k=g("div"),D&&D.c(),F=H(),A&&A.c(),V=H(),P=g("div"),O=H(),q.c(),this.h()},l(_){ue(e.$$.fragment,_),t=B(_),r=v(_,"DIV",{class:!0});var E=b(r);ue(s.$$.fragment,E),a=B(E),o=v(E,"DIV",{class:!0});var z=b(o);l=v(z,"DIV",{class:!0});var U=b(l);n=v(U,"DIV",{class:!0});var oe=b(n);h=R(oe,m),oe.forEach(u),w=B(U),p=v(U,"DIV",{});var W=b(p);C=v(W,"H2",{class:!0});var le=b(C);M=R(le,T),le.forEach(u),L=B(W),S=v(W,"P",{class:!0});var ae=b(S);d=R(ae,I),ae.forEach(u),W.forEach(u),U.forEach(u),y=B(z),k=v(z,"DIV",{class:!0});var Q=b(k);D&&D.l(Q),F=B(Q),A&&A.l(Q),Q.forEach(u),z.forEach(u),V=B(E),P=v(E,"DIV",{class:!0}),b(P).forEach(u),O=B(E),q.l(E),E.forEach(u),this.h()},h(){i(n,"class","text-4xl"),i(C,"class","text-2xl font-bold"),i(S,"class","text-base-content/70 mt-1"),i(l,"class","flex items-center gap-4"),i(k,"class","flex gap-2"),i(o,"class","flex items-start justify-between gap-4 mb-6"),i(P,"class","divider"),i(r,"class","mt-6")},m(_,E){ce(e,_,E),j(_,t,E),j(_,r,E),ce(s,r,null),f(r,a),f(r,o),f(o,l),f(l,n),f(n,h),f(l,w),f(l,p),f(p,C),f(C,M),f(p,L),f(p,S),f(S,d),f(o,y),f(o,k),D&&D.m(k,null),f(k,F),A&&A.m(k,null),f(r,V),f(r,P),f(r,O),q.m(r,null),N=!0},p(_,E){const z={};E&128&&(z.items=_[7]),e.$set(z);const U={};E&4&&(U.category=_[2]),s.$set(U),(!N||E&8)&&m!==(m=_[3].icon+"")&&Z(h,m),(!N||E&8)&&T!==(T=_[3].name+"")&&Z(M,T),(!N||E&8)&&I!==(I=_[3].description+"")&&Z(d,I),_[3].calendar?.access!=="none"?D?D.p(_,E):(D=_e(_),D.c(),D.m(k,F)):D&&(D.d(1),D=null),_[3].allowForumCreation?A||(A=pe(),A.c(),A.m(k,null)):A&&(A.d(1),A=null),J===(J=se(_))&&q?q.p(_,E):(q.d(1),q=J(_),q&&(q.c(),q.m(r,null)))},i(_){N||(te(e.$$.fragment,_),te(s.$$.fragment,_),N=!0)},o(_){ee(e.$$.fragment,_),ee(s.$$.fragment,_),N=!1},d(_){_&&(u(t),u(r)),ie(e,_),ie(s),D&&D.d(),A&&A.d(),q.d()}}}function ze(c){let e,t,r,s,a,o,l;return{c(){e=g("div"),t=g("span"),r=x(c[5]),s=H(),a=g("a"),o=x("Back to Category"),this.h()},l(n){e=v(n,"DIV",{class:!0});var m=b(e);t=v(m,"SPAN",{});var h=b(t);r=R(h,c[5]),h.forEach(u),s=B(m),a=v(m,"A",{href:!0,class:!0});var w=b(a);o=R(w,"Back to Category"),w.forEach(u),m.forEach(u),this.h()},h(){i(a,"href",l=K+"/"+c[0]),i(a,"class","btn btn-sm btn-ghost"),i(e,"class","alert alert-error")},m(n,m){j(n,e,m),f(e,t),f(t,r),f(e,s),f(e,a),f(a,o)},p(n,m){m&32&&Z(r,n[5]),m&1&&l!==(l=K+"/"+n[0])&&i(a,"href",l)},i:Y,o:Y,d(n){n&&u(e)}}}function Ue(c){let e,t='<span class="loading loading-spinner loading-lg text-primary"></span>';return{c(){e=g("div"),e.innerHTML=t,this.h()},l(r){e=v(r,"DIV",{class:!0,"data-svelte-h":!0}),G(e)!=="svelte-f5e84o"&&(e.innerHTML=t),this.h()},h(){i(e,"class","flex justify-center items-center min-h-[400px]")},m(r,s){j(r,e,s)},p:Y,i:Y,o:Y,d(r){r&&u(e)}}}function _e(c){let e,t,r,s,a;return{c(){e=g("a"),t=$("svg"),r=$("path"),s=x(`
              Calendar`),this.h()},l(o){e=v(o,"A",{href:!0,class:!0});var l=b(e);t=X(l,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var n=b(t);r=X(n,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),b(r).forEach(u),n.forEach(u),s=R(l,`
              Calendar`),l.forEach(u),this.h()},h(){i(r,"stroke-linecap","round"),i(r,"stroke-linejoin","round"),i(r,"stroke-width","2"),i(r,"d","M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"),i(t,"xmlns","http://www.w3.org/2000/svg"),i(t,"class","h-5 w-5"),i(t,"fill","none"),i(t,"viewBox","0 0 24 24"),i(t,"stroke","currentColor"),i(e,"href",a=K+"/"+c[0]+"/"+c[1]+"/calendar"),i(e,"class","btn btn-outline btn-secondary")},m(o,l){j(o,e,l),f(e,t),f(t,r),f(e,s)},p(o,l){l&3&&a!==(a=K+"/"+o[0]+"/"+o[1]+"/calendar")&&i(e,"href",a)},d(o){o&&u(e)}}}function pe(c){let e,t=`<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg>
              New Forum`;return{c(){e=g("button"),e.innerHTML=t,this.h()},l(r){e=v(r,"BUTTON",{class:!0,"data-svelte-h":!0}),G(e)!=="svelte-11mb7s2"&&(e.innerHTML=t),this.h()},h(){i(e,"class","btn btn-primary")},m(r,s){j(r,e,s)},d(r){r&&u(e)}}}function Ke(c){let e,t=[],r=new Map,s=de(c[6]);const a=o=>o[16].id;for(let o=0;o<s.length;o+=1){let l=me(c,s,o),n=a(l);r.set(n,t[o]=ge(n,l))}return{c(){e=g("div");for(let o=0;o<t.length;o+=1)t[o].c();this.h()},l(o){e=v(o,"DIV",{class:!0});var l=b(e);for(let n=0;n<t.length;n+=1)t[n].l(l);l.forEach(u),this.h()},h(){i(e,"class","space-y-3")},m(o,l){j(o,e,l);for(let n=0;n<t.length;n+=1)t[n]&&t[n].m(e,null)},p(o,l){l&67&&(s=de(o[6]),t=De(t,l,a,1,o,s,r,e,Me,ge,null,me))},d(o){o&&u(e);for(let l=0;l<t.length;l+=1)t[l].d()}}}function Oe(c){let e,t,r,s="No forums in this section yet.",a,o=c[3].allowForumCreation&&be();return{c(){e=g("div"),t=g("div"),r=g("p"),r.textContent=s,a=H(),o&&o.c(),this.h()},l(l){e=v(l,"DIV",{class:!0});var n=b(e);t=v(n,"DIV",{class:!0});var m=b(t);r=v(m,"P",{class:!0,"data-svelte-h":!0}),G(r)!=="svelte-vugkgx"&&(r.textContent=s),a=B(m),o&&o.l(m),m.forEach(u),n.forEach(u),this.h()},h(){i(r,"class","text-base-content/70"),i(t,"class","card-body text-center"),i(e,"class","card bg-base-200")},m(l,n){j(l,e,n),f(e,t),f(t,r),f(t,a),o&&o.m(t,null)},p(l,n){l[3].allowForumCreation?o||(o=be(),o.c(),o.m(t,null)):o&&(o.d(1),o=null)},d(l){l&&u(e),o&&o.d()}}}function Ye(c){let e,t='<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8h2a2 2 0 012 2v6a2 2 0 01-2 2h-2v4l-4-4H9a1.994 1.994 0 01-1.414-.586m0 0L11 14h4a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2v4l.586-.586z"></path></svg>';return{c(){e=g("div"),e.innerHTML=t,this.h()},l(r){e=v(r,"DIV",{class:!0,"data-svelte-h":!0}),G(e)!=="svelte-1rijk9n"&&(e.innerHTML=t),this.h()},h(){i(e,"class","w-12 h-12 rounded-lg bg-primary/10 flex items-center justify-center")},m(r,s){j(r,e,s)},p:Y,d(r){r&&u(e)}}}function Ze(c){let e,t;return{c(){e=g("img"),this.h()},l(r){e=v(r,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){ne(e.src,t=c[16].picture)||i(e,"src",t),i(e,"alt",""),i(e,"class","w-12 h-12 rounded-lg object-cover")},m(r,s){j(r,e,s)},p(r,s){s&64&&!ne(e.src,t=r[16].picture)&&i(e,"src",t)},d(r){r&&u(e)}}}function ve(c){let e,t=c[16].about+"",r;return{c(){e=g("p"),r=x(t),this.h()},l(s){e=v(s,"P",{class:!0});var a=b(e);r=R(a,t),a.forEach(u),this.h()},h(){i(e,"class","text-sm text-base-content/70 line-clamp-1")},m(s,a){j(s,e,a),f(e,r)},p(s,a){a&64&&t!==(t=s[16].about+"")&&Z(r,t)},d(s){s&&u(e)}}}function ge(c,e){let t,r,s,a,o,l,n=e[16].name+"",m,h,w,p,C,T,M;function L(y,k){return y[16].picture?Ze:Ye}let S=L(e),I=S(e),d=e[16].about&&ve(e);return{key:c,first:null,c(){t=g("a"),r=g("div"),s=g("div"),I.c(),a=H(),o=g("div"),l=g("h3"),m=x(n),h=H(),d&&d.c(),w=H(),p=$("svg"),C=$("path"),T=H(),this.h()},l(y){t=v(y,"A",{href:!0,class:!0});var k=b(t);r=v(k,"DIV",{class:!0});var F=b(r);s=v(F,"DIV",{class:!0});var V=b(s);I.l(V),a=B(V),o=v(V,"DIV",{class:!0});var P=b(o);l=v(P,"H3",{class:!0});var O=b(l);m=R(O,n),O.forEach(u),h=B(P),d&&d.l(P),P.forEach(u),w=B(V),p=X(V,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var N=b(p);C=X(N,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),b(C).forEach(u),N.forEach(u),V.forEach(u),F.forEach(u),T=B(k),k.forEach(u),this.h()},h(){i(l,"class","font-bold"),i(o,"class","flex-1"),i(C,"stroke-linecap","round"),i(C,"stroke-linejoin","round"),i(C,"stroke-width","2"),i(C,"d","M9 5l7 7-7 7"),i(p,"xmlns","http://www.w3.org/2000/svg"),i(p,"class","h-5 w-5 text-base-content/40"),i(p,"fill","none"),i(p,"viewBox","0 0 24 24"),i(p,"stroke","currentColor"),i(s,"class","flex items-center gap-3"),i(r,"class","card-body p-4"),i(t,"href",M=K+"/"+e[0]+"/"+e[1]+"/"+e[16].id),i(t,"class","card bg-base-100 shadow hover:shadow-md transition-shadow cursor-pointer block"),this.first=t},m(y,k){j(y,t,k),f(t,r),f(r,s),I.m(s,null),f(s,a),f(s,o),f(o,l),f(l,m),f(o,h),d&&d.m(o,null),f(s,w),f(s,p),f(p,C),f(t,T)},p(y,k){e=y,S===(S=L(e))&&I?I.p(e,k):(I.d(1),I=S(e),I&&(I.c(),I.m(s,a))),k&64&&n!==(n=e[16].name+"")&&Z(m,n),e[16].about?d?d.p(e,k):(d=ve(e),d.c(),d.m(o,null)):d&&(d.d(1),d=null),k&67&&M!==(M=K+"/"+e[0]+"/"+e[1]+"/"+e[16].id)&&i(t,"href",M)},d(y){y&&u(t),I.d(),d&&d.d()}}}function be(c){let e,t="Be the first to create one!";return{c(){e=g("p"),e.textContent=t,this.h()},l(r){e=v(r,"P",{class:!0,"data-svelte-h":!0}),G(e)!=="svelte-1omq2dy"&&(e.textContent=t),this.h()},h(){i(e,"class","text-sm text-base-content/50 mt-2")},m(r,s){j(r,e,s)},d(r){r&&u(e)}}}function Ge(c){let e,t,r,s,a,o;document.title=e=(c[3]?.name??"Section")+" - "+c[8].name;const l=[Ue,ze,xe],n=[];function m(h,w){return h[4]?0:h[5]?1:h[3]&&h[2]?2:-1}return~(s=m(c))&&(a=n[s]=l[s](c)),{c(){t=H(),r=g("div"),a&&a.c(),this.h()},l(h){we("svelte-n92ddi",document.head).forEach(u),t=B(h),r=v(h,"DIV",{class:!0});var p=b(r);a&&a.l(p),p.forEach(u),this.h()},h(){i(r,"class","container mx-auto p-4 max-w-6xl")},m(h,w){j(h,t,w),j(h,r,w),~s&&n[s].m(r,null),o=!0},p(h,[w]){(!o||w&264)&&e!==(e=(h[3]?.name??"Section")+" - "+h[8].name)&&(document.title=e);let p=s;s=m(h),s===p?~s&&n[s].p(h,w):(a&&(Ve(),ee(n[p],1,1,()=>{n[p]=null}),Ie()),~s?(a=n[s],a?a.p(h,w):(a=n[s]=l[s](h),a.c()),te(a,1),a.m(r,null)):a=null)},i(h){o||(te(a),o=!0)},o(h){ee(a),o=!1},d(h){h&&(u(t),u(r)),~s&&n[s].d()}}}function Je(c,e,t){let r,s,a,o,l,n,m,h,w,p,C;re(c,he,d=>t(14,w=d)),re(c,Fe,d=>t(11,p=d)),re(c,Ae,d=>t(12,C=d));const T=Be();let M=!0,L=null,S=[];async function I(){const d=qe();if(d)try{const y={kinds:[40],"#section":[s],limit:50},k=await d.fetchEvents(y);t(6,S=Array.from(k).map(F=>{let V={name:"Unnamed Forum",about:"",picture:""};try{V=JSON.parse(F.content)}catch{}return{id:F.id,name:V.name||"Unnamed Forum",about:V.about||"",picture:V.picture,createdAt:F.created_at??0,pubkey:F.pubkey}})),S.sort((F,V)=>V.createdAt-F.createdAt)}catch(y){console.error("Failed to load forums:",y),t(5,L=y instanceof Error?y.message:"Failed to load forums")}}return ye(async()=>{if(await he.waitForReady(),!w.isAuthenticated||!w.publicKey){Se(`${K}/`);return}if(!o||!l){t(5,L=`Section "${s}" not found`),t(4,M=!1);return}if(l.id!==r){t(5,L=`Section "${s}" is not in category "${r}"`),t(4,M=!1);return}if(!h){t(5,L="You do not have access to this section"),t(4,M=!1);return}try{!Le()&&w.privateKey&&await Te(Pe,w.privateKey),await I()}catch(d){console.error("Failed to connect:",d),t(5,L=d instanceof Error?d.message:"Connection failed")}finally{t(4,M=!1)}}),c.$$.update=()=>{c.$$.dirty&4096&&t(0,r=C.params.category),c.$$.dirty&4096&&t(1,s=C.params.section),c.$$.dirty&2&&t(10,a=He(s)),c.$$.dirty&1024&&t(3,o=a?.section),c.$$.dirty&1024&&t(2,l=a?.category),c.$$.dirty&15&&t(7,n=o&&l?je(r,s):[]),c.$$.dirty&2048&&t(9,m=p.profile?.cohorts||[]),c.$$.dirty&520&&(h=(()=>{if(!o?.access?.requiresApproval)return!0;const d=o.access.requiredCohorts||[];if(d.length===0)return!0;const y=m;return d.some(k=>y.includes(k))})())},[r,s,l,o,M,L,S,n,T,m,a,p,C]}class ut extends Ee{constructor(e){super(),Ce(this,e,Je,Ge,ke,{})}}export{ut as component};
