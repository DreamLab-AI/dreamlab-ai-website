import{n as pe,_ as Os,B as st,W as nt,s as Pe,d as f,i as D,l as r,c as k,e as y,h as w,k as ve,p as Qt,R as ft,a as he,b as u,g as S,u as q,f as J,j as L,v as K,t as Q,y as $e,q as Z,o as W,x as ke,r as De,A as se,C as Fs,D as Rs,K as Xt,w as St,P as ct,E as ys,z as Cs,L as Es,m as Ws,G as qs,H as Ks,I as Zs,J as Gs}from"../chunks/CwRy9Tox.js";import{n as Ys,l as Js,j as Qs,k as Xs,S as He,i as Oe,t as ae,a as te,g as Ie,c as Te,o as Ve,d as Be,m as Se,b as Le,e as Ne,f as Ms,p as $s,h as en}from"../chunks/D-vqeeah.js";import{g as Is}from"../chunks/D0QH3NT1.js";import{p as Dt}from"../chunks/DapKZiAA.js";import{w as $t,d as Ts,b as ne}from"../chunks/CEc-lP5l.js";import{g as tn}from"../chunks/BZgxvzt3.js";import{c as ln,f as Lt,s as Cl,a as dt}from"../chunks/BvU0z6gS.js";import{G as sn,H as xs,I as nn,J as rn,K as an,L as As,M as on,N as Bs,a as ht,g as el,O as Ss,P as Ls,d as Ns,Q as cn,R as un,i as fn,T as dn}from"../chunks/BVL4R8vY.js";import{c as hn,a as pn,C as mn,s as vn}from"../chunks/BsEqvDQt.js";import{s as bn,n as Ps}from"../chunks/C5CT8Vb6.js";import{d as me}from"../chunks/BVXA5lDO.js";import{c as gn,u as tl,i as Ds,w as zs}from"../chunks/B0CCWat9.js";import{t as lt}from"../chunks/B5Ec7LqV.js";import{subscribe as xt,publishEvent as El,ndk as js}from"../chunks/ofNpoJHj.js";import{e as Ue,u as ll,f as _n,d as Vs}from"../chunks/BFk-VQ8S.js";import{p as Wt}from"../chunks/CF7zP8uE.js";import{e as kn,b as wn}from"../chunks/BiZSf_U7.js";import"../chunks/DRM-cY5C.js";import"../chunks/D-ho1sXg.js";import"../chunks/CsmHjMo3.js";function yn(s,e,t,l){if(!e)return pe;const n=s.getBoundingClientRect();if(e.left===n.left&&e.right===n.right&&e.top===n.top&&e.bottom===n.bottom)return pe;const{delay:a=0,duration:i=300,easing:c=Os,start:o=Ys()+a,end:h=o+i,tick:m=pe,css:v}=t(s,{from:e,to:n},l);let g=!0,p=!1,d;function b(){v&&(d=Xs(s,0,1,i,a,c,v)),a||(p=!0)}function _(){v&&Qs(s,d),g=!1}return Js(M=>{if(!p&&M>=o&&(p=!0),p&&M>=h&&(m(1,0),_()),!g)return!1;if(p){const C=M-o,T=0+1*c(C/i);m(T,1-T)}return!0}),b(),m(0,1),_}function Cn(s){const e=getComputedStyle(s);if(e.position!=="absolute"&&e.position!=="fixed"){const{width:t,height:l}=e,n=s.getBoundingClientRect();s.style.position="absolute",s.style.width=t,s.style.height=l,Us(s,n)}}function Us(s,e){const t=s.getBoundingClientRect();if(e.left!==t.left||e.top!==t.top){const l=getComputedStyle(s),n=l.transform==="none"?"":l.transform;s.style.transform=`${n} translate(${e.left-t.left}px, ${e.top-t.top}px)`}}const En=!0,Mn=!1,Sa=Object.freeze(Object.defineProperty({__proto__:null,prerender:En,ssr:Mn},Symbol.toStringTag,{value:"Module"})),Bt=30*60*1e3,In=2*60*1e3,Tn=30*1e3,Ml="nostr_bbs_last_activity",Il={isActive:!0,showWarning:!1,remainingMs:Bt};function xn(){const{subscribe:s,set:e,update:t}=$t(Il);let l=null,n=null;function a(){localStorage.setItem(Ml,Date.now().toString()),t(g=>({...g,isActive:!0,showWarning:!1,remainingMs:Bt}))}function i(){const g=localStorage.getItem(Ml);return g?parseInt(g,10):Date.now()}function c(){const g=i(),p=Date.now()-g,d=Bt-p;d<=0?(t(b=>({...b,isActive:!1,showWarning:!1,remainingMs:0})),n&&n()):d<=In?t(b=>({...b,isActive:!0,showWarning:!0,remainingMs:d})):t(b=>({...b,isActive:!0,showWarning:!1,remainingMs:d}))}function o(){return st(xs)||sn()||localStorage.getItem("nostr_bbs_pwa_mode")==="true"}function h(g){if(o())return console.log("[Session] PWA mode detected - session timeout disabled"),t(b=>({...b,isActive:!0,showWarning:!1,remainingMs:Bt})),()=>{};n=g,a(),l&&clearInterval(l),l=setInterval(c,Tn);const p=["mousedown","keydown","touchstart","scroll"],d=An(a,1e4);return p.forEach(b=>{document.addEventListener(b,d,{passive:!0})}),()=>{l&&(clearInterval(l),l=null),p.forEach(b=>{document.removeEventListener(b,d)})}}function m(){l&&(clearInterval(l),l=null),n=null,e(Il)}function v(){a()}return{subscribe:s,start:h,stop:m,touch:a,extend:v,checkTimeout:c}}function An(s,e){let t=0;return(...l)=>{const n=Date.now();n-t>=e&&(t=n,s(...l))}}const Nt=xn();function Bn(s){const e=Math.floor(s/6e4),t=Math.floor(s%6e4/1e3);return e>0?`${e}m ${t}s`:`${t}s`}async function Sn(){if(typeof window>"u")return;if(nn(),await rn()){console.log("[PWA] Service worker registered successfully");try{const e=await an();e.length>0&&(console.log(`[PWA] Found ${e.length} queued messages`),st(As)&&await on())}catch(e){console.error("[PWA] Failed to check message queue:",e)}}}async function Ln(s){const e=performance.now();await me.clearSearchIndex();const t=await me.messages.toCollection().filter(i=>!i.deleted).toArray(),l=t.length,n=100;for(let i=0;i<t.length;i+=n){const c=t.slice(i,i+n);await me.bulkIndexMessages(c),s&&s(Math.min(i+n,l),l),await new Promise(o=>setTimeout(o,0))}const a=performance.now();console.log(`Search index built: ${l} messages in ${(a-e).toFixed(2)}ms`)}async function qt(s){await me.indexMessage(s)}async function Tl(s){await me.removeFromIndex(s)}async function sl(){const s=await me.searchIndex.count();if(s===0)return{totalIndexed:0,oldestMessage:0,newestMessage:0};const e=await me.searchIndex.orderBy("timestamp").first(),t=await me.searchIndex.orderBy("timestamp").reverse().first();return{totalIndexed:s,oldestMessage:e?.timestamp||0,newestMessage:t?.timestamp||0}}const Nn={REMOVE_DATE:"2025-12-01"},xl={messages:[],loading:!1,error:null,currentChannelId:null,hasMore:!0,lastFetchTime:null};function Pn(){const{subscribe:s,set:e,update:t}=$t(xl),l=new Map;async function n(o){const h=await me.getUser(o.pubkey);return{id:o.id,channelId:o.channelId,pubkey:o.pubkey,content:o.content,created_at:o.created_at,encrypted:o.encrypted,deleted:o.deleted,author:{pubkey:o.pubkey,name:h?.name||h?.displayName||void 0,avatar:h?.avatar||void 0}}}function a(){return console.warn("[REMOVED] NIP-04 decryption removed as of",Nn.REMOVE_DATE),"[Legacy NIP-04 encrypted message - encryption method no longer supported]"}function i(o,h,m){const v=js();if(!v)throw new Error("NDK not initialized");const g=new Bs(v);return g.kind=h,g.content=o,g.tags=m,g.created_at=Math.floor(Date.now()/1e3),g}function c(o){return{id:o.id,pubkey:o.pubkey,created_at:o.created_at||Math.floor(Date.now()/1e3),kind:o.kind||0,tags:o.tags,content:o.content,sig:o.sig||""}}return{subscribe:s,async fetchMessages(o,h,m,v=50){t(g=>({...g,loading:!0,error:null,currentChannelId:h}));try{const g=await me.getChannelMessagesWithAuthors(h),p=await Promise.all(g.map(T=>n(T)));t(T=>({...T,messages:p,loading:!0}));const b=(await me.getChannel(h))?.isEncrypted||!1,_=g.length>0?Math.max(...g.map(T=>T.created_at)):0;xt({kinds:[9],"#e":[h],since:_,limit:v},{closeOnEose:!1}).on("event",async T=>{const z=c(T);if(await me.isMessageDeleted(z.id))return;let E=z.content;b&&(E=a());const I={id:z.id,channelId:h,pubkey:z.pubkey,content:E,created_at:z.created_at,encrypted:b,deleted:!1,kind:z.kind,tags:z.tags,sig:z.sig};await me.messages.put(I),qt(I).catch(B=>console.error("Failed to index message for search:",B));const A=await n(I);t(B=>B.messages.some(V=>V.id===A.id)?B:{...B,messages:[...B.messages,A].sort((V,j)=>V.created_at-j.created_at)})}),t(T=>({...T,loading:!1,lastFetchTime:Date.now()}))}catch(g){const p=g instanceof Error?g.message:"Failed to fetch messages";console.error("fetchMessages error:",g),lt.error(`Connection error: ${p}`),t(d=>({...d,error:p,loading:!1}))}},async sendMessage(o,h,m,v,g=!1,p=[]){try{let d=o;if(g)throw new Error("NIP-04 encrypted messages are no longer supported. Use NIP-44 gift wrap (kind 1059) for encrypted direct messages.");const _=i(d,9,[["e",h,m,"root"]]);await El(_);const M=c(_),C={id:M.id,channelId:h,pubkey:M.pubkey,content:o,created_at:M.created_at,encrypted:g,deleted:!1,kind:M.kind,tags:M.tags,sig:M.sig};await me.messages.put(C),qt(C).catch(z=>console.error("Failed to index message for search:",z));const T=await n(C);t(z=>({...z,messages:[...z.messages,T].sort((x,E)=>x.created_at-E.created_at)}))}catch(d){const b=d instanceof Error?d.message:"Failed to send message";throw console.error("sendMessage error:",d),lt.error(`Failed to send: ${b}`),t(_=>({..._,error:b})),d}},async deleteMessage(o,h,m,v){try{const p=i("",5,[["e",o],["k","9"]]);await El(p);const d=c(p);await me.addDeletion({id:d.id,deletedEventId:o,channelId:h,deleterPubkey:d.pubkey,created_at:d.created_at,kind:5}),Tl(o).catch(b=>console.error("Failed to remove deleted message from search:",b)),t(b=>({...b,messages:b.messages.map(_=>_.id===o?{..._,deleted:!0}:_)}))}catch(g){const p=g instanceof Error?g.message:"Failed to delete message";throw console.error("deleteMessage error:",g),lt.error(`Failed to delete: ${p}`),t(d=>({...d,error:p})),g}},async subscribeToChannel(o,h,m){try{const g=(await me.getChannel(o))?.isEncrypted||!1,p={kinds:[9],"#e":[o],since:Math.floor(Date.now()/1e3)},d={kinds:[5,9005],"#e":[o],since:Math.floor(Date.now()/1e3)},b=`msg_${o}_${Date.now()}`,_=xt(p,{closeOnEose:!1,subId:b});_.on("event",async z=>{const x=c(z);let E=x.content;g&&(E=a());const I={id:x.id,channelId:o,pubkey:x.pubkey,content:E,created_at:x.created_at,encrypted:g,deleted:!1,kind:x.kind,tags:x.tags,sig:x.sig};await me.messages.put(I),qt(I).catch(B=>console.error("Failed to index message for search:",B));const A=await n(I);t(B=>!B.messages.some(V=>V.id===A.id)&&B.currentChannelId===o?{...B,messages:[...B.messages,A].sort((V,j)=>V.created_at-j.created_at)}:B)});const M=`del_${o}_${Date.now()}`,C=xt(d,{closeOnEose:!1,subId:M});C.on("event",async z=>{const x=c(z),E=x.tags.find(I=>I[0]==="e")?.[1];E&&(await me.addDeletion({id:x.id,deletedEventId:E,channelId:o,deleterPubkey:x.pubkey,created_at:x.created_at,kind:x.kind}),Tl(E).catch(I=>console.error("Failed to remove deleted message from search:",I)),t(I=>({...I,messages:I.messages.map(A=>A.id===E?{...A,deleted:!0}:A)})))});const T=l.get(o)||[];l.set(o,[...T,{subId:b,subscription:_},{subId:M,subscription:C}])}catch(v){console.error("subscribeToChannel error:",v);const g=v instanceof Error?v.message:"Failed to subscribe to channel";lt.error(`Channel subscription failed: ${g}`),t(p=>({...p,error:g}))}},unsubscribeFromChannel(o,h){const m=l.get(o);m&&(m.forEach(({subscription:v})=>{v.stop()}),l.delete(o))},async fetchOlderMessages(o,h,m,v=50){const p=st({subscribe:s}).messages.filter(d=>d.channelId===h).reduce((d,b)=>b.created_at<d.created_at?b:d,{created_at:1/0});if(p.created_at===1/0)return!1;t(d=>({...d,loading:!0,error:null}));try{const b=(await me.getChannel(h))?.isEncrypted||!1,_={kinds:[9],"#e":[h],until:p.created_at-1,limit:v};let M=0;return await new Promise((C,T)=>{const z=setTimeout(()=>C(),5e3),x=xt(_,{closeOnEose:!0});x.on("event",async E=>{const I=c(E);if(await me.isMessageDeleted(I.id))return;let B=I.content;b&&(B=a());const N={id:I.id,channelId:h,pubkey:I.pubkey,content:B,created_at:I.created_at,encrypted:b,deleted:!1,kind:I.kind,tags:I.tags,sig:I.sig};await me.messages.put(N);const V=await n(N);t(j=>j.messages.some(P=>P.id===V.id)?j:(M++,{...j,messages:[...j.messages,V].sort((P,U)=>P.created_at-U.created_at)}))}),x.on("eose",()=>{clearTimeout(z),C()}),x.on("close",()=>{clearTimeout(z),C()})}),t(C=>({...C,loading:!1,hasMore:M>=v*.5})),M>0}catch(d){const b=d instanceof Error?d.message:"Failed to fetch older messages";return console.error("fetchOlderMessages error:",d),t(_=>({..._,error:b,loading:!1,hasMore:!1})),!1}},clearError(){t(o=>({...o,error:null}))},clear(){e(xl)},disconnectAll(){l.forEach(o=>{o.forEach(({subscription:h})=>{h.stop()})}),l.clear()}}}const nl=Pn(),Dn=Ts(nl,s=>s.messages.filter(e=>!e.deleted));Ts(Dn,s=>s.length);typeof window<"u"&&window.addEventListener("beforeunload",()=>{nl.disconnectAll()});let zn=null;const ot=new Set;function jn(){let s=0;nl.subscribe(async e=>{if(!(e.loading||e.messages.length===0)){if(e.messages.length>s){const t=e.messages.slice(s);for(const l of t)await Vn(l,e.currentChannelId)}s=e.messages.length}})}async function Vn(s,e){try{if(ot.has(s.id))return;if(ot.add(s.id),ot.size>1e3){const m=Array.from(ot).slice(-1e3);ot.clear(),m.forEach(v=>ot.add(v))}if(!bn(s.pubkey,s.channelId,zn))return;const l=(await me.getChannel(s.channelId))?.name||"Unknown Channel",n=st(gn),a=Un(s.content,n),i=a?"mention":"message",c=s.author.name||s.author.pubkey.slice(0,8),o=a?`${c} mentioned you in ${l}`:`${c}: ${s.content.slice(0,50)}${s.content.length>50?"...":""}`;Ps.addNotification(i,o,{channelId:s.channelId,channelName:l,senderPubkey:s.pubkey,senderName:c,url:`/chat?channel=${s.channelId}`})}catch(t){console.error("Error processing message notification:",t)}}function Un(s,e){return e?s.includes("@"):!1}async function Hn(s){console.log("Starting search index rebuild...");const e=performance.now();try{await Ln(s);const t=await sl(),n=(performance.now()-e)/1e3;console.log("Search index rebuild complete!"),console.log(`- Indexed: ${t.totalIndexed} messages`),console.log(`- Duration: ${n.toFixed(2)}s`),console.log(`- Average: ${(t.totalIndexed/n).toFixed(0)} messages/sec`);return}catch(t){throw console.error("Search index rebuild failed:",t),t}}async function On(){const s=await sl(),e=await me.messages.where("deleted").equals(0).count();if(s.totalIndexed===0&&e>0)return!0;const t=e-s.totalIndexed,l=t/e*100;return l>10?(console.log(`Search index out of sync: ${t} messages not indexed (${l.toFixed(1)}%)`),!0):!1}async function Fn(){if(await On())console.log("Search index is empty or out of date, rebuilding..."),await Hn((e,t)=>{(e%100===0||e===t)&&console.log(`Indexing messages: ${e}/${t} (${(e/t*100).toFixed(1)}%)`)});else{const e=await sl();console.log(`Search index ready: ${e.totalIndexed} messages indexed`)}}let Kt=!1;async function Rn(){if(!Kt)try{Kt=!0,await Fn()}catch(s){console.error("Failed to initialize search index:",s),Kt=!1}}function Wn(s,{from:e,to:t},l={}){const n=getComputedStyle(s),a=n.transform==="none"?"":n.transform,[i,c]=n.transformOrigin.split(" ").map(parseFloat),o=e.left+e.width*i/t.width-(t.left+i),h=e.top+e.height*c/t.height-(t.top+c),{delay:m=0,duration:v=p=>Math.sqrt(p)*120,easing:g=ln}=l;return{delay:m,duration:nt(v)?v(Math.sqrt(o*o+h*h)):v,easing:g,css:(p,d)=>{const b=d*o,_=d*h,M=p+d*e.width/t.width,C=p+d*e.height/t.height;return`transform: ${a} translate(${b}px, ${_}px) scale(${M}, ${C});`}}}function Al(s,e,t){const l=s.slice();return l[10]=e[t],l}function Zt(s){const e=s.slice(),t=e[10].action;return e[13]=t,e}function Bl(s){let e;return{c(){e=w("div"),this.h()},l(t){e=k(t,"DIV",{class:!0,style:!0}),y(e).forEach(f),this.h()},h(){r(e,"class","absolute bottom-0 left-0 h-1 bg-current opacity-30 progress-bar svelte-1bnehg0"),$e(e,"animation-duration",s[10].duration+"ms")},m(t,l){D(t,e,l)},p(t,l){l&1&&$e(e,"animation-duration",t[10].duration+"ms")},d(t){t&&f(e)}}}function Sl(s){let e,t=s[13].label+"",l,n,a;function i(){return s[6](s[10],s[13])}return{c(){e=w("button"),l=Q(t),this.h()},l(c){e=k(c,"BUTTON",{class:!0});var o=y(e);l=J(o,t),o.forEach(f),this.h()},h(){r(e,"class","btn btn-xs btn-outline border-current text-current hover:bg-current hover:text-base-100 self-start")},m(c,o){D(c,e,o),u(e,l),n||(a=Z(e,"click",i),n=!0)},p(c,o){s=c,o&1&&t!==(t=s[13].label+"")&&he(l,t)},d(c){c&&f(e),n=!1,a()}}}function Ll(s){let e,t='<svg class="w-4 h-4 stroke-current" fill="none" viewBox="0 0 24 24" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path></svg>',l,n;function a(){return s[7](s[10])}return{c(){e=w("button"),e.innerHTML=t,this.h()},l(i){e=k(i,"BUTTON",{class:!0,"aria-label":!0,"data-svelte-h":!0}),W(e)!=="svelte-1ugddyn"&&(e.innerHTML=t),this.h()},h(){r(e,"class","btn btn-ghost btn-xs btn-circle flex-shrink-0 hover:bg-current/20"),r(e,"aria-label","Dismiss notification")},m(i,c){D(i,e,c),l||(n=Z(e,"click",a),l=!0)},p(i,c){s=i},d(i){i&&f(e),l=!1,n()}}}function Nl(s,e){let t,l,n,a,i,c,o,h,m,v,g=e[10].message+"",p,d,b,_,M,C,T,z=pe,x,E=e[10].duration&&e[10].duration>0&&Bl(e),I=e[10].action&&Sl(Zt(e)),A=e[10].dismissible&&Ll(e);return{key:s,first:null,c(){t=w("div"),E&&E.c(),l=L(),n=w("div"),a=w("div"),i=K("svg"),c=K("path"),h=L(),m=w("div"),v=w("span"),p=Q(g),d=L(),I&&I.c(),b=L(),A&&A.c(),_=L(),this.h()},l(B){t=k(B,"DIV",{class:!0,role:!0,"aria-atomic":!0});var N=y(t);E&&E.l(N),l=S(N),n=k(N,"DIV",{class:!0});var V=y(n);a=k(V,"DIV",{class:!0});var j=y(a);i=q(j,"svg",{class:!0,fill:!0,viewBox:!0,"stroke-width":!0});var H=y(i);c=q(H,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),y(c).forEach(f),H.forEach(f),j.forEach(f),h=S(V),m=k(V,"DIV",{class:!0});var P=y(m);v=k(P,"SPAN",{class:!0});var U=y(v);p=J(U,g),U.forEach(f),d=S(P),I&&I.l(P),P.forEach(f),b=S(V),A&&A.l(V),V.forEach(f),_=S(N),N.forEach(f),this.h()},h(){r(c,"stroke-linecap","round"),r(c,"stroke-linejoin","round"),r(c,"d",o=e[2][e[10].variant]),r(i,"class","w-6 h-6 stroke-current"),r(i,"fill","none"),r(i,"viewBox","0 0 24 24"),r(i,"stroke-width","2"),r(a,"class","flex-shrink-0 mt-0.5"),r(v,"class","text-sm font-medium break-words leading-relaxed"),r(m,"class","flex-1 flex flex-col gap-2 min-w-0"),r(n,"class","flex items-start gap-3 w-full"),r(t,"class",M="alert border-2 shadow-2xl min-w-[300px] max-w-md relative overflow-hidden "+e[1][e[10].variant]+" svelte-1bnehg0"),r(t,"role","alert"),r(t,"aria-atomic","true"),this.first=t},m(B,N){D(B,t,N),E&&E.m(t,null),u(t,l),u(t,n),u(n,a),u(a,i),u(i,c),u(n,h),u(n,m),u(m,v),u(v,p),u(m,d),I&&I.m(m,null),u(n,b),A&&A.m(n,null),u(t,_),x=!0},p(B,N){e=B,e[10].duration&&e[10].duration>0?E?E.p(e,N):(E=Bl(e),E.c(),E.m(t,l)):E&&(E.d(1),E=null),(!x||N&1&&o!==(o=e[2][e[10].variant]))&&r(c,"d",o),(!x||N&1)&&g!==(g=e[10].message+"")&&he(p,g),e[10].action?I?I.p(Zt(e),N):(I=Sl(Zt(e)),I.c(),I.m(m,null)):I&&(I.d(1),I=null),e[10].dismissible?A?A.p(e,N):(A=Ll(e),A.c(),A.m(n,null)):A&&(A.d(1),A=null),(!x||N&3&&M!==(M="alert border-2 shadow-2xl min-w-[300px] max-w-md relative overflow-hidden "+e[1][e[10].variant]+" svelte-1bnehg0"))&&r(t,"class",M)},r(){T=t.getBoundingClientRect()},f(){Cn(t),z(),Us(t,T)},a(){z(),z=yn(t,T,Wn,{duration:200})},i(B){x||(B&&ft(()=>{x&&(C||(C=Ve(t,Lt,{x:300,duration:300,opacity:0},!0)),C.run(1))}),x=!0)},o(B){B&&(C||(C=Ve(t,Lt,{x:300,duration:300,opacity:0},!1)),C.run(0)),x=!1},d(B){B&&f(t),E&&E.d(),I&&I.d(),A&&A.d(),B&&C&&C.end()}}}function qn(s){let e,t=[],l=new Map,n,a=Ue(s[0].slice(-3));const i=c=>c[10].id;for(let c=0;c<a.length;c+=1){let o=Al(s,a,c),h=i(o);l.set(h,t[c]=Nl(h,o))}return{c(){e=w("div");for(let c=0;c<t.length;c+=1)t[c].c();this.h()},l(c){e=k(c,"DIV",{class:!0,role:!0,"aria-live":!0,"aria-label":!0});var o=y(e);for(let h=0;h<t.length;h+=1)t[h].l(o);o.forEach(f),this.h()},h(){r(e,"class","toast toast-top toast-end z-50 max-h-[90vh] overflow-y-auto svelte-1bnehg0"),r(e,"role","region"),r(e,"aria-live","polite"),r(e,"aria-label","Notifications")},m(c,o){D(c,e,o);for(let h=0;h<t.length;h+=1)t[h]&&t[h].m(e,null);n=!0},p(c,[o]){if(o&31){a=Ue(c[0].slice(-3)),Ie();for(let h=0;h<t.length;h+=1)t[h].r();t=ll(t,o,i,1,c,a,l,e,_n,Nl,null,Al);for(let h=0;h<t.length;h+=1)t[h].a();Te()}},i(c){if(!n){for(let o=0;o<a.length;o+=1)te(t[o]);n=!0}},o(c){for(let o=0;o<t.length;o+=1)ae(t[o]);n=!1},d(c){c&&f(e);for(let o=0;o<t.length;o+=1)t[o].d()}}}function Pl(){"vibrate"in navigator&&navigator.vibrate(50)}function Kn(s,e,t){let l,n,a;ve(s,lt,p=>t(5,a=p));const i={success:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z",error:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z",info:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z",warning:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"};let c=!1;Qt(()=>{c=localStorage.getItem("toastSoundEnabled")==="true"});function o(p){if(c)try{const d=window.AudioContext||window.webkitAudioContext;if(!d)return;const b=new d,_=b.createOscillator(),M=b.createGain();_.connect(M),M.connect(b.destination);const C={success:523.25,error:329.63,warning:440,info:392};_.frequency.value=C[p]||440,_.type="sine",M.gain.setValueAtTime(.1,b.currentTime),M.gain.exponentialRampToValueAtTime(.01,b.currentTime+.1),_.start(b.currentTime),_.stop(b.currentTime+.1)}catch{}}function h(p){lt.remove(p)}async function m(p,d){lt.remove(p),await d()}const v=(p,d)=>{Pl(),m(p.id,d.callback)},g=p=>{Pl(),h(p.id)};return s.$$.update=()=>{if(s.$$.dirty&32&&t(0,l=a.toasts),s.$$.dirty&1&&l.length>0){const p=l[l.length-1];o(p.variant)}},t(1,n={success:"bg-success/10 border-success text-success backdrop-blur-md",error:"bg-error/10 border-error text-error backdrop-blur-md",info:"bg-info/10 border-info text-info backdrop-blur-md",warning:"bg-warning/10 border-warning text-warning backdrop-blur-md"}),[l,n,i,h,m,a,v,g]}class Zn extends He{constructor(e){super(),Oe(this,e,Kn,qn,Pe,{})}}function Gn(){const{subscribe:s,set:e,update:t}=$t({open:!1,options:null,resolve:null});return{subscribe:s,confirm(l){return new Promise(n=>{e({open:!0,options:{confirmLabel:"Confirm",cancelLabel:"Cancel",variant:"danger",...l},resolve:n})})},handleConfirm(){const l=st({subscribe:s});l.resolve&&l.resolve(!0),e({open:!1,options:null,resolve:null})},handleCancel(){const l=st({subscribe:s});l.resolve&&l.resolve(!1),e({open:!1,options:null,resolve:null})},close(){const l=st({subscribe:s});l.resolve&&l.resolve(!1),e({open:!1,options:null,resolve:null})}}}const vt=Gn(),{window:Yn}=Is;function Dl(s){let e,t,l,n,a,i,c,o=s[2].icon+"",h,m,v,g,p,d=s[1].title+"",b,_,M,C=s[1].message+"",T,z,x,E,I=s[1].cancelLabel+"",A,B,N,V=s[1].confirmLabel+"",j,H,P,U,R,le,re;return{c(){e=w("div"),t=w("div"),l=L(),n=w("div"),a=w("div"),i=w("div"),c=w("span"),h=Q(o),g=L(),p=w("h3"),b=Q(d),_=L(),M=w("p"),T=Q(C),z=L(),x=w("div"),E=w("button"),A=Q(I),B=L(),N=w("button"),j=Q(V),this.h()},l(O){e=k(O,"DIV",{class:!0,role:!0,"aria-modal":!0,"aria-labelledby":!0,"aria-describedby":!0});var ie=y(e);t=k(ie,"DIV",{class:!0,"aria-hidden":!0}),y(t).forEach(f),l=S(ie),n=k(ie,"DIV",{class:!0});var ce=y(n);a=k(ce,"DIV",{class:!0});var $=y(a);i=k($,"DIV",{class:!0});var F=y(i);c=k(F,"SPAN",{class:!0});var X=y(c);h=J(X,o),X.forEach(f),F.forEach(f),g=S($),p=k($,"H3",{id:!0,class:!0});var G=y(p);b=J(G,d),G.forEach(f),_=S($),M=k($,"P",{id:!0,class:!0});var be=y(M);T=J(be,C),be.forEach(f),z=S($),x=k($,"DIV",{class:!0});var ge=y(x);E=k(ge,"BUTTON",{class:!0});var oe=y(E);A=J(oe,I),oe.forEach(f),B=S(ge),N=k(ge,"BUTTON",{class:!0});var ee=y(N);j=J(ee,V),ee.forEach(f),ge.forEach(f),$.forEach(f),ce.forEach(f),ie.forEach(f),this.h()},h(){r(t,"class","fixed inset-0 bg-black/60 backdrop-blur-sm"),r(t,"aria-hidden","true"),r(c,"class",m="text-2xl font-bold "+s[2].iconColor),r(i,"class",v="w-14 h-14 rounded-full "+s[2].iconBg+" flex items-center justify-center mb-4"),r(p,"id","confirm-title"),r(p,"class","text-lg font-semibold mb-2"),r(M,"id","confirm-message"),r(M,"class","text-base-content/70 text-sm mb-6"),r(E,"class","btn btn-ghost flex-1"),r(N,"class",H="btn "+(s[1].confirmButtonClass||s[2].buttonClass)+" flex-1"),r(x,"class","flex gap-3 w-full"),r(a,"class","flex flex-col items-center text-center"),r(n,"class","relative bg-base-200 rounded-2xl shadow-2xl max-w-sm w-full p-6"),r(e,"class","fixed inset-0 z-[100] flex items-center justify-center p-4"),r(e,"role","dialog"),r(e,"aria-modal","true"),r(e,"aria-labelledby","confirm-title"),r(e,"aria-describedby","confirm-message")},m(O,ie){D(O,e,ie),u(e,t),u(e,l),u(e,n),u(n,a),u(a,i),u(i,c),u(c,h),u(a,g),u(a,p),u(p,b),u(a,_),u(a,M),u(M,T),u(a,z),u(a,x),u(x,E),u(E,A),u(x,B),u(x,N),u(N,j),R=!0,le||(re=[Z(E,"click",vt.handleCancel),Z(N,"click",vt.handleConfirm),Z(e,"click",s[4]),Z(e,"keydown",s[3])],le=!0)},p(O,ie){(!R||ie&4)&&o!==(o=O[2].icon+"")&&he(h,o),(!R||ie&4&&m!==(m="text-2xl font-bold "+O[2].iconColor))&&r(c,"class",m),(!R||ie&4&&v!==(v="w-14 h-14 rounded-full "+O[2].iconBg+" flex items-center justify-center mb-4"))&&r(i,"class",v),(!R||ie&2)&&d!==(d=O[1].title+"")&&he(b,d),(!R||ie&2)&&C!==(C=O[1].message+"")&&he(T,C),(!R||ie&2)&&I!==(I=O[1].cancelLabel+"")&&he(A,I),(!R||ie&2)&&V!==(V=O[1].confirmLabel+"")&&he(j,V),(!R||ie&6&&H!==(H="btn "+(O[1].confirmButtonClass||O[2].buttonClass)+" flex-1"))&&r(N,"class",H)},i(O){R||(O&&ft(()=>{R&&(P||(P=Ve(n,Cl,{duration:200,start:.95},!0)),P.run(1))}),O&&ft(()=>{R&&(U||(U=Ve(e,dt,{duration:150},!0)),U.run(1))}),R=!0)},o(O){O&&(P||(P=Ve(n,Cl,{duration:200,start:.95},!1)),P.run(0)),O&&(U||(U=Ve(e,dt,{duration:150},!1)),U.run(0)),R=!1},d(O){O&&f(e),O&&P&&P.end(),O&&U&&U.end(),le=!1,De(re)}}}function Jn(s){let e,t,l,n=s[0].open&&s[1]&&Dl(s);return{c(){n&&n.c(),e=ke()},l(a){n&&n.l(a),e=ke()},m(a,i){n&&n.m(a,i),D(a,e,i),t||(l=Z(Yn,"keydown",s[3]),t=!0)},p(a,[i]){a[0].open&&a[1]?n?(n.p(a,i),i&3&&te(n,1)):(n=Dl(a),n.c(),te(n,1),n.m(e.parentNode,e)):n&&(Ie(),ae(n,1,1,()=>{n=null}),Te())},i(a){te(n)},o(a){ae(n)},d(a){a&&f(e),n&&n.d(a),t=!1,l()}}}function Qn(s,e,t){let l,n,a,i,c,o;ve(s,vt,v=>t(7,o=v));function h(v){v.key==="Escape"&&l.open&&(v.preventDefault(),vt.handleCancel())}function m(v){v.target===v.currentTarget&&vt.handleCancel()}return s.$$.update=()=>{s.$$.dirty&128&&t(0,l=o),s.$$.dirty&1&&t(1,n=l.options),s.$$.dirty&2&&t(5,i=n?.variant||"danger"),s.$$.dirty&96&&t(2,c=a[i]),s.$$.dirty&1&&typeof window<"u"&&(l.open?document.body.style.overflow="hidden":document.body.style.overflow="")},t(6,a={danger:{icon:"!",iconBg:"bg-error/20",iconColor:"text-error",buttonClass:"btn-error"},warning:{icon:"!",iconBg:"bg-warning/20",iconColor:"text-warning",buttonClass:"btn-warning"},info:{icon:"?",iconBg:"bg-info/20",iconColor:"text-info",buttonClass:"btn-info"}}),[l,n,c,h,m,i,a,o]}class Xn extends He{constructor(e){super(),Oe(this,e,Qn,Jn,Pe,{})}}function zl(s){let e,t,l,n=`<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-warning" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
        Session Expiring Soon`,a,i,c,o="Your session will expire due to inactivity.",h,m,v,g,p,d,b,_,M,C,T=`Click "Stay Logged In" to continue your session, or you'll be automatically logged out.`,z,x,E,I="Logout Now",A,B,N="Stay Logged In",V,j,H,P;return{c(){e=w("div"),t=w("div"),l=w("h3"),l.innerHTML=n,a=L(),i=w("div"),c=w("p"),c.textContent=o,h=L(),m=w("div"),v=K("svg"),g=K("path"),p=L(),d=w("span"),b=Q(s[0]),M=L(),C=w("p"),C.textContent=T,z=L(),x=w("div"),E=w("button"),E.textContent=I,A=L(),B=w("button"),B.textContent=N,V=L(),j=w("div"),this.h()},l(U){e=k(U,"DIV",{class:!0,role:!0,"aria-modal":!0,"aria-labelledby":!0,"aria-describedby":!0});var R=y(e);t=k(R,"DIV",{class:!0,role:!0});var le=y(t);l=k(le,"H3",{id:!0,class:!0,"data-svelte-h":!0}),W(l)!=="svelte-vdj8xk"&&(l.innerHTML=n),a=S(le),i=k(le,"DIV",{id:!0,class:!0});var re=y(i);c=k(re,"P",{class:!0,"data-svelte-h":!0}),W(c)!=="svelte-1jwrg12"&&(c.textContent=o),h=S(re),m=k(re,"DIV",{class:!0,role:!0,"aria-live":!0,"aria-atomic":!0});var O=y(m);v=q(O,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,"aria-hidden":!0});var ie=y(v);g=q(ie,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),y(g).forEach(f),ie.forEach(f),p=S(O),d=k(O,"SPAN",{class:!0,"aria-label":!0});var ce=y(d);b=J(ce,s[0]),ce.forEach(f),O.forEach(f),M=S(re),C=k(re,"P",{class:!0,"data-svelte-h":!0}),W(C)!=="svelte-11aakk9"&&(C.textContent=T),re.forEach(f),z=S(le),x=k(le,"DIV",{class:!0});var $=y(x);E=k($,"BUTTON",{class:!0,"aria-label":!0,"data-svelte-h":!0}),W(E)!=="svelte-1o34bwc"&&(E.textContent=I),A=S($),B=k($,"BUTTON",{class:!0,"aria-label":!0,"data-svelte-h":!0}),W(B)!=="svelte-pos5vh"&&(B.textContent=N),$.forEach(f),le.forEach(f),V=S(R),j=k(R,"DIV",{class:!0,"aria-hidden":!0}),y(j).forEach(f),R.forEach(f),this.h()},h(){r(l,"id","session-timeout-title"),r(l,"class","font-bold text-lg flex items-center gap-2"),r(c,"class","text-base-content/80 mb-4"),r(g,"stroke-linecap","round"),r(g,"stroke-linejoin","round"),r(g,"stroke-width","2"),r(g,"d","M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"),r(v,"xmlns","http://www.w3.org/2000/svg"),r(v,"class","stroke-current shrink-0 h-6 w-6"),r(v,"fill","none"),r(v,"viewBox","0 0 24 24"),r(v,"aria-hidden","true"),r(d,"class","font-mono text-lg"),r(d,"aria-label",_="Time remaining: "+s[0]),r(m,"class","alert alert-warning mb-4"),r(m,"role","alert"),r(m,"aria-live","assertive"),r(m,"aria-atomic","true"),r(C,"class","text-sm text-base-content/60"),r(i,"id","session-timeout-desc"),r(i,"class","py-4"),r(E,"class","btn btn-ghost"),r(E,"aria-label","Log out immediately"),r(B,"class","btn btn-primary"),r(B,"aria-label","Extend session and stay logged in"),B.autofocus=!0,r(x,"class","modal-action"),r(t,"class","modal-box"),r(t,"role","document"),r(j,"class","modal-backdrop bg-black/50"),r(j,"aria-hidden","true"),r(e,"class","modal modal-open"),r(e,"role","alertdialog"),r(e,"aria-modal","true"),r(e,"aria-labelledby","session-timeout-title"),r(e,"aria-describedby","session-timeout-desc")},m(U,R){D(U,e,R),u(e,t),u(t,l),u(t,a),u(t,i),u(i,c),u(i,h),u(i,m),u(m,v),u(v,g),u(m,p),u(m,d),u(d,b),u(i,M),u(i,C),u(t,z),u(t,x),u(x,E),u(x,A),u(x,B),u(e,V),u(e,j),B.focus(),H||(P=[Z(E,"click",s[3]),Z(B,"click",s[2])],H=!0)},p(U,R){R&1&&he(b,U[0]),R&1&&_!==(_="Time remaining: "+U[0])&&r(d,"aria-label",_)},d(U){U&&f(e),H=!1,De(P)}}}function $n(s){let e,t=s[1]&&zl(s);return{c(){t&&t.c(),e=ke()},l(l){t&&t.l(l),e=ke()},m(l,n){t&&t.m(l,n),D(l,e,n)},p(l,[n]){l[1]?t?t.p(l,n):(t=zl(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:pe,o:pe,d(l){l&&f(e),t&&t.d(l)}}}function er(s,e,t){let l,n,a;ve(s,Nt,o=>t(4,a=o));function i(){Nt.extend()}function c(){ht.logout()}return s.$$.update=()=>{s.$$.dirty&16&&t(1,l=a.showWarning),s.$$.dirty&16&&t(0,n=Bn(a.remainingMs))},[n,l,i,c,a]}class tr extends He{constructor(e){super(),Oe(this,e,er,$n,Pe,{})}}function jl(s){let e,t,l="Admin";return{c(){e=w("li"),t=w("a"),t.textContent=l,this.h()},l(n){e=k(n,"LI",{});var a=y(e);t=k(a,"A",{href:!0,class:!0,"data-svelte-h":!0}),W(t)!=="svelte-1uoukks"&&(t.textContent=l),a.forEach(f),this.h()},h(){r(t,"href",ne+"/admin"),r(t,"class","min-h-11"),se(t,"active",s[4]===`${ne}/admin`)},m(n,a){D(n,e,a),u(e,t)},p(n,a){a&16&&se(t,"active",n[4]===`${ne}/admin`)},d(n){n&&f(e)}}}function lr(s){let e,t;return{c(){e=K("svg"),t=K("path"),this.h()},l(l){e=q(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,class:!0,"aria-hidden":!0});var n=y(e);t=q(n,"path",{stroke:!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),y(t).forEach(f),n.forEach(f),this.h()},h(){r(t,"stroke","currentColor"),r(t,"stroke-linecap","round"),r(t,"stroke-linejoin","round"),r(t,"stroke-width","2"),r(t,"d","M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"),r(e,"xmlns","http://www.w3.org/2000/svg"),r(e,"fill","none"),r(e,"viewBox","0 0 24 24"),r(e,"class","w-5 h-5"),r(e,"aria-hidden","true")},m(l,n){D(l,e,n),u(e,t)},d(l){l&&f(e)}}}function sr(s){let e,t;return{c(){e=K("svg"),t=K("path"),this.h()},l(l){e=q(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,class:!0,"aria-hidden":!0});var n=y(e);t=q(n,"path",{stroke:!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),y(t).forEach(f),n.forEach(f),this.h()},h(){r(t,"stroke","currentColor"),r(t,"stroke-linecap","round"),r(t,"stroke-linejoin","round"),r(t,"stroke-width","2"),r(t,"d","M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"),r(e,"xmlns","http://www.w3.org/2000/svg"),r(e,"fill","none"),r(e,"viewBox","0 0 24 24"),r(e,"class","w-5 h-5"),r(e,"aria-hidden","true")},m(l,n){D(l,e,n),u(e,t)},d(l){l&&f(e)}}}function Vl(s){let e,t,l,n,a,i,c="Menu",o,h,m='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="w-6 h-6"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>',v,g,p,d,b,_,M,C,T,z,x,E,I,A,B,N,V,j,H,P,U,R=`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="w-5 h-5"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg>
						Profile`,le,re,O,ie=`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="w-5 h-5"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path></svg>
						Logout`,ce,$,F=s[5]&&Ul(s);return{c(){e=w("div"),t=w("div"),l=L(),n=w("div"),a=w("div"),i=w("h2"),i.textContent=c,o=L(),h=w("button"),h.innerHTML=m,v=L(),g=w("ul"),p=w("li"),d=w("a"),b=K("svg"),_=K("path"),M=Q(`
						Channels`),T=L(),z=w("li"),x=w("a"),E=K("svg"),I=K("path"),A=Q(`
						Messages`),N=L(),F&&F.c(),V=L(),j=w("div"),H=L(),P=w("li"),U=w("button"),U.innerHTML=R,le=L(),re=w("li"),O=w("button"),O.innerHTML=ie,this.h()},l(X){e=k(X,"DIV",{class:!0});var G=y(e);t=k(G,"DIV",{class:!0,role:!0,tabindex:!0,"aria-label":!0}),y(t).forEach(f),l=S(G),n=k(G,"DIV",{class:!0});var be=y(n);a=k(be,"DIV",{class:!0});var ge=y(a);i=k(ge,"H2",{class:!0,"data-svelte-h":!0}),W(i)!=="svelte-l4e1ui"&&(i.textContent=c),o=S(ge),h=k(ge,"BUTTON",{class:!0,"aria-label":!0,"data-svelte-h":!0}),W(h)!=="svelte-1pmn0b8"&&(h.innerHTML=m),ge.forEach(f),v=S(be),g=k(be,"UL",{class:!0});var oe=y(g);p=k(oe,"LI",{});var ee=y(p);d=k(ee,"A",{href:!0,class:!0});var ue=y(d);b=q(ue,"svg",{xmlns:!0,fill:!0,viewBox:!0,class:!0});var we=y(b);_=q(we,"path",{stroke:!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),y(_).forEach(f),we.forEach(f),M=J(ue,`
						Channels`),ue.forEach(f),ee.forEach(f),T=S(oe),z=k(oe,"LI",{});var Me=y(z);x=k(Me,"A",{href:!0,class:!0});var Ee=y(x);E=q(Ee,"svg",{xmlns:!0,fill:!0,viewBox:!0,class:!0});var _e=y(E);I=q(_e,"path",{stroke:!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),y(I).forEach(f),_e.forEach(f),A=J(Ee,`
						Messages`),Ee.forEach(f),Me.forEach(f),N=S(oe),F&&F.l(oe),V=S(oe),j=k(oe,"DIV",{class:!0}),y(j).forEach(f),H=S(oe),P=k(oe,"LI",{});var Fe=y(P);U=k(Fe,"BUTTON",{class:!0,"data-svelte-h":!0}),W(U)!=="svelte-h9urup"&&(U.innerHTML=R),Fe.forEach(f),le=S(oe),re=k(oe,"LI",{});var et=y(re);O=k(et,"BUTTON",{class:!0,"data-svelte-h":!0}),W(O)!=="svelte-adz2xc"&&(O.innerHTML=ie),et.forEach(f),oe.forEach(f),be.forEach(f),G.forEach(f),this.h()},h(){r(t,"class","absolute inset-0 bg-black bg-opacity-50 animate-fade-in svelte-1833qa5"),r(t,"role","button"),r(t,"tabindex","0"),r(t,"aria-label","Close menu"),r(i,"class","text-lg font-bold"),r(h,"class","btn btn-ghost btn-square min-h-11 min-w-11"),r(h,"aria-label","Close menu"),r(a,"class","p-4 border-b border-base-300 flex items-center justify-between"),r(_,"stroke","currentColor"),r(_,"stroke-linecap","round"),r(_,"stroke-linejoin","round"),r(_,"stroke-width","2"),r(_,"d","M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"),r(b,"xmlns","http://www.w3.org/2000/svg"),r(b,"fill","none"),r(b,"viewBox","0 0 24 24"),r(b,"class","w-5 h-5"),r(d,"href",ne+"/chat"),r(d,"class",C="min-h-11 text-base "+(s[4].startsWith(`${ne}/chat`)?"active":"")),r(I,"stroke","currentColor"),r(I,"stroke-linecap","round"),r(I,"stroke-linejoin","round"),r(I,"stroke-width","2"),r(I,"d","M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"),r(E,"xmlns","http://www.w3.org/2000/svg"),r(E,"fill","none"),r(E,"viewBox","0 0 24 24"),r(E,"class","w-5 h-5"),r(x,"href",ne+"/dm"),r(x,"class",B="min-h-11 text-base "+(s[4].startsWith(`${ne}/dm`)?"active":"")),r(j,"class","divider my-2"),r(U,"class","min-h-11 text-base justify-start"),r(O,"class","min-h-11 text-base text-error justify-start"),r(g,"class","menu p-4 gap-2"),r(n,"class","absolute left-0 top-0 bottom-0 w-64 bg-base-200 shadow-xl animate-slide-in svelte-1833qa5"),r(e,"class","fixed inset-0 z-50 md:hidden")},m(X,G){D(X,e,G),u(e,t),u(e,l),u(e,n),u(n,a),u(a,i),u(a,o),u(a,h),u(n,v),u(n,g),u(g,p),u(p,d),u(d,b),u(b,_),u(d,M),u(g,T),u(g,z),u(z,x),u(x,E),u(E,I),u(x,A),u(g,N),F&&F.m(g,null),u(g,V),u(g,j),u(g,H),u(g,P),u(P,U),u(g,le),u(g,re),u(re,O),ce||($=[Z(t,"click",s[8]),Z(t,"keydown",s[14]),Z(h,"click",s[8]),Z(d,"click",s[9]),Z(x,"click",s[9]),Z(U,"click",s[10]),Z(O,"click",s[11])],ce=!0)},p(X,G){G&16&&C!==(C="min-h-11 text-base "+(X[4].startsWith(`${ne}/chat`)?"active":""))&&r(d,"class",C),G&16&&B!==(B="min-h-11 text-base "+(X[4].startsWith(`${ne}/dm`)?"active":""))&&r(x,"class",B),X[5]?F?F.p(X,G):(F=Ul(X),F.c(),F.m(g,V)):F&&(F.d(1),F=null)},d(X){X&&f(e),F&&F.d(),ce=!1,De($)}}}function Ul(s){let e,t,l,n,a,i,c,o,h;return{c(){e=w("li"),t=w("a"),l=K("svg"),n=K("path"),a=K("path"),i=Q(`
							Admin`),this.h()},l(m){e=k(m,"LI",{});var v=y(e);t=k(v,"A",{href:!0,class:!0});var g=y(t);l=q(g,"svg",{xmlns:!0,fill:!0,viewBox:!0,class:!0});var p=y(l);n=q(p,"path",{stroke:!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),y(n).forEach(f),a=q(p,"path",{stroke:!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),y(a).forEach(f),p.forEach(f),i=J(g,`
							Admin`),g.forEach(f),v.forEach(f),this.h()},h(){r(n,"stroke","currentColor"),r(n,"stroke-linecap","round"),r(n,"stroke-linejoin","round"),r(n,"stroke-width","2"),r(n,"d","M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"),r(a,"stroke","currentColor"),r(a,"stroke-linecap","round"),r(a,"stroke-linejoin","round"),r(a,"stroke-width","2"),r(a,"d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"),r(l,"xmlns","http://www.w3.org/2000/svg"),r(l,"fill","none"),r(l,"viewBox","0 0 24 24"),r(l,"class","w-5 h-5"),r(t,"href",ne+"/admin"),r(t,"class",c="min-h-11 text-base "+(s[4]===`${ne}/admin`?"active":""))},m(m,v){D(m,e,v),u(e,t),u(t,l),u(l,n),u(l,a),u(t,i),o||(h=Z(t,"click",s[9]),o=!0)},p(m,v){v&16&&c!==(c="min-h-11 text-base "+(m[4]===`${ne}/admin`?"active":""))&&r(t,"class",c)},d(m){m&&f(e),o=!1,h()}}}function nr(s){let e,t,l,n,a,i,c,o=s[6].name.split(" - ")[0]+"",h,m,v,g,p,d,b="Channels",_,M,C,T="Messages",z,x,E,I,A,B,N,V='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="w-5 h-5" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg>',j,H,P="Logout",U,R,le,re,O=s[5]&&jl(s);function ie(X,G){return X[0]==="dark"?sr:lr}let ce=ie(s),$=ce(s),F=s[3]&&Vl(s);return{c(){e=w("nav"),t=w("div"),l=w("button"),n=K("svg"),a=K("path"),i=L(),c=w("a"),h=Q(o),m=L(),v=w("div"),g=w("ul"),p=w("li"),d=w("a"),d.textContent=b,_=L(),M=w("li"),C=w("a"),C.textContent=T,z=L(),O&&O.c(),x=L(),E=w("div"),I=w("button"),$.c(),B=L(),N=w("button"),N.innerHTML=V,j=L(),H=w("button"),H.textContent=P,U=L(),F&&F.c(),R=ke(),this.h()},l(X){e=k(X,"NAV",{class:!0,role:!0,"aria-label":!0});var G=y(e);t=k(G,"DIV",{class:!0});var be=y(t);l=k(be,"BUTTON",{class:!0,"aria-label":!0,"aria-expanded":!0});var ge=y(l);n=q(ge,"svg",{xmlns:!0,fill:!0,viewBox:!0,class:!0});var oe=y(n);a=q(oe,"path",{stroke:!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),y(a).forEach(f),oe.forEach(f),ge.forEach(f),i=S(be),c=k(be,"A",{href:!0,class:!0});var ee=y(c);h=J(ee,o),ee.forEach(f),be.forEach(f),m=S(G),v=k(G,"DIV",{class:!0});var ue=y(v);g=k(ue,"UL",{class:!0});var we=y(g);p=k(we,"LI",{});var Me=y(p);d=k(Me,"A",{href:!0,class:!0,"data-svelte-h":!0}),W(d)!=="svelte-17bfivq"&&(d.textContent=b),Me.forEach(f),_=S(we),M=k(we,"LI",{});var Ee=y(M);C=k(Ee,"A",{href:!0,class:!0,"data-svelte-h":!0}),W(C)!=="svelte-1jnngtg"&&(C.textContent=T),Ee.forEach(f),z=S(we),O&&O.l(we),we.forEach(f),ue.forEach(f),x=S(G),E=k(G,"DIV",{class:!0});var _e=y(E);I=k(_e,"BUTTON",{class:!0,"aria-label":!0});var Fe=y(I);$.l(Fe),Fe.forEach(f),B=S(_e),N=k(_e,"BUTTON",{class:!0,"aria-label":!0,"data-svelte-h":!0}),W(N)!=="svelte-1gzalt1"&&(N.innerHTML=V),j=S(_e),H=k(_e,"BUTTON",{class:!0,"data-svelte-h":!0}),W(H)!=="svelte-1vmo7ww"&&(H.textContent=P),_e.forEach(f),G.forEach(f),U=S(X),F&&F.l(X),R=ke(),this.h()},h(){r(a,"stroke","currentColor"),r(a,"stroke-linecap","round"),r(a,"stroke-linejoin","round"),r(a,"stroke-width","2"),r(a,"d","M4 6h16M4 12h16M4 18h16"),r(n,"xmlns","http://www.w3.org/2000/svg"),r(n,"fill","none"),r(n,"viewBox","0 0 24 24"),r(n,"class","w-6 h-6"),r(l,"class","btn btn-ghost btn-square min-h-11 min-w-11 md:hidden"),r(l,"aria-label","Toggle menu"),r(l,"aria-expanded",s[3]),r(c,"href",ne+"/chat"),r(c,"class","btn btn-ghost text-xl"),r(t,"class","navbar-start"),r(d,"href",ne+"/chat"),r(d,"class","min-h-11"),se(d,"active",s[4].startsWith(`${ne}/chat`)),r(C,"href",ne+"/dm"),r(C,"class","min-h-11"),se(C,"active",s[4].startsWith(`${ne}/dm`)),r(g,"class","menu menu-horizontal px-1"),r(v,"class","navbar-center hidden md:flex"),r(I,"class","btn btn-ghost btn-circle min-h-11 min-w-11"),r(I,"aria-label",A=s[0]==="dark"?"Switch to light mode":"Switch to dark mode"),r(N,"class","btn btn-ghost btn-circle min-h-11 min-w-11 hidden md:flex"),r(N,"aria-label","Open profile settings"),r(H,"class","btn btn-ghost min-h-11 hidden md:inline-flex"),r(E,"class","navbar-end gap-2"),r(e,"class","navbar bg-base-200 shadow-lg"),r(e,"role","navigation"),r(e,"aria-label","Main navigation")},m(X,G){D(X,e,G),u(e,t),u(t,l),u(l,n),u(n,a),u(t,i),u(t,c),u(c,h),u(e,m),u(e,v),u(v,g),u(g,p),u(p,d),u(g,_),u(g,M),u(M,C),u(g,z),O&&O.m(g,null),u(e,x),u(e,E),u(E,I),$.m(I,null),u(E,B),u(E,N),u(E,j),u(E,H),D(X,U,G),F&&F.m(X,G),D(X,R,G),le||(re=[Z(l,"click",s[7]),Z(I,"click",function(){nt(s[1])&&s[1].apply(this,arguments)}),Z(N,"click",function(){nt(s[2])&&s[2].apply(this,arguments)}),Z(H,"click",s[11])],le=!0)},p(X,[G]){s=X,G&8&&r(l,"aria-expanded",s[3]),G&16&&se(d,"active",s[4].startsWith(`${ne}/chat`)),G&16&&se(C,"active",s[4].startsWith(`${ne}/dm`)),s[5]?O?O.p(s,G):(O=jl(s),O.c(),O.m(g,null)):O&&(O.d(1),O=null),ce!==(ce=ie(s))&&($.d(1),$=ce(s),$&&($.c(),$.m(I,null))),G&1&&A!==(A=s[0]==="dark"?"Switch to light mode":"Switch to dark mode")&&r(I,"aria-label",A),s[3]?F?F.p(s,G):(F=Vl(s),F.c(),F.m(R.parentNode,R)):F&&(F.d(1),F=null)},i:pe,o:pe,d(X){X&&(f(e),f(U),f(R)),O&&O.d(),$.d(),F&&F.d(X),le=!1,De(re)}}}function rr(s,e,t){let l,n,a,i;ve(s,Dt,C=>t(12,n=C)),ve(s,tl,C=>t(13,a=C)),ve(s,Ds,C=>t(5,i=C));const c=el();let{themePreference:o="dark"}=e,{onThemeToggle:h}=e,{onProfileClick:m}=e,v=!1;function g(){t(3,v=!v)}function p(){t(3,v=!1)}function d(){p()}function b(){m(),p()}function _(){ht.logout(),p()}const M=C=>C.key==="Escape"&&p();return s.$$set=C=>{"themePreference"in C&&t(0,o=C.themePreference),"onThemeToggle"in C&&t(1,h=C.onThemeToggle),"onProfileClick"in C&&t(2,m=C.onProfileClick)},s.$$.update=()=>{s.$$.dirty&8192,s.$$.dirty&4096&&t(4,l=n?.url?.pathname??"")},[o,h,m,v,l,i,c,g,p,d,b,_,n,a,M]}class ar extends He{constructor(e){super(),Oe(this,e,rr,nr,Pe,{themePreference:0,onThemeToggle:1,onProfileClick:2})}}const ir="https://image-api-617806532906.us-central1.run.app",Hl=5*1024*1024,Pt=1920,Hs=.85,At=200;async function or(s,e={}){const{maxWidth:t=Pt,maxHeight:l=Pt,quality:n=Hs,format:a="jpeg",generateThumbnail:i=!0}=e;return new Promise((c,o)=>{const h=new Image,m=document.createElement("canvas"),v=m.getContext("2d");if(!v){o(new Error("Failed to get canvas context"));return}h.onload=()=>{let{width:p,height:d}=h;p>t&&(d=d*t/p,p=t),d>l&&(p=p*l/d,d=l),p=Math.round(p),d=Math.round(d),m.width=p,m.height=d,v.drawImage(h,0,0,p,d);const b=a==="png"?"image/png":a==="webp"?"image/webp":"image/jpeg";m.toBlob(_=>{if(!_){o(new Error("Failed to compress image"));return}if(i){const M=document.createElement("canvas"),C=M.getContext("2d");if(C){const T=Math.min(h.width,h.height),z=(h.width-T)/2,x=(h.height-T)/2;M.width=At,M.height=At,C.drawImage(h,z,x,T,T,0,0,At,At),M.toBlob(E=>{c({blob:_,thumbnail:E||void 0,width:p,height:d})},b,n)}else c({blob:_,width:p,height:d})}else c({blob:_,width:p,height:d})},b,n)},h.onerror=()=>{o(new Error("Failed to load image"))};const g=new FileReader;g.onload=p=>{h.src=p.target?.result},g.onerror=()=>{o(new Error("Failed to read file"))},g.readAsDataURL(s)})}async function cr(s,e,t="message",l){if(s.size>Hl)return{success:!1,error:`File too large. Maximum size is ${Hl/1024/1024}MB`};if(!s.type.startsWith("image/"))return{success:!1,error:"File must be an image"};const n=l?.encrypt===!0;try{const{blob:a,thumbnail:i,width:c,height:o}=await or(s,{maxWidth:t==="avatar"?400:Pt,maxHeight:t==="avatar"?400:Pt,quality:t==="avatar"?.9:Hs,format:"jpeg",generateThumbnail:t!=="avatar"&&!n});let h=a,m;n&&l?.recipientPubkeys&&l?.senderPrivkey;const v=new FormData,g=n?"image.enc":"image.jpg",p=n?"application/octet-stream":"image/jpeg";v.append("image",h,g),v.append("pubkey",e),v.append("category",t),i&&!n&&v.append("thumbnail",i,"thumbnail.jpg");const d=await fetch(`${ir}/upload`,{method:"POST",body:v});if(!d.ok)return{success:!1,error:`Upload failed: ${await d.text()}`};const b=await d.json();return{success:!0,url:b.url,thumbnailUrl:n?void 0:b.thumbnailUrl,encrypted:n,encryptionData:m,metadata:{originalSize:s.size,compressedSize:h.size,width:c,height:o,format:n?"encrypted":"jpeg"}}}catch(a){return{success:!1,error:a instanceof Error?a.message:"Upload failed"}}}async function ur(s){return new Promise(e=>{const t=new Image;t.onload=()=>{if(t.width<50||t.height<50){e({valid:!1,error:"Image too small. Minimum size is 50x50 pixels"});return}if(Math.max(t.width,t.height)/Math.min(t.width,t.height)>10){e({valid:!1,error:"Image aspect ratio too extreme"});return}e({valid:!0,width:t.width,height:t.height})},t.onerror=()=>{e({valid:!1,error:"Failed to load image"})};const l=new FileReader;l.onload=n=>{t.src=n.target?.result},l.readAsDataURL(s)})}function fr(s){return URL.createObjectURL(s)}function Gt(s){URL.revokeObjectURL(s)}function dr(s){let e,t,l,n,a,i,c,o,h,m;function v(d,b){return d[6]?mr:pr}let g=v(s),p=g(s);return{c(){e=w("div"),t=K("svg"),l=K("path"),n=L(),a=w("span"),p.c(),i=L(),c=w("span"),o=Q("Max "),h=Q(s[0]),m=Q("MB"),this.h()},l(d){e=k(d,"DIV",{class:!0});var b=y(e);t=q(b,"svg",{xmlns:!0,fill:!0,viewBox:!0,class:!0});var _=y(t);l=q(_,"path",{stroke:!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),y(l).forEach(f),_.forEach(f),n=S(b),a=k(b,"SPAN",{class:!0});var M=y(a);p.l(M),M.forEach(f),i=S(b),c=k(b,"SPAN",{class:!0});var C=y(c);o=J(C,"Max "),h=J(C,s[0]),m=J(C,"MB"),C.forEach(f),b.forEach(f),this.h()},h(){r(l,"stroke","currentColor"),r(l,"stroke-linecap","round"),r(l,"stroke-linejoin","round"),r(l,"stroke-width","2"),r(l,"d","M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"),r(t,"xmlns","http://www.w3.org/2000/svg"),r(t,"fill","none"),r(t,"viewBox","0 0 24 24"),r(t,"class","icon svelte-z8kc2t"),r(a,"class","placeholder-text svelte-z8kc2t"),r(c,"class","size-hint svelte-z8kc2t"),r(e,"class","placeholder svelte-z8kc2t")},m(d,b){D(d,e,b),u(e,t),u(t,l),u(e,n),u(e,a),p.m(a,null),u(e,i),u(e,c),u(c,o),u(c,h),u(c,m)},p(d,b){g!==(g=v(d))&&(p.d(1),p=g(d),p&&(p.c(),p.m(a,null))),b&1&&he(h,d[0])},d(d){d&&f(e),p.d()}}}function hr(s){let e,t,l,n,a=!s[4]&&Ol();return{c(){e=w("img"),l=L(),a&&a.c(),n=ke(),this.h()},l(i){e=k(i,"IMG",{src:!0,alt:!0,class:!0}),l=S(i),a&&a.l(i),n=ke(),this.h()},h(){St(e.src,t=s[7])||r(e,"src",t),r(e,"alt","Preview"),r(e,"class","preview-image svelte-z8kc2t")},m(i,c){D(i,e,c),D(i,l,c),a&&a.m(i,c),D(i,n,c)},p(i,c){c&128&&!St(e.src,t=i[7])&&r(e,"src",t),i[4]?a&&(a.d(1),a=null):a||(a=Ol(),a.c(),a.m(n.parentNode,n))},d(i){i&&(f(e),f(l),f(n)),a&&a.d(i)}}}function pr(s){let e;return{c(){e=Q("Drop image here or click to upload")},l(t){e=J(t,"Drop image here or click to upload")},m(t,l){D(t,e,l)},d(t){t&&f(e)}}}function mr(s){let e;return{c(){e=Q("Upload avatar")},l(t){e=J(t,"Upload avatar")},m(t,l){D(t,e,l)},d(t){t&&f(e)}}}function Ol(s){let e,t='<span class="overlay-text svelte-z8kc2t">Click to change</span>';return{c(){e=w("div"),e.innerHTML=t,this.h()},l(l){e=k(l,"DIV",{class:!0,"data-svelte-h":!0}),W(e)!=="svelte-1he2pdm"&&(e.innerHTML=t),this.h()},h(){r(e,"class","overlay svelte-z8kc2t")},m(l,n){D(l,e,n)},d(l){l&&f(e)}}}function Fl(s){let e,t='<span class="loading loading-spinner loading-md"></span> <span class="upload-text svelte-z8kc2t">Uploading...</span>';return{c(){e=w("div"),e.innerHTML=t,this.h()},l(l){e=k(l,"DIV",{class:!0,"data-svelte-h":!0}),W(e)!=="svelte-1e8rzwh"&&(e.innerHTML=t),this.h()},h(){r(e,"class","upload-overlay svelte-z8kc2t")},m(l,n){D(l,e,n)},d(l){l&&f(e)}}}function Rl(s){let e,t,l,n,a,i;return{c(){e=w("div"),t=K("svg"),l=K("path"),n=L(),a=w("span"),i=Q(s[5]),this.h()},l(c){e=k(c,"DIV",{class:!0});var o=y(e);t=q(o,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0});var h=y(t);l=q(h,"path",{stroke:!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),y(l).forEach(f),h.forEach(f),n=S(o),a=k(o,"SPAN",{});var m=y(a);i=J(m,s[5]),m.forEach(f),o.forEach(f),this.h()},h(){r(l,"stroke","currentColor"),r(l,"stroke-linecap","round"),r(l,"stroke-linejoin","round"),r(l,"stroke-width","2"),r(l,"d","M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"),r(t,"xmlns","http://www.w3.org/2000/svg"),r(t,"class","error-icon svelte-z8kc2t"),r(t,"fill","none"),r(t,"viewBox","0 0 24 24"),r(e,"class","error-message svelte-z8kc2t")},m(c,o){D(c,e,o),u(e,t),u(t,l),u(e,n),u(e,a),u(a,i)},p(c,o){o&32&&he(i,c[5])},d(c){c&&f(e)}}}function Wl(s){let e,t="Remove image",l,n;return{c(){e=w("button"),e.textContent=t,this.h()},l(a){e=k(a,"BUTTON",{class:!0,"data-svelte-h":!0}),W(e)!=="svelte-10722ny"&&(e.textContent=t),this.h()},h(){r(e,"class","btn btn-ghost btn-xs mt-2")},m(a,i){D(a,e,i),l||(n=Z(e,"click",Rs(s[13])),l=!0)},p:pe,d(a){a&&f(e),l=!1,n()}}}function vr(s){let e,t,l,n,a,i,c,o,h;function m(_,M){return _[7]?hr:dr}let v=m(s),g=v(s),p=s[4]&&Fl(),d=s[5]&&Rl(s),b=s[7]&&!s[4]&&Wl(s);return{c(){e=w("div"),t=w("input"),l=L(),n=w("div"),g.c(),a=L(),p&&p.c(),i=L(),d&&d.c(),c=L(),b&&b.c(),this.h()},l(_){e=k(_,"DIV",{class:!0});var M=y(e);t=k(M,"INPUT",{type:!0,accept:!0,class:!0}),l=S(M),n=k(M,"DIV",{class:!0,role:!0,tabindex:!0});var C=y(n);g.l(C),a=S(C),p&&p.l(C),C.forEach(f),i=S(M),d&&d.l(M),c=S(M),b&&b.l(M),M.forEach(f),this.h()},h(){r(t,"type","file"),r(t,"accept",s[1]),r(t,"class","hidden svelte-z8kc2t"),r(n,"class","drop-zone svelte-z8kc2t"),r(n,"role","button"),r(n,"tabindex","0"),se(n,"drag-over",s[3]),se(n,"has-image",!!s[7]),se(n,"uploading",s[4]),r(e,"class","image-upload svelte-z8kc2t"),se(e,"is-avatar",s[6])},m(_,M){D(_,e,M),u(e,t),s[17](t),u(e,l),u(e,n),g.m(n,null),u(n,a),p&&p.m(n,null),u(e,i),d&&d.m(e,null),u(e,c),b&&b.m(e,null),o||(h=[Z(t,"change",s[8]),Z(n,"drop",s[9]),Z(n,"dragover",s[10]),Z(n,"dragleave",s[11]),Z(n,"click",s[12]),Z(n,"keydown",s[18])],o=!0)},p(_,[M]){M&2&&r(t,"accept",_[1]),v===(v=m(_))&&g?g.p(_,M):(g.d(1),g=v(_),g&&(g.c(),g.m(n,a))),_[4]?p||(p=Fl(),p.c(),p.m(n,null)):p&&(p.d(1),p=null),M&8&&se(n,"drag-over",_[3]),M&128&&se(n,"has-image",!!_[7]),M&16&&se(n,"uploading",_[4]),_[5]?d?d.p(_,M):(d=Rl(_),d.c(),d.m(e,c)):d&&(d.d(1),d=null),_[7]&&!_[4]?b?b.p(_,M):(b=Wl(_),b.c(),b.m(e,null)):b&&(b.d(1),b=null),M&64&&se(e,"is-avatar",_[6])},i:pe,o:pe,d(_){_&&f(e),s[17](null),g.d(),p&&p.d(),d&&d.d(),b&&b.d(),o=!1,De(h)}}}function br(s,e,t){let l,n,a;ve(s,ht,B=>t(20,a=B));let{category:i="message"}=e,{currentUrl:c=null}=e,{maxSizeMB:o=5}=e,{accept:h="image/jpeg,image/png,image/webp,image/gif"}=e;const m=Fs();let v,g=!1,p=!1,d=null,b=null;async function _(B){if(t(5,b=null),B.size>o*1024*1024){t(5,b=`File too large. Maximum size is ${o}MB`),m("error",b);return}const N=await ur(B);if(!N.valid){t(5,b=N.error||"Invalid image"),m("error",b);return}d&&Gt(d),t(16,d=fr(B)),t(4,p=!0);try{const V=a.publicKey||"anonymous",j=await cr(B,V,i);j.success?m("upload",j):(t(5,b=j.error||"Upload failed"),m("error",b),d&&(Gt(d),t(16,d=null)))}catch(V){t(5,b=V instanceof Error?V.message:"Upload failed"),m("error",b)}finally{t(4,p=!1)}}function M(B){const N=B.target,V=N.files?.[0];V&&_(V),N.value=""}function C(B){B.preventDefault(),t(3,g=!1);const N=B.dataTransfer?.files[0];N&&N.type.startsWith("image/")&&_(N)}function T(B){B.preventDefault(),t(3,g=!0)}function z(){t(3,g=!1)}function x(){v?.click()}function E(){d&&(Gt(d),t(16,d=null)),m("upload",{success:!0,url:""})}function I(B){Xt[B?"unshift":"push"](()=>{v=B,t(2,v)})}const A=B=>B.key==="Enter"&&x();return s.$$set=B=>{"category"in B&&t(14,i=B.category),"currentUrl"in B&&t(15,c=B.currentUrl),"maxSizeMB"in B&&t(0,o=B.maxSizeMB),"accept"in B&&t(1,h=B.accept)},s.$$.update=()=>{s.$$.dirty&98304&&t(7,l=d||c),s.$$.dirty&16384&&t(6,n=i==="avatar")},[o,h,v,g,p,b,n,l,M,C,T,z,x,E,i,c,d,I,A]}class gr extends He{constructor(e){super(),Oe(this,e,br,vr,Pe,{category:14,currentUrl:15,maxSizeMB:0,accept:1})}}function ql(s){let e,t,l,n="X",a,i,c="Your Profile",o,h,m,v,g,p,d,b=(s[6]||"Anonymous")+"",_,M,C,T=ut(s[15])+"",z,x,E,I,A='<span class="label-text font-semibold">Nickname</span>',B,N,V,j,H,P,U="Avatar",R,le,re=s[12]?"Use URL":"Upload Image",O,ie,ce,$,F,X,G,be='<span class="label-text font-semibold">Birthday</span> <span class="label-text-alt text-base-content/60">Optional</span>',ge,oe,ee,ue,we='<span class="label-text-alt text-base-content/60">Visible to tribe members on the calendar</span>',Me,Ee,_e,Fe,et,pt,zt,ze,Ge,rl='<span class="label-text font-semibold">Public Key (npub)</span> <div class="tooltip tooltip-left" data-tip="Your public key is safe to share with anyone. It&#39;s how others find and message you."><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="w-5 h-5 text-info cursor-help"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div>',jt,Ye,je,mt,Vt,Re,Ut,Je,al='<span class="label-text-alt text-success">Safe to share - this is how others find you</span>',Ht,We,Qe,il='<span class="label-text font-semibold">Private Key (nsec)</span> <div class="tooltip tooltip-left" data-tip="Your private key controls your identity. NEVER share it with anyone. Anyone with it can impersonate you permanently."><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="w-5 h-5 text-error cursor-help"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div>',Ot,Ft,tt,qe,Rt,ol;function cl(Y,de){return Y[7]?kr:_r}let bt=cl(s),xe=bt(s);const ul=[yr,wr],Xe=[];function fl(Y,de){return Y[12]?0:1}ce=fl(s),$=Xe[ce]=ul[ce](s);let ye=s[11]&&Kl(s);function dl(Y,de){return Y[10]?Mr:Y[9]?Er:Cr}let gt=dl(s),Ke=gt(s);function hl(Y,de){if(Y[16])return Tr;if(Y[17])return Ir}let rt=hl(s),Ce=rt&&rt(s);function pl(Y,de){return Y[4]?Sr:Br}let _t=pl(s),Ze=_t(s);function ml(Y,de){return Y[1]?Lr:Nr}let kt=ml(s),Ae=kt(s);return{c(){e=w("div"),t=w("div"),l=w("button"),l.textContent=n,a=L(),i=w("h3"),i.textContent=c,o=L(),h=w("div"),m=w("div"),v=w("div"),xe.c(),g=L(),p=w("div"),d=w("div"),_=Q(b),M=L(),C=w("div"),z=Q(T),x=L(),E=w("div"),I=w("label"),I.innerHTML=A,B=L(),N=w("input"),V=L(),j=w("div"),H=w("label"),P=w("span"),P.textContent=U,R=L(),le=w("button"),O=Q(re),ie=L(),$.c(),F=L(),X=w("div"),G=w("label"),G.innerHTML=be,ge=L(),oe=w("input"),ee=L(),ue=w("label"),ue.innerHTML=we,Me=L(),ye&&ye.c(),Ee=L(),_e=w("button"),Ke.c(),Fe=L(),Ce&&Ce.c(),et=L(),pt=w("div"),zt=L(),ze=w("div"),Ge=w("label"),Ge.innerHTML=rl,jt=L(),Ye=w("div"),je=w("input"),Vt=L(),Re=w("button"),Ze.c(),Ut=L(),Je=w("label"),Je.innerHTML=al,Ht=L(),We=w("div"),Qe=w("label"),Qe.innerHTML=il,Ot=L(),Ae.c(),Ft=L(),tt=w("div"),this.h()},l(Y){e=k(Y,"DIV",{class:!0,role:!0,"aria-modal":!0,"aria-labelledby":!0});var de=y(e);t=k(de,"DIV",{class:!0});var fe=y(t);l=k(fe,"BUTTON",{class:!0,"aria-label":!0,"data-svelte-h":!0}),W(l)!=="svelte-11hc4lv"&&(l.textContent=n),a=S(fe),i=k(fe,"H3",{id:!0,class:!0,"data-svelte-h":!0}),W(i)!=="svelte-4jq17b"&&(i.textContent=c),o=S(fe),h=k(fe,"DIV",{class:!0});var wt=y(h);m=k(wt,"DIV",{class:!0});var vl=y(m);v=k(vl,"DIV",{class:!0});var bl=y(v);xe.l(bl),bl.forEach(f),vl.forEach(f),g=S(wt),p=k(wt,"DIV",{class:!0});var yt=y(p);d=k(yt,"DIV",{class:!0});var gl=y(d);_=J(gl,b),gl.forEach(f),M=S(yt),C=k(yt,"DIV",{class:!0});var _l=y(C);z=J(_l,T),_l.forEach(f),yt.forEach(f),wt.forEach(f),x=S(fe),E=k(fe,"DIV",{class:!0});var Ct=y(E);I=k(Ct,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),W(I)!=="svelte-192l7n9"&&(I.innerHTML=A),B=S(Ct),N=k(Ct,"INPUT",{id:!0,type:!0,placeholder:!0,class:!0,maxlength:!0}),Ct.forEach(f),V=S(fe),j=k(fe,"DIV",{class:!0});var Et=y(j);H=k(Et,"LABEL",{class:!0});var Mt=y(H);P=k(Mt,"SPAN",{class:!0,"data-svelte-h":!0}),W(P)!=="svelte-1byrh1j"&&(P.textContent=U),R=S(Mt),le=k(Mt,"BUTTON",{class:!0});var kl=y(le);O=J(kl,re),kl.forEach(f),Mt.forEach(f),ie=S(Et),$.l(Et),Et.forEach(f),F=S(fe),X=k(fe,"DIV",{class:!0});var at=y(X);G=k(at,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),W(G)!=="svelte-1lno6f0"&&(G.innerHTML=be),ge=S(at),oe=k(at,"INPUT",{id:!0,type:!0,class:!0}),ee=S(at),ue=k(at,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),W(ue)!=="svelte-v050nx"&&(ue.innerHTML=we),at.forEach(f),Me=S(fe),ye&&ye.l(fe),Ee=S(fe),_e=k(fe,"BUTTON",{class:!0});var wl=y(_e);Ke.l(wl),wl.forEach(f),Fe=S(fe),Ce&&Ce.l(fe),et=S(fe),pt=k(fe,"DIV",{class:!0}),y(pt).forEach(f),zt=S(fe),ze=k(fe,"DIV",{class:!0});var it=y(ze);Ge=k(it,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),W(Ge)!=="svelte-1u6kjmg"&&(Ge.innerHTML=rl),jt=S(it),Ye=k(it,"DIV",{class:!0});var It=y(Ye);je=k(It,"INPUT",{id:!0,type:!0,class:!0}),Vt=S(It),Re=k(It,"BUTTON",{class:!0,title:!0});var yl=y(Re);Ze.l(yl),yl.forEach(f),It.forEach(f),Ut=S(it),Je=k(it,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),W(Je)!=="svelte-5rwzav"&&(Je.innerHTML=al),it.forEach(f),Ht=S(fe),We=k(fe,"DIV",{class:!0});var Tt=y(We);Qe=k(Tt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),W(Qe)!=="svelte-8l2gpw"&&(Qe.innerHTML=il),Ot=S(Tt),Ae.l(Tt),Tt.forEach(f),fe.forEach(f),Ft=S(de),tt=k(de,"DIV",{class:!0,"aria-hidden":!0}),y(tt).forEach(f),de.forEach(f),this.h()},h(){r(l,"class","btn btn-sm btn-circle btn-ghost absolute right-2 top-2"),r(l,"aria-label","Close profile modal"),r(i,"id","profile-modal-title"),r(i,"class","font-bold text-lg mb-4"),r(v,"class","w-16 h-16 rounded-full bg-base-300 flex items-center justify-center overflow-hidden"),r(m,"class","avatar"),r(d,"class","text-sm font-medium mb-1"),r(C,"class","text-xs text-base-content/60 font-mono"),r(p,"class","flex-1"),r(h,"class","flex items-center gap-4 mb-4"),r(I,"class","label py-1"),r(I,"for","profile-nickname-input"),r(N,"id","profile-nickname-input"),r(N,"type","text"),r(N,"placeholder","Enter a display name"),r(N,"class","input input-bordered input-sm"),r(N,"maxlength","50"),r(E,"class","form-control mb-3"),r(P,"class","label-text font-semibold"),r(le,"class","btn btn-ghost btn-xs"),r(H,"class","label py-1"),r(j,"class","form-control mb-3"),r(G,"class","label py-1"),r(G,"for","profile-birthday-input"),r(oe,"id","profile-birthday-input"),r(oe,"type","date"),r(oe,"class","input input-bordered input-sm"),r(ue,"class","label py-1"),r(ue,"for","profile-birthday-input"),r(X,"class","form-control mb-4"),r(_e,"class","btn btn-primary btn-sm w-full mb-4"),_e.disabled=s[10],r(pt,"class","divider my-2"),r(Ge,"class","label"),r(Ge,"for","profile-npub-input"),r(je,"id","profile-npub-input"),r(je,"type","text"),je.readOnly=!0,je.value=mt=ut(s[15]),r(je,"class","input input-bordered flex-1 font-mono text-sm"),r(Re,"class","btn btn-square btn-outline"),r(Re,"title","Copy full npub"),r(Ye,"class","flex gap-2"),r(Je,"class","label"),r(Je,"for","profile-npub-input"),r(ze,"class","form-control mb-4"),r(Qe,"class","label"),r(Qe,"for","profile-nsec-input"),r(We,"class","form-control"),r(t,"class","modal-box max-w-md"),r(tt,"class","modal-backdrop"),r(tt,"aria-hidden","true"),r(e,"class","modal modal-open"),r(e,"role","dialog"),r(e,"aria-modal","true"),r(e,"aria-labelledby","profile-modal-title")},m(Y,de){D(Y,e,de),u(e,t),u(t,l),u(t,a),u(t,i),u(t,o),u(t,h),u(h,m),u(m,v),xe.m(v,null),u(h,g),u(h,p),u(p,d),u(d,_),u(p,M),u(p,C),u(C,z),u(t,x),u(t,E),u(E,I),u(E,B),u(E,N),ct(N,s[6]),u(t,V),u(t,j),u(j,H),u(H,P),u(H,R),u(H,le),u(le,O),u(j,ie),Xe[ce].m(j,null),u(t,F),u(t,X),u(X,G),u(X,ge),u(X,oe),ct(oe,s[8]),u(X,ee),u(X,ue),u(t,Me),ye&&ye.m(t,null),u(t,Ee),u(t,_e),Ke.m(_e,null),u(t,Fe),Ce&&Ce.m(t,null),u(t,et),u(t,pt),u(t,zt),u(t,ze),u(ze,Ge),u(ze,jt),u(ze,Ye),u(Ye,je),u(Ye,Vt),u(Ye,Re),Ze.m(Re,null),u(ze,Ut),u(ze,Je),u(t,Ht),u(t,We),u(We,Qe),u(We,Ot),Ae.m(We,null),u(e,Ft),u(e,tt),qe=!0,Rt||(ol=[Z(l,"click",s[24]),Z(N,"input",s[30]),Z(le,"click",s[31]),Z(oe,"input",s[33]),Z(_e,"click",s[26]),Z(Re,"click",s[34]),Z(tt,"click",s[24]),Z(e,"keydown",s[25])],Rt=!0)},p(Y,de){bt===(bt=cl(Y))&&xe?xe.p(Y,de):(xe.d(1),xe=bt(Y),xe&&(xe.c(),xe.m(v,null))),(!qe||de[0]&64)&&b!==(b=(Y[6]||"Anonymous")+"")&&he(_,b),(!qe||de[0]&32768)&&T!==(T=ut(Y[15])+"")&&he(z,T),de[0]&64&&N.value!==Y[6]&&ct(N,Y[6]),(!qe||de[0]&4096)&&re!==(re=Y[12]?"Use URL":"Upload Image")&&he(O,re);let fe=ce;ce=fl(Y),ce===fe?Xe[ce].p(Y,de):(Ie(),ae(Xe[fe],1,1,()=>{Xe[fe]=null}),Te(),$=Xe[ce],$?$.p(Y,de):($=Xe[ce]=ul[ce](Y),$.c()),te($,1),$.m(j,null)),de[0]&256&&ct(oe,Y[8]),Y[11]?ye?ye.p(Y,de):(ye=Kl(Y),ye.c(),ye.m(t,Ee)):ye&&(ye.d(1),ye=null),gt!==(gt=dl(Y))&&(Ke.d(1),Ke=gt(Y),Ke&&(Ke.c(),Ke.m(_e,null))),(!qe||de[0]&1024)&&(_e.disabled=Y[10]),rt===(rt=hl(Y))&&Ce?Ce.p(Y,de):(Ce&&Ce.d(1),Ce=rt&&rt(Y),Ce&&(Ce.c(),Ce.m(t,et))),(!qe||de[0]&32768&&mt!==(mt=ut(Y[15]))&&je.value!==mt)&&(je.value=mt),_t!==(_t=pl(Y))&&(Ze.d(1),Ze=_t(Y),Ze&&(Ze.c(),Ze.m(Re,null))),kt===(kt=ml(Y))&&Ae?Ae.p(Y,de):(Ae.d(1),Ae=kt(Y),Ae&&(Ae.c(),Ae.m(We,null)))},i(Y){qe||(te($),qe=!0)},o(Y){ae($),qe=!1},d(Y){Y&&f(e),xe.d(),Xe[ce].d(),ye&&ye.d(),Ke.d(),Ce&&Ce.d(),Ze.d(),Ae.d(),Rt=!1,De(ol)}}}function _r(s){let e,t;return{c(){e=K("svg"),t=K("path"),this.h()},l(l){e=q(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,class:!0});var n=y(e);t=q(n,"path",{stroke:!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),y(t).forEach(f),n.forEach(f),this.h()},h(){r(t,"stroke","currentColor"),r(t,"stroke-linecap","round"),r(t,"stroke-linejoin","round"),r(t,"stroke-width","2"),r(t,"d","M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"),r(e,"xmlns","http://www.w3.org/2000/svg"),r(e,"fill","none"),r(e,"viewBox","0 0 24 24"),r(e,"class","w-8 h-8 text-base-content/50")},m(l,n){D(l,e,n),u(e,t)},p:pe,d(l){l&&f(e)}}}function kr(s){let e,t;return{c(){e=w("img"),this.h()},l(l){e=k(l,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){St(e.src,t=s[7])||r(e,"src",t),r(e,"alt","Avatar"),r(e,"class","w-full h-full object-cover")},m(l,n){D(l,e,n)},p(l,n){n[0]&128&&!St(e.src,t=l[7])&&r(e,"src",t)},d(l){l&&f(e)}}}function wr(s){let e,t,l,n='<span class="label-text-alt text-base-content/60">Direct link to an image</span>',a,i;return{c(){e=w("input"),t=L(),l=w("label"),l.innerHTML=n,this.h()},l(c){e=k(c,"INPUT",{id:!0,type:!0,placeholder:!0,class:!0}),t=S(c),l=k(c,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),W(l)!=="svelte-19snjop"&&(l.innerHTML=n),this.h()},h(){r(e,"id","profile-avatar-input"),r(e,"type","url"),r(e,"placeholder","https://example.com/avatar.jpg"),r(e,"class","input input-bordered input-sm"),r(l,"class","label py-1"),r(l,"for","profile-avatar-input")},m(c,o){D(c,e,o),ct(e,s[7]),D(c,t,o),D(c,l,o),a||(i=Z(e,"input",s[32]),a=!0)},p(c,o){o[0]&128&&e.value!==c[7]&&ct(e,c[7])},i:pe,o:pe,d(c){c&&(f(e),f(t),f(l)),a=!1,i()}}}function yr(s){let e,t,l;return t=new gr({props:{category:"avatar",currentUrl:s[7]}}),t.$on("upload",s[20]),t.$on("error",s[21]),{c(){e=w("div"),Ne(t.$$.fragment),this.h()},l(n){e=k(n,"DIV",{class:!0});var a=y(e);Le(t.$$.fragment,a),a.forEach(f),this.h()},h(){r(e,"class","flex justify-center")},m(n,a){D(n,e,a),Se(t,e,null),l=!0},p(n,a){const i={};a[0]&128&&(i.currentUrl=n[7]),t.$set(i)},i(n){l||(te(t.$$.fragment,n),l=!0)},o(n){ae(t.$$.fragment,n),l=!1},d(n){n&&f(e),Be(t)}}}function Kl(s){let e,t,l,n,a,i;return{c(){e=w("div"),t=K("svg"),l=K("path"),n=L(),a=w("span"),i=Q(s[11]),this.h()},l(c){e=k(c,"DIV",{class:!0});var o=y(e);t=q(o,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0});var h=y(t);l=q(h,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),y(l).forEach(f),h.forEach(f),n=S(o),a=k(o,"SPAN",{class:!0});var m=y(a);i=J(m,s[11]),m.forEach(f),o.forEach(f),this.h()},h(){r(l,"stroke-linecap","round"),r(l,"stroke-linejoin","round"),r(l,"stroke-width","2"),r(l,"d","M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"),r(t,"xmlns","http://www.w3.org/2000/svg"),r(t,"class","stroke-current shrink-0 h-5 w-5"),r(t,"fill","none"),r(t,"viewBox","0 0 24 24"),r(a,"class","text-sm"),r(e,"class","alert alert-error mb-3 py-2")},m(c,o){D(c,e,o),u(e,t),u(t,l),u(e,n),u(e,a),u(a,i)},p(c,o){o[0]&2048&&he(i,c[11])},d(c){c&&f(e)}}}function Cr(s){let e;return{c(){e=Q("Save & Publish Profile")},l(t){e=J(t,"Save & Publish Profile")},m(t,l){D(t,e,l)},d(t){t&&f(e)}}}function Er(s){let e,t,l;return{c(){e=K("svg"),t=K("path"),l=Q(`
					Profile Published!`),this.h()},l(n){e=q(n,"svg",{xmlns:!0,fill:!0,viewBox:!0,class:!0});var a=y(e);t=q(a,"path",{stroke:!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),y(t).forEach(f),a.forEach(f),l=J(n,`
					Profile Published!`),this.h()},h(){r(t,"stroke","currentColor"),r(t,"stroke-linecap","round"),r(t,"stroke-linejoin","round"),r(t,"stroke-width","2"),r(t,"d","M5 13l4 4L19 7"),r(e,"xmlns","http://www.w3.org/2000/svg"),r(e,"fill","none"),r(e,"viewBox","0 0 24 24"),r(e,"class","w-4 h-4 text-success")},m(n,a){D(n,e,a),u(e,t),D(n,l,a)},d(n){n&&(f(e),f(l))}}}function Mr(s){let e,t;return{c(){e=w("span"),t=Q(`
					Publishing to relay...`),this.h()},l(l){e=k(l,"SPAN",{class:!0}),y(e).forEach(f),t=J(l,`
					Publishing to relay...`),this.h()},h(){r(e,"class","loading loading-spinner loading-sm")},m(l,n){D(l,e,n),D(l,t,n)},d(l){l&&(f(e),f(t))}}}function Ir(s){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="w-5 h-5"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg> <span>App installed</span>';return{c(){e=w("div"),e.innerHTML=t,this.h()},l(l){e=k(l,"DIV",{class:!0,"data-svelte-h":!0}),W(e)!=="svelte-699wmn"&&(e.innerHTML=t),this.h()},h(){r(e,"class","flex items-center gap-2 text-sm text-success mb-4 px-2")},m(l,n){D(l,e,n)},p:pe,d(l){l&&f(e)}}}function Tr(s){let e,t,l,n,a,i,c,o,h,m,v="Get offline access and faster loading",g,p,d,b;function _(T,z){return T[13]?Ar:xr}let M=_(s),C=M(s);return{c(){e=w("div"),t=K("svg"),l=K("path"),n=L(),a=w("div"),i=w("p"),c=Q("Install "),o=Q(s[18]),h=L(),m=w("p"),m.textContent=v,g=L(),p=w("button"),C.c(),this.h()},l(T){e=k(T,"DIV",{class:!0});var z=y(e);t=q(z,"svg",{xmlns:!0,fill:!0,viewBox:!0,class:!0});var x=y(t);l=q(x,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),y(l).forEach(f),x.forEach(f),n=S(z),a=k(z,"DIV",{class:!0});var E=y(a);i=k(E,"P",{class:!0});var I=y(i);c=J(I,"Install "),o=J(I,s[18]),I.forEach(f),h=S(E),m=k(E,"P",{class:!0,"data-svelte-h":!0}),W(m)!=="svelte-o4avhp"&&(m.textContent=v),E.forEach(f),g=S(z),p=k(z,"BUTTON",{class:!0});var A=y(p);C.l(A),A.forEach(f),z.forEach(f),this.h()},h(){r(l,"stroke-linecap","round"),r(l,"stroke-linejoin","round"),r(l,"stroke-width","2"),r(l,"d","M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"),r(t,"xmlns","http://www.w3.org/2000/svg"),r(t,"fill","none"),r(t,"viewBox","0 0 24 24"),r(t,"class","stroke-current shrink-0 w-5 h-5"),r(i,"class","font-semibold text-sm"),r(m,"class","text-xs opacity-80"),r(a,"class","flex-1"),r(p,"class","btn btn-sm btn-primary"),p.disabled=s[13],r(e,"class","alert alert-info mb-4")},m(T,z){D(T,e,z),u(e,t),u(t,l),u(e,n),u(e,a),u(a,i),u(i,c),u(i,o),u(a,h),u(a,m),u(e,g),u(e,p),C.m(p,null),d||(b=Z(p,"click",s[19]),d=!0)},p(T,z){M!==(M=_(T))&&(C.d(1),C=M(T),C&&(C.c(),C.m(p,null))),z[0]&8192&&(p.disabled=T[13])},d(T){T&&f(e),C.d(),d=!1,b()}}}function xr(s){let e;return{c(){e=Q("Install")},l(t){e=J(t,"Install")},m(t,l){D(t,e,l)},d(t){t&&f(e)}}}function Ar(s){let e;return{c(){e=w("span"),this.h()},l(t){e=k(t,"SPAN",{class:!0}),y(e).forEach(f),this.h()},h(){r(e,"class","loading loading-spinner loading-xs")},m(t,l){D(t,e,l)},d(t){t&&f(e)}}}function Br(s){let e,t;return{c(){e=K("svg"),t=K("path"),this.h()},l(l){e=q(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,class:!0});var n=y(e);t=q(n,"path",{stroke:!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),y(t).forEach(f),n.forEach(f),this.h()},h(){r(t,"stroke","currentColor"),r(t,"stroke-linecap","round"),r(t,"stroke-linejoin","round"),r(t,"stroke-width","2"),r(t,"d","M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"),r(e,"xmlns","http://www.w3.org/2000/svg"),r(e,"fill","none"),r(e,"viewBox","0 0 24 24"),r(e,"class","w-5 h-5")},m(l,n){D(l,e,n),u(e,t)},d(l){l&&f(e)}}}function Sr(s){let e,t;return{c(){e=K("svg"),t=K("path"),this.h()},l(l){e=q(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,class:!0});var n=y(e);t=q(n,"path",{stroke:!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),y(t).forEach(f),n.forEach(f),this.h()},h(){r(t,"stroke","currentColor"),r(t,"stroke-linecap","round"),r(t,"stroke-linejoin","round"),r(t,"stroke-width","2"),r(t,"d","M5 13l4 4L19 7"),r(e,"xmlns","http://www.w3.org/2000/svg"),r(e,"fill","none"),r(e,"viewBox","0 0 24 24"),r(e,"class","w-5 h-5 text-success")},m(l,n){D(l,e,n),u(e,t)},d(l){l&&f(e)}}}function Lr(s){let e,t,l,n,a,i,c="Your private key is now visible. Never share it!",o,h,m,v,g,p,d,b,_,M,C,T,z,x,E='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="w-5 h-5"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"></path></svg>',I,A;function B(j,H){return j[5]?Dr:Pr}let N=B(s),V=N(s);return{c(){e=w("div"),t=K("svg"),l=K("path"),n=L(),a=w("div"),i=w("span"),i.textContent=c,o=L(),h=w("div"),m=Q("Auto-hiding in "),v=w("span"),g=Q(s[3]),p=Q("s"),d=L(),b=w("div"),_=w("input"),C=L(),T=w("button"),V.c(),z=L(),x=w("button"),x.innerHTML=E,this.h()},l(j){e=k(j,"DIV",{class:!0});var H=y(e);t=q(H,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0});var P=y(t);l=q(P,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),y(l).forEach(f),P.forEach(f),n=S(H),a=k(H,"DIV",{class:!0});var U=y(a);i=k(U,"SPAN",{class:!0,"data-svelte-h":!0}),W(i)!=="svelte-6n7w1g"&&(i.textContent=c),o=S(U),h=k(U,"DIV",{class:!0});var R=y(h);m=J(R,"Auto-hiding in "),v=k(R,"SPAN",{class:!0});var le=y(v);g=J(le,s[3]),p=J(le,"s"),le.forEach(f),R.forEach(f),U.forEach(f),H.forEach(f),d=S(j),b=k(j,"DIV",{class:!0});var re=y(b);_=k(re,"INPUT",{type:!0,class:!0}),C=S(re),T=k(re,"BUTTON",{class:!0,title:!0});var O=y(T);V.l(O),O.forEach(f),z=S(re),x=k(re,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),W(x)!=="svelte-h7hl0y"&&(x.innerHTML=E),re.forEach(f),this.h()},h(){r(l,"stroke-linecap","round"),r(l,"stroke-linejoin","round"),r(l,"stroke-width","2"),r(l,"d","M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"),r(t,"xmlns","http://www.w3.org/2000/svg"),r(t,"class","stroke-current shrink-0 h-5 w-5"),r(t,"fill","none"),r(t,"viewBox","0 0 24 24"),r(i,"class","text-sm font-semibold"),r(v,"class","font-mono font-bold"),r(h,"class","text-xs opacity-80 mt-1"),r(a,"class","flex-1"),r(e,"class","alert alert-warning mb-2"),r(_,"type","text"),_.readOnly=!0,_.value=M=ut(s[14]),r(_,"class","input input-bordered input-error flex-1 font-mono text-sm"),r(T,"class","btn btn-square btn-outline btn-warning"),r(T,"title","Copy full nsec"),r(x,"class","btn btn-square btn-outline"),r(x,"title","Hide private key"),r(b,"class","flex gap-2 mb-2")},m(j,H){D(j,e,H),u(e,t),u(t,l),u(e,n),u(e,a),u(a,i),u(a,o),u(a,h),u(h,m),u(h,v),u(v,g),u(v,p),D(j,d,H),D(j,b,H),u(b,_),u(b,C),u(b,T),V.m(T,null),u(b,z),u(b,x),I||(A=[Z(T,"click",s[37]),Z(x,"click",s[23])],I=!0)},p(j,H){H[0]&8&&he(g,j[3]),H[0]&16384&&M!==(M=ut(j[14]))&&_.value!==M&&(_.value=M),N!==(N=B(j))&&(V.d(1),V=N(j),V&&(V.c(),V.m(T,null)))},d(j){j&&(f(e),f(d),f(b)),V.d(),I=!1,De(A)}}}function Nr(s){let e,t='<svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-5 w-5" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg> <div class="text-sm"><p class="font-bold">NEVER share your private key!</p> <p>Anyone with it controls your identity permanently.</p></div>',l,n,a,i,c,o,h="I understand the risk and want to reveal my private key",m,v,g,p,d,b;return{c(){e=w("div"),e.innerHTML=t,l=L(),n=w("div"),a=w("label"),i=w("input"),c=L(),o=w("span"),o.textContent=h,m=L(),v=w("button"),g=Q("Reveal Private Key"),this.h()},l(_){e=k(_,"DIV",{class:!0,"data-svelte-h":!0}),W(e)!=="svelte-1sprta3"&&(e.innerHTML=t),l=S(_),n=k(_,"DIV",{class:!0});var M=y(n);a=k(M,"LABEL",{class:!0});var C=y(a);i=k(C,"INPUT",{type:!0,class:!0}),c=S(C),o=k(C,"SPAN",{class:!0,"data-svelte-h":!0}),W(o)!=="svelte-144kc2"&&(o.textContent=h),C.forEach(f),M.forEach(f),m=S(_),v=k(_,"BUTTON",{class:!0});var T=y(v);g=J(T,"Reveal Private Key"),T.forEach(f),this.h()},h(){r(e,"class","alert alert-error mb-3"),r(i,"type","checkbox"),r(i,"class","checkbox checkbox-error"),r(o,"class","label-text text-sm"),r(a,"class","label cursor-pointer justify-start gap-3 py-2"),r(n,"class","form-control mb-3"),r(v,"class","btn btn-outline btn-error btn-sm w-full"),v.disabled=p=!s[2]},m(_,M){D(_,e,M),D(_,l,M),D(_,n,M),u(n,a),u(a,i),i.checked=s[2],u(a,c),u(a,o),D(_,m,M),D(_,v,M),u(v,g),d||(b=[Z(i,"change",s[35]),Z(v,"click",s[36])],d=!0)},p(_,M){M[0]&4&&(i.checked=_[2]),M[0]&4&&p!==(p=!_[2])&&(v.disabled=p)},d(_){_&&(f(e),f(l),f(n),f(m),f(v)),d=!1,De(b)}}}function Pr(s){let e,t;return{c(){e=K("svg"),t=K("path"),this.h()},l(l){e=q(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,class:!0});var n=y(e);t=q(n,"path",{stroke:!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),y(t).forEach(f),n.forEach(f),this.h()},h(){r(t,"stroke","currentColor"),r(t,"stroke-linecap","round"),r(t,"stroke-linejoin","round"),r(t,"stroke-width","2"),r(t,"d","M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"),r(e,"xmlns","http://www.w3.org/2000/svg"),r(e,"fill","none"),r(e,"viewBox","0 0 24 24"),r(e,"class","w-5 h-5")},m(l,n){D(l,e,n),u(e,t)},d(l){l&&f(e)}}}function Dr(s){let e,t;return{c(){e=K("svg"),t=K("path"),this.h()},l(l){e=q(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,class:!0});var n=y(e);t=q(n,"path",{stroke:!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),y(t).forEach(f),n.forEach(f),this.h()},h(){r(t,"stroke","currentColor"),r(t,"stroke-linecap","round"),r(t,"stroke-linejoin","round"),r(t,"stroke-width","2"),r(t,"d","M5 13l4 4L19 7"),r(e,"xmlns","http://www.w3.org/2000/svg"),r(e,"fill","none"),r(e,"viewBox","0 0 24 24"),r(e,"class","w-5 h-5 text-success")},m(l,n){D(l,e,n),u(e,t)},d(l){l&&f(e)}}}function zr(s){let e,t,l=s[0]&&ql(s);return{c(){l&&l.c(),e=ke()},l(n){l&&l.l(n),e=ke()},m(n,a){l&&l.m(n,a),D(n,e,a),t=!0},p(n,a){n[0]?l?(l.p(n,a),a[0]&1&&te(l,1)):(l=ql(n),l.c(),te(l,1),l.m(e.parentNode,e)):l&&(Ie(),ae(l,1,1,()=>{l=null}),Te())},i(n){t||(te(l),t=!0)},o(n){ae(l),t=!1},d(n){n&&f(e),l&&l.d(n)}}}const Yt=30;function ut(s){return s.length<=20?s:s.slice(0,12)+"..."+s.slice(-8)}function jr(s,e,t){let l,n,a,i,c;ve(s,ht,ee=>t(29,a=ee)),ve(s,Ss,ee=>t(16,i=ee)),ve(s,xs,ee=>t(17,c=ee));const h=el().name.split(" - ")[0];let{open:m=!1}=e,v=!1,g=!1,p=null,d=Yt,b=!1,_=!1,M="",C="",T="",z=!1,x=!1,E=null,I=null,A=!1,B=!1;async function N(){t(13,B=!0);try{await Ls()}finally{t(13,B=!1)}}function V(ee){const ue=ee.detail;ue.success&&ue.url&&t(7,C=ue.url)}function j(ee){t(11,E=ee.detail)}let H=!1;function P(){t(3,d=Yt),p=setInterval(()=>{t(3,d--,d),d<=0&&R()},1e3)}function U(){p&&(clearInterval(p),p=null),t(3,d=Yt)}function R(){t(1,v=!1),t(2,g=!1),U()}function le(){t(0,m=!1),R(),t(9,z=!1),I&&(I.focus(),I=null)}function re(ee){if(ee.key==="Escape"&&m&&le(),ee.key==="Tab"&&m){const ue=document.querySelector(".modal.modal-open");if(!ue)return;const we=ue.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),Me=we[0],Ee=we[we.length-1];ee.shiftKey&&document.activeElement===Me?(ee.preventDefault(),Ee.focus()):!ee.shiftKey&&document.activeElement===Ee&&(ee.preventDefault(),Me.focus())}}async function O(){if(!a.publicKey||!a.privateKey){t(11,E="Not authenticated");return}t(10,x=!0),t(11,E=null);try{const ee=js();if(!ee)throw new Error("NDK not connected");const ue=new Bs(ee);ue.kind=0,ue.content=JSON.stringify({name:M||void 0,display_name:M||void 0,picture:C||void 0,birthday:T||void 0}),await ue.sign(),await ue.publish(),ht.setProfile(M||null,C||null),a.publicKey&&(Wt.remove(a.publicKey),Wt.updateCurrentUserProfile(a.publicKey,M||null,C||null)),t(9,z=!0),setTimeout(()=>t(9,z=!1),3e3)}catch(ee){console.error("Failed to publish profile:",ee),t(11,E=ee instanceof Error?ee.message:"Failed to save profile")}finally{t(10,x=!1)}}async function ie(ee,ue){await navigator.clipboard.writeText(ee),ue==="npub"?(t(4,b=!0),setTimeout(()=>t(4,b=!1),2e3)):(t(5,_=!0),setTimeout(()=>t(5,_=!1),2e3))}function ce(){M=this.value,t(6,M),t(0,m),t(28,H),t(29,a)}const $=()=>t(12,A=!A);function F(){C=this.value,t(7,C),t(0,m),t(28,H),t(29,a)}function X(){T=this.value,t(8,T),t(0,m),t(28,H),t(29,a)}const G=()=>ie(l,"npub");function be(){g=this.checked,t(2,g)}const ge=()=>{t(1,v=!0),P()},oe=()=>ie(n,"nsec");return s.$$set=ee=>{"open"in ee&&t(0,m=ee.open)},s.$$.update=()=>{s.$$.dirty[0]&536870912&&t(15,l=a.publicKey?kn(a.publicKey):""),s.$$.dirty[0]&536870912&&t(14,n=a.privateKey?wn(a.privateKey):""),s.$$.dirty[0]&1&&t(28,H=m),s.$$.dirty[0]&805306369&&m&&!H&&(t(6,M=a.nickname||""),t(7,C=a.avatar||""),t(8,T=""),I=document.activeElement,a.publicKey&&Wt.getProfile(a.publicKey).then(ee=>{t(8,T=ee.profile?.birthday||"")}))},[m,v,g,d,b,_,M,C,T,z,x,E,A,B,n,l,i,c,h,N,V,j,P,R,le,re,O,ie,H,a,ce,$,F,X,G,be,ge,oe]}class Vr extends He{constructor(e){super(),Oe(this,e,jr,zr,Pe,{open:0},null,[-1,-1])}}function Zl(s,e,t){const l=s.slice();l[16]=e[t],l[23]=t;const n=Gr(l[16]);l[17]=n;const a=l[7](l[16].id);l[18]=a;const i=l[6](l[16]);l[19]=i;const c=l[16].branding?.displayName||l[16].name;l[20]=c;const o=!l[19];return l[21]=o,l}function Gl(s,e,t){const l=s.slice();l[24]=e[t];const n=l[8](l[24].id);return l[25]=n,l}function Yl(s){let e,t="Zones";return{c(){e=w("span"),e.textContent=t,this.h()},l(l){e=k(l,"SPAN",{class:!0,"data-svelte-h":!0}),W(e)!=="svelte-f54ky0"&&(e.textContent=t),this.h()},h(){r(e,"class","text-xs font-semibold text-base-content/50 uppercase tracking-wider")},m(l,n){D(l,e,n)},d(l){l&&f(e)}}}function Ur(s){let e;return{c(){e=K("path"),this.h()},l(t){e=q(t,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),y(e).forEach(f),this.h()},h(){r(e,"stroke-linecap","round"),r(e,"stroke-linejoin","round"),r(e,"stroke-width","2"),r(e,"d","M11 19l-7-7 7-7m8 14l-7-7 7-7")},m(t,l){D(t,e,l)},d(t){t&&f(e)}}}function Hr(s){let e;return{c(){e=K("path"),this.h()},l(t){e=q(t,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),y(e).forEach(f),this.h()},h(){r(e,"stroke-linecap","round"),r(e,"stroke-linejoin","round"),r(e,"stroke-width","2"),r(e,"d","M13 5l7 7-7 7M5 5l7 7-7 7")},m(t,l){D(t,e,l)},d(t){t&&f(e)}}}function Or(s){let e,t=s[16].icon+"",l;return{c(){e=w("span"),l=Q(t),this.h()},l(n){e=k(n,"SPAN",{class:!0,style:!0});var a=y(e);l=J(a,t),a.forEach(f),this.h()},h(){r(e,"class","text-lg"),$e(e,"color",s[17])},m(n,a){D(n,e,a),u(e,l)},p(n,a){a&16&&t!==(t=n[16].icon+"")&&he(l,t),a&16&&$e(e,"color",n[17])},d(n){n&&f(e)}}}function Fr(s){let e,t="";return{c(){e=w("span"),e.textContent=t,this.h()},l(l){e=k(l,"SPAN",{class:!0,"data-svelte-h":!0}),W(e)!=="svelte-xtpphb"&&(e.textContent=t),this.h()},h(){r(e,"class","text-lg locked-icon svelte-1jmcf64")},m(l,n){D(l,e,n)},p:pe,d(l){l&&f(e)}}}function Jl(s){let e;function t(a,i){return a[21]?Wr:Rr}let l=t(s),n=l(s);return{c(){n.c(),e=ke()},l(a){n.l(a),e=ke()},m(a,i){n.m(a,i),D(a,e,i)},p(a,i){l===(l=t(a))&&n?n.p(a,i):(n.d(1),n=l(a),n&&(n.c(),n.m(e.parentNode,e)))},d(a){a&&f(e),n.d(a)}}}function Rr(s){let e,t=s[20]+"",l,n,a,i=s[16].access?.strictIsolation&&Ql();return{c(){e=w("span"),l=Q(t),n=L(),i&&i.c(),a=ke(),this.h()},l(c){e=k(c,"SPAN",{class:!0});var o=y(e);l=J(o,t),o.forEach(f),n=S(c),i&&i.l(c),a=ke(),this.h()},h(){r(e,"class","flex-1 truncate font-medium")},m(c,o){D(c,e,o),u(e,l),D(c,n,o),i&&i.m(c,o),D(c,a,o)},p(c,o){o&16&&t!==(t=c[20]+"")&&he(l,t),c[16].access?.strictIsolation?i||(i=Ql(),i.c(),i.m(a.parentNode,a)):i&&(i.d(1),i=null)},d(c){c&&(f(e),f(n),f(a)),i&&i.d(c)}}}function Wr(s){let e,t=s[5](s[20].length,s[23]*13)+"",l,n,a,i="";return{c(){e=w("span"),l=Q(t),n=L(),a=w("span"),a.textContent=i,this.h()},l(c){e=k(c,"SPAN",{class:!0});var o=y(e);l=J(o,t),o.forEach(f),n=S(c),a=k(c,"SPAN",{class:!0,"data-svelte-h":!0}),W(a)!=="svelte-ymsxf"&&(a.textContent=i),this.h()},h(){r(e,"class","flex-1 truncate font-mono text-sm scrambled-text svelte-1jmcf64"),r(a,"class","text-xs opacity-40 font-mono")},m(c,o){D(c,e,o),u(e,l),D(c,n,o),D(c,a,o)},p(c,o){o&16&&t!==(t=c[5](c[20].length,c[23]*13)+"")&&he(l,t)},d(c){c&&(f(e),f(n),f(a))}}}function Ql(s){let e,t="Private";return{c(){e=w("span"),e.textContent=t,this.h()},l(l){e=k(l,"SPAN",{class:!0,"data-svelte-h":!0}),W(e)!=="svelte-1gwrh53"&&(e.textContent=t),this.h()},h(){r(e,"class","badge badge-xs badge-ghost")},m(l,n){D(l,e,n)},d(l){l&&f(e)}}}function Xl(s){let e,t=[],l=new Map,n=Ue(s[16].sections);const a=i=>i[24].id;for(let i=0;i<n.length;i+=1){let c=Gl(s,n,i),o=a(c);l.set(o,t[i]=es(o,c))}return{c(){e=w("ul");for(let i=0;i<t.length;i+=1)t[i].c();this.h()},l(i){e=k(i,"UL",{class:!0});var c=y(e);for(let o=0;o<t.length;o+=1)t[o].l(c);c.forEach(f),this.h()},h(){r(e,"class","ml-4 border-l-2 border-base-300")},m(i,c){D(i,e,c);for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(e,null)},p(i,c){c&272&&(n=Ue(i[16].sections),t=ll(t,c,a,1,i,n,l,e,Vs,es,null,Gl))},d(i){i&&f(e);for(let c=0;c<t.length;c+=1)t[c].d()}}}function $l(s){let e,t="Approval";return{c(){e=w("span"),e.textContent=t,this.h()},l(l){e=k(l,"SPAN",{class:!0,"data-svelte-h":!0}),W(e)!=="svelte-w2xoc8"&&(e.textContent=t),this.h()},h(){r(e,"class","badge badge-xs badge-warning")},m(l,n){D(l,e,n)},d(l){l&&f(e)}}}function es(s,e){let t,l,n,a=e[24].icon+"",i,c,o,h=e[24].name+"",m,v,g,p,d,b,_=e[24].access.requiresApproval&&$l();return{key:s,first:null,c(){t=w("li"),l=w("a"),n=w("span"),i=Q(a),c=L(),o=w("span"),m=Q(h),v=L(),_&&_.c(),b=L(),this.h()},l(M){t=k(M,"LI",{});var C=y(t);l=k(C,"A",{href:!0,class:!0,style:!0});var T=y(l);n=k(T,"SPAN",{class:!0});var z=y(n);i=J(z,a),z.forEach(f),c=S(T),o=k(T,"SPAN",{class:!0});var x=y(o);m=J(x,h),x.forEach(f),v=S(T),_&&_.l(T),T.forEach(f),b=S(C),C.forEach(f),this.h()},h(){r(n,"class","text-base"),r(o,"class","truncate"),r(l,"href",g=ne+"/"+e[16].id+"/"+e[24].id),r(l,"class",p="flex items-center gap-2 py-2 "+(e[25]?"bg-primary/10 text-primary":"")),r(l,"style",d=e[25]?`color: ${e[17]};`:""),this.first=t},m(M,C){D(M,t,C),u(t,l),u(l,n),u(n,i),u(l,c),u(l,o),u(o,m),u(l,v),_&&_.m(l,null),u(t,b)},p(M,C){e=M,C&16&&a!==(a=e[24].icon+"")&&he(i,a),C&16&&h!==(h=e[24].name+"")&&he(m,h),e[24].access.requiresApproval?_||(_=$l(),_.c(),_.m(l,null)):_&&(_.d(1),_=null),C&16&&g!==(g=ne+"/"+e[16].id+"/"+e[24].id)&&r(l,"href",g),C&16&&p!==(p="flex items-center gap-2 py-2 "+(e[25]?"bg-primary/10 text-primary":""))&&r(l,"class",p),C&16&&d!==(d=e[25]?`color: ${e[17]};`:"")&&r(l,"style",d)},d(M){M&&f(t),_&&_.d()}}}function ts(s,e){let t,l,n,a,i,c,o,h;function m(b,_){return b[21]?Fr:Or}let v=m(e),g=v(e),p=!e[0]&&Jl(e),d=!e[0]&&e[19]&&Xl(e);return{key:s,first:null,c(){t=w("li"),l=w("details"),n=w("summary"),g.c(),a=L(),p&&p.c(),c=L(),d&&d.c(),h=L(),this.h()},l(b){t=k(b,"LI",{});var _=y(t);l=k(_,"DETAILS",{class:!0});var M=y(l);n=k(M,"SUMMARY",{class:!0,style:!0});var C=y(n);g.l(C),a=S(C),p&&p.l(C),C.forEach(f),c=S(M),d&&d.l(M),M.forEach(f),h=S(_),_.forEach(f),this.h()},h(){r(n,"class","flex items-center gap-2 rounded-lg transition-colors svelte-1jmcf64"),r(n,"style",i=e[18]&&e[19]?`border-left: 3px solid ${e[17]};`:""),se(n,"bg-base-200",e[18]&&e[19]),se(n,"locked-zone",e[21]),se(n,"cursor-not-allowed",e[21]),l.open=o=e[18]&&e[19],r(l,"class","svelte-1jmcf64"),se(l,"pointer-events-none",e[21]),this.first=t},m(b,_){D(b,t,_),u(t,l),u(l,n),g.m(n,null),u(n,a),p&&p.m(n,null),u(l,c),d&&d.m(l,null),u(t,h)},p(b,_){e=b,v===(v=m(e))&&g?g.p(e,_):(g.d(1),g=v(e),g&&(g.c(),g.m(n,a))),e[0]?p&&(p.d(1),p=null):p?p.p(e,_):(p=Jl(e),p.c(),p.m(n,null)),_&16&&i!==(i=e[18]&&e[19]?`border-left: 3px solid ${e[17]};`:"")&&r(n,"style",i),_&208&&se(n,"bg-base-200",e[18]&&e[19]),_&80&&se(n,"locked-zone",e[21]),_&80&&se(n,"cursor-not-allowed",e[21]),!e[0]&&e[19]?d?d.p(e,_):(d=Xl(e),d.c(),d.m(l,null)):d&&(d.d(1),d=null),_&16&&o!==(o=e[18]&&e[19])&&(l.open=o),_&80&&se(l,"pointer-events-none",e[21])},d(b){b&&f(t),g.d(),p&&p.d(),d&&d.d()}}}function ls(s){let e,t='<p class="text-sm">No zones available</p> <p class="text-xs mt-1">Contact admin for access</p>';return{c(){e=w("div"),e.innerHTML=t,this.h()},l(l){e=k(l,"DIV",{class:!0,"data-svelte-h":!0}),W(e)!=="svelte-9zfzb5"&&(e.innerHTML=t),this.h()},h(){r(e,"class","px-4 py-8 text-center text-base-content/50")},m(l,n){D(l,e,n)},d(l){l&&f(e)}}}function qr(s){let e,t,l,n,a,i,c,o,h,m,v=[],g=new Map,p,d,b,_=!s[0]&&Yl();function M(I,A){return I[0]?Hr:Ur}let C=M(s),T=C(s),z=Ue(s[4]);const x=I=>`${I[16].id}-${I[3]}-${I[2]}`;for(let I=0;I<z.length;I+=1){let A=Zl(s,z,I),B=x(A);g.set(B,v[I]=ts(B,A))}let E=!s[0]&&s[4].length===0&&ls();return{c(){e=w("nav"),t=w("div"),_&&_.c(),l=L(),n=w("button"),a=K("svg"),T.c(),o=L(),h=L(),m=w("ul");for(let I=0;I<v.length;I+=1)v[I].c();p=L(),E&&E.c(),this.h()},l(I){e=k(I,"NAV",{class:!0});var A=y(e);t=k(A,"DIV",{class:!0});var B=y(t);_&&_.l(B),l=S(B),n=k(B,"BUTTON",{class:!0,"aria-label":!0});var N=y(n);a=q(N,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var V=y(a);T.l(V),V.forEach(f),N.forEach(f),B.forEach(f),o=S(A),h=S(A),m=k(A,"UL",{class:!0});var j=y(m);for(let H=0;H<v.length;H+=1)v[H].l(j);j.forEach(f),p=S(A),E&&E.l(A),A.forEach(f),this.h()},h(){r(a,"xmlns","http://www.w3.org/2000/svg"),r(a,"class","h-4 w-4"),r(a,"fill","none"),r(a,"viewBox","0 0 24 24"),r(a,"stroke","currentColor"),r(n,"class",i="btn btn-ghost btn-sm btn-square "+(s[0]?"mx-auto":"")),r(n,"aria-label",c=s[0]?"Expand zones":"Collapse zones"),r(t,"class","zone-nav-header flex items-center justify-between p-3 border-b border-base-300 dark:border-base-content/10"),r(m,"class","menu menu-sm gap-1"),r(e,"class","zone-nav svelte-1jmcf64"),se(e,"collapsed",s[0])},m(I,A){D(I,e,A),u(e,t),_&&_.m(t,null),u(t,l),u(t,n),u(n,a),T.m(a,null),u(e,o),u(e,h),u(e,m);for(let B=0;B<v.length;B+=1)v[B]&&v[B].m(m,null);u(e,p),E&&E.m(e,null),d||(b=Z(n,"click",function(){nt(s[1])&&s[1].apply(this,arguments)}),d=!0)},p(I,[A]){s=I,s[0]?_&&(_.d(1),_=null):_||(_=Yl(),_.c(),_.m(t,l)),C!==(C=M(s))&&(T.d(1),T=C(s),T&&(T.c(),T.m(a,null))),A&1&&i!==(i="btn btn-ghost btn-sm btn-square "+(s[0]?"mx-auto":""))&&r(n,"class",i),A&1&&c!==(c=s[0]?"Expand zones":"Collapse zones")&&r(n,"aria-label",c),A&509&&(z=Ue(s[4]),v=ll(v,A,x,1,s,z,g,m,Vs,ts,null,Zl)),!s[0]&&s[4].length===0?E||(E=ls(),E.c(),E.m(e,null)):E&&(E.d(1),E=null),A&1&&se(e,"collapsed",s[0])},i:pe,o:pe,d(I){I&&f(e),_&&_.d(),T.d();for(let A=0;A<v.length;A+=1)v[A].d();E&&E.d(),d=!1,b()}}}const Kr="",Zr="";function Gr(s){return s.branding?.primaryColor||s.ui?.color||"#6366f1"}function Yr(s,e,t){let l,n,a,i,c,o;ve(s,tl,T=>t(11,c=T)),ve(s,zs,T=>t(12,o=T));let{currentCategoryId:h=null}=e,{currentSectionId:m=null}=e,{collapsed:v=!1}=e,{onToggle:g=void 0}=e,p=0,d;function b(T,z=0){const x=Kr+Zr;let E="";for(let I=0;I<T;I++){const A=(p+z+I*7)%x.length;E+=x[A]}return E}function _(T){if(a)return!0;if(!i)return!1;const z=T.access?.visibleToCohorts||[],x=T.access?.hiddenFromCohorts||[];if(z.length===0&&x.length===0)return!0;const E=n;return x.some(I=>E.includes(I))?!1:z.length===0?!0:z.some(I=>E.includes(I)||I==="cross-access")}function M(T){return h===T}function C(T){return m===T}return Qt(()=>{d=setInterval(()=>{p=(p+1)%100},80)}),ys(()=>{d&&clearInterval(d)}),s.$$set=T=>{"currentCategoryId"in T&&t(9,h=T.currentCategoryId),"currentSectionId"in T&&t(10,m=T.currentSectionId),"collapsed"in T&&t(0,v=T.collapsed),"onToggle"in T&&t(1,g=T.onToggle)},s.$$.update=()=>{s.$$.dirty&6144&&(n=o?.cohorts??c.profile?.cohorts??[]),s.$$.dirty&6144&&t(3,a=o?.isAdmin??c.profile?.isAdmin??!1),s.$$.dirty&6144&&t(2,i=o?.isWhitelisted??c.profile?.isApproved??!1)},t(4,l=Ns()),[v,g,i,a,l,b,_,M,C,h,m,c,o]}class Jr extends He{constructor(e){super(),Oe(this,e,Yr,qr,Pe,{currentCategoryId:9,currentSectionId:10,collapsed:0,onToggle:1})}}function ss(s){let e,t,l,n,a,i,c="Admin",o;return{c(){e=w("a"),t=K("svg"),l=K("path"),n=K("path"),a=L(),i=w("span"),i.textContent=c,this.h()},l(h){e=k(h,"A",{href:!0,class:!0,"aria-label":!0,"aria-current":!0});var m=y(e);t=q(m,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var v=y(t);l=q(v,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),y(l).forEach(f),n=q(v,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),y(n).forEach(f),v.forEach(f),a=S(m),i=k(m,"SPAN",{class:!0,"data-svelte-h":!0}),W(i)!=="svelte-q7z5td"&&(i.textContent=c),m.forEach(f),this.h()},h(){r(l,"stroke-linecap","round"),r(l,"stroke-linejoin","round"),r(l,"stroke-width","2"),r(l,"d","M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"),r(n,"stroke-linecap","round"),r(n,"stroke-linejoin","round"),r(n,"stroke-width","2"),r(n,"d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"),r(t,"xmlns","http://www.w3.org/2000/svg"),r(t,"class","h-5 w-5"),r(t,"fill","none"),r(t,"viewBox","0 0 24 24"),r(t,"stroke","currentColor"),r(i,"class","btm-nav-label text-xs svelte-n36fz9"),r(e,"href",ne+"/admin"),r(e,"class","text-base-content/70 hover:text-primary transition-colors svelte-n36fz9"),r(e,"aria-label","Go to admin"),r(e,"aria-current",o=s[2]?"page":void 0),se(e,"active",s[2])},m(h,m){D(h,e,m),u(e,t),u(t,l),u(t,n),u(e,a),u(e,i)},p(h,m){m&4&&o!==(o=h[2]?"page":void 0)&&r(e,"aria-current",o),m&4&&se(e,"active",h[2])},d(h){h&&f(e)}}}function Qr(s){let e,t,l='<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h7"></path></svg> <span class="btm-nav-label text-xs svelte-n36fz9">Zones</span>',n,a,i,c,o,h,m="Chat",v,g,p,d,b,_,M,C="Messages",T,z,x,E,I='<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg> <span class="btm-nav-label text-xs svelte-n36fz9">Profile</span>',A,B,N=s[5]&&ss(s);return{c(){e=w("nav"),t=w("button"),t.innerHTML=l,n=L(),a=w("a"),i=K("svg"),c=K("path"),o=L(),h=w("span"),h.textContent=m,g=L(),p=w("a"),d=K("svg"),b=K("path"),_=L(),M=w("span"),M.textContent=C,z=L(),N&&N.c(),x=L(),E=w("button"),E.innerHTML=I,this.h()},l(V){e=k(V,"NAV",{class:!0,role:!0,"aria-label":!0});var j=y(e);t=k(j,"BUTTON",{class:!0,"aria-label":!0,"data-svelte-h":!0}),W(t)!=="svelte-hm2x7o"&&(t.innerHTML=l),n=S(j),a=k(j,"A",{href:!0,class:!0,"aria-label":!0,"aria-current":!0});var H=y(a);i=q(H,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var P=y(i);c=q(P,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),y(c).forEach(f),P.forEach(f),o=S(H),h=k(H,"SPAN",{class:!0,"data-svelte-h":!0}),W(h)!=="svelte-l9jizu"&&(h.textContent=m),H.forEach(f),g=S(j),p=k(j,"A",{href:!0,class:!0,"aria-label":!0,"aria-current":!0});var U=y(p);d=q(U,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var R=y(d);b=q(R,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),y(b).forEach(f),R.forEach(f),_=S(U),M=k(U,"SPAN",{class:!0,"data-svelte-h":!0}),W(M)!=="svelte-17o0txo"&&(M.textContent=C),U.forEach(f),z=S(j),N&&N.l(j),x=S(j),E=k(j,"BUTTON",{class:!0,"aria-label":!0,"data-svelte-h":!0}),W(E)!=="svelte-149yiy8"&&(E.innerHTML=I),j.forEach(f),this.h()},h(){r(t,"class","text-base-content/70 hover:text-primary transition-colors svelte-n36fz9"),r(t,"aria-label","Open zones menu"),se(t,"active",!1),r(c,"stroke-linecap","round"),r(c,"stroke-linejoin","round"),r(c,"stroke-width","2"),r(c,"d","M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"),r(i,"xmlns","http://www.w3.org/2000/svg"),r(i,"class","h-5 w-5"),r(i,"fill","none"),r(i,"viewBox","0 0 24 24"),r(i,"stroke","currentColor"),r(h,"class","btm-nav-label text-xs svelte-n36fz9"),r(a,"href",ne+"/chat"),r(a,"class","text-base-content/70 hover:text-primary transition-colors svelte-n36fz9"),r(a,"aria-label","Go to channels"),r(a,"aria-current",v=s[4]?"page":void 0),se(a,"active",s[4]),r(b,"stroke-linecap","round"),r(b,"stroke-linejoin","round"),r(b,"stroke-width","2"),r(b,"d","M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"),r(d,"xmlns","http://www.w3.org/2000/svg"),r(d,"class","h-5 w-5"),r(d,"fill","none"),r(d,"viewBox","0 0 24 24"),r(d,"stroke","currentColor"),r(M,"class","btm-nav-label text-xs svelte-n36fz9"),r(p,"href",ne+"/dm"),r(p,"class","text-base-content/70 hover:text-primary transition-colors svelte-n36fz9"),r(p,"aria-label","Go to direct messages"),r(p,"aria-current",T=s[3]?"page":void 0),se(p,"active",s[3]),r(E,"class","text-base-content/70 hover:text-primary transition-colors svelte-n36fz9"),r(E,"aria-label","Open profile"),r(e,"class","btm-nav btm-nav-md bg-base-200 border-t border-base-300 md:hidden z-40 svelte-n36fz9"),r(e,"role","navigation"),r(e,"aria-label","Mobile navigation")},m(V,j){D(V,e,j),u(e,t),u(e,n),u(e,a),u(a,i),u(i,c),u(a,o),u(a,h),u(e,g),u(e,p),u(p,d),u(d,b),u(p,_),u(p,M),u(e,z),N&&N.m(e,null),u(e,x),u(e,E),A||(B=[Z(t,"click",function(){nt(s[0])&&s[0].apply(this,arguments)}),Z(E,"click",function(){nt(s[1])&&s[1].apply(this,arguments)})],A=!0)},p(V,[j]){s=V,j&16&&v!==(v=s[4]?"page":void 0)&&r(a,"aria-current",v),j&16&&se(a,"active",s[4]),j&8&&T!==(T=s[3]?"page":void 0)&&r(p,"aria-current",T),j&8&&se(p,"active",s[3]),s[5]?N?N.p(s,j):(N=ss(s),N.c(),N.m(e,x)):N&&(N.d(1),N=null)},i:pe,o:pe,d(V){V&&f(e),N&&N.d(),A=!1,De(B)}}}function Xr(s,e,t){let l,n,a,i,c,o;ve(s,Dt,v=>t(7,c=v)),ve(s,Ds,v=>t(5,o=v));let{onZonesClick:h}=e,{onProfileClick:m}=e;return s.$$set=v=>{"onZonesClick"in v&&t(0,h=v.onZonesClick),"onProfileClick"in v&&t(1,m=v.onProfileClick)},s.$$.update=()=>{s.$$.dirty&128&&t(6,l=c?.url?.pathname??""),s.$$.dirty&64&&t(4,n=l.startsWith(`${ne}/chat`)||l&&l.match(new RegExp(`^${ne}/[^/]+/[^/]+$`))),s.$$.dirty&64&&t(3,a=l.startsWith(`${ne}/dm`)),s.$$.dirty&64&&t(2,i=l===`${ne}/admin`)},[h,m,i,a,n,o,l,c]}class $r extends He{constructor(e){super(),Oe(this,e,Xr,Qr,Pe,{onZonesClick:0,onProfileClick:1})}}function ns(s,e,t){const l=s.slice();l[18]=e[t];const n=sa(l[18]);l[19]=n;const a=l[5](l[18]);l[20]=a;const i=l[18].branding?.displayName||l[18].name;l[21]=i;const c=l[3]===l[18].id;return l[22]=c,l}function rs(s,e,t){const l=s.slice();l[25]=e[t];const n=l[2]===l[25].id&&l[3]===l[18].id;return l[26]=n,l}function as(s){let e,t,l,n,a,i='<div class="w-12 h-1.5 bg-base-content/20 rounded-full"></div>',c,o,h,m="Zones",v,g,p='<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>',d,b,_,M,C,T,z,x=Ue(s[4]),E=[];for(let A=0;A<x.length;A+=1)E[A]=us(ns(s,x,A));let I=s[4].length===0&&fs();return{c(){e=w("div"),l=L(),n=w("div"),a=w("div"),a.innerHTML=i,c=L(),o=w("div"),h=w("h2"),h.textContent=m,v=L(),g=w("button"),g.innerHTML=p,d=L(),b=w("div");for(let A=0;A<E.length;A+=1)E[A].c();_=L(),I&&I.c(),this.h()},l(A){e=k(A,"DIV",{class:!0,role:!0,tabindex:!0,"aria-label":!0}),y(e).forEach(f),l=S(A),n=k(A,"DIV",{class:!0,role:!0,"aria-modal":!0,"aria-label":!0});var B=y(n);a=k(B,"DIV",{class:!0,"data-svelte-h":!0}),W(a)!=="svelte-bwejfd"&&(a.innerHTML=i),c=S(B),o=k(B,"DIV",{class:!0});var N=y(o);h=k(N,"H2",{class:!0,"data-svelte-h":!0}),W(h)!=="svelte-dnbrc"&&(h.textContent=m),v=S(N),g=k(N,"BUTTON",{class:!0,"aria-label":!0,"data-svelte-h":!0}),W(g)!=="svelte-c6sszy"&&(g.innerHTML=p),N.forEach(f),d=S(B),b=k(B,"DIV",{class:!0});var V=y(b);for(let j=0;j<E.length;j+=1)E[j].l(V);_=S(V),I&&I.l(V),V.forEach(f),B.forEach(f),this.h()},h(){r(e,"class","fixed inset-0 bg-black/50 z-50 md:hidden"),r(e,"role","button"),r(e,"tabindex","0"),r(e,"aria-label","Close zones drawer"),r(a,"class","flex justify-center py-3"),r(h,"class","text-lg font-bold"),r(g,"class","btn btn-ghost btn-sm btn-circle"),r(g,"aria-label","Close"),r(o,"class","flex items-center justify-between px-4 pb-3 border-b border-base-300"),r(b,"class","overflow-y-auto flex-1 px-2 py-3 pb-safe svelte-12n8t3o"),r(n,"class","fixed inset-x-0 bottom-0 z-50 bg-base-100 rounded-t-2xl shadow-2xl md:hidden max-h-[80vh] flex flex-col"),r(n,"role","dialog"),r(n,"aria-modal","true"),r(n,"aria-label","Zones navigation")},m(A,B){D(A,e,B),D(A,l,B),D(A,n,B),u(n,a),u(n,c),u(n,o),u(o,h),u(o,v),u(o,g),u(n,d),u(n,b);for(let N=0;N<E.length;N+=1)E[N]&&E[N].m(b,null);u(b,_),I&&I.m(b,null),C=!0,T||(z=[Z(e,"click",s[7]),Z(e,"keydown",s[14]),Z(g,"click",function(){nt(s[1])&&s[1].apply(this,arguments)})],T=!0)},p(A,B){if(s=A,B&124){x=Ue(s[4]);let N;for(N=0;N<x.length;N+=1){const V=ns(s,x,N);E[N]?E[N].p(V,B):(E[N]=us(V),E[N].c(),E[N].m(b,_))}for(;N<E.length;N+=1)E[N].d(1);E.length=x.length}s[4].length===0?I||(I=fs(),I.c(),I.m(b,null)):I&&(I.d(1),I=null)},i(A){C||(A&&ft(()=>{C&&(t||(t=Ve(e,dt,{duration:200},!0)),t.run(1))}),A&&ft(()=>{C&&(M||(M=Ve(n,Lt,{y:300,duration:300},!0)),M.run(1))}),C=!0)},o(A){A&&(t||(t=Ve(e,dt,{duration:200},!1)),t.run(0)),A&&(M||(M=Ve(n,Lt,{y:300,duration:300},!1)),M.run(0)),C=!1},d(A){A&&(f(e),f(l),f(n)),A&&t&&t.end(),Cs(E,A),I&&I.d(),A&&M&&M.end(),T=!1,De(z)}}}function ea(s){let e,t="",l,n,a=s[21]+"",i,c,o,h="Locked";return{c(){e=w("span"),e.textContent=t,l=L(),n=w("span"),i=Q(a),c=L(),o=w("span"),o.textContent=h,this.h()},l(m){e=k(m,"SPAN",{class:!0,"data-svelte-h":!0}),W(e)!=="svelte-a7658i"&&(e.textContent=t),l=S(m),n=k(m,"SPAN",{class:!0});var v=y(n);i=J(v,a),v.forEach(f),c=S(m),o=k(m,"SPAN",{class:!0,"data-svelte-h":!0}),W(o)!=="svelte-ol6ij"&&(o.textContent=h),this.h()},h(){r(e,"class","text-xl"),r(n,"class","font-semibold text-base-content/50"),r(o,"class","badge badge-xs badge-ghost ml-auto")},m(m,v){D(m,e,v),D(m,l,v),D(m,n,v),u(n,i),D(m,c,v),D(m,o,v)},p(m,v){v&16&&a!==(a=m[21]+"")&&he(i,a)},d(m){m&&(f(e),f(l),f(n),f(c),f(o))}}}function ta(s){let e,t=s[18].icon+"",l,n,a,i=s[21]+"",c;return{c(){e=w("span"),l=Q(t),n=L(),a=w("span"),c=Q(i),this.h()},l(o){e=k(o,"SPAN",{class:!0,style:!0});var h=y(e);l=J(h,t),h.forEach(f),n=S(o),a=k(o,"SPAN",{class:!0});var m=y(a);c=J(m,i),m.forEach(f),this.h()},h(){r(e,"class","text-xl"),$e(e,"color",s[19]),r(a,"class","font-semibold")},m(o,h){D(o,e,h),u(e,l),D(o,n,h),D(o,a,h),u(a,c)},p(o,h){h&16&&t!==(t=o[18].icon+"")&&he(l,t),h&16&&$e(e,"color",o[19]),h&16&&i!==(i=o[21]+"")&&he(c,i)},d(o){o&&(f(e),f(n),f(a))}}}function is(s){let e,t=Ue(s[18].sections),l=[];for(let n=0;n<t.length;n+=1)l[n]=cs(rs(s,t,n));return{c(){e=w("ul");for(let n=0;n<l.length;n+=1)l[n].c();this.h()},l(n){e=k(n,"UL",{class:!0});var a=y(e);for(let i=0;i<l.length;i+=1)l[i].l(a);a.forEach(f),this.h()},h(){r(e,"class","ml-6 mt-1 space-y-1")},m(n,a){D(n,e,a);for(let i=0;i<l.length;i+=1)l[i]&&l[i].m(e,null)},p(n,a){if(a&92){t=Ue(n[18].sections);let i;for(i=0;i<t.length;i+=1){const c=rs(n,t,i);l[i]?l[i].p(c,a):(l[i]=cs(c),l[i].c(),l[i].m(e,null))}for(;i<l.length;i+=1)l[i].d(1);l.length=t.length}},d(n){n&&f(e),Cs(l,n)}}}function os(s){let e,t;return{c(){e=K("svg"),t=K("path"),this.h()},l(l){e=q(l,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var n=y(e);t=q(n,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),y(t).forEach(f),n.forEach(f),this.h()},h(){r(t,"stroke-linecap","round"),r(t,"stroke-linejoin","round"),r(t,"stroke-width","2"),r(t,"d","M5 13l4 4L19 7"),r(e,"xmlns","http://www.w3.org/2000/svg"),r(e,"class","h-4 w-4"),r(e,"fill","none"),r(e,"viewBox","0 0 24 24"),r(e,"stroke","currentColor")},m(l,n){D(l,e,n),u(e,t)},d(l){l&&f(e)}}}function cs(s){let e,t,l,n=s[25].icon+"",a,i,c,o=s[25].name+"",h,m,v,g,p,d,b=s[26]&&os();return{c(){e=w("li"),t=w("a"),l=w("span"),a=Q(n),i=L(),c=w("span"),h=Q(o),m=L(),b&&b.c(),this.h()},l(_){e=k(_,"LI",{});var M=y(e);t=k(M,"A",{href:!0,class:!0});var C=y(t);l=k(C,"SPAN",{class:!0});var T=y(l);a=J(T,n),T.forEach(f),i=S(C),c=k(C,"SPAN",{class:!0});var z=y(c);h=J(z,o),z.forEach(f),m=S(C),b&&b.l(C),C.forEach(f),M.forEach(f),this.h()},h(){r(l,"class","text-lg"),r(c,"class","flex-1"),r(t,"href",v=ne+"/"+s[18].id+"/"+s[25].id),r(t,"class",g="flex items-center gap-2 px-3 py-2.5 rounded-lg transition-colors "+(s[26]?"bg-primary/10 text-primary":""))},m(_,M){D(_,e,M),u(e,t),u(t,l),u(l,a),u(t,i),u(t,c),u(c,h),u(t,m),b&&b.m(t,null),p||(d=Z(t,"click",s[6]),p=!0)},p(_,M){M&16&&n!==(n=_[25].icon+"")&&he(a,n),M&16&&o!==(o=_[25].name+"")&&he(h,o),_[26]?b||(b=os(),b.c(),b.m(t,null)):b&&(b.d(1),b=null),M&16&&v!==(v=ne+"/"+_[18].id+"/"+_[25].id)&&r(t,"href",v),M&28&&g!==(g="flex items-center gap-2 px-3 py-2.5 rounded-lg transition-colors "+(_[26]?"bg-primary/10 text-primary":""))&&r(t,"class",g)},d(_){_&&f(e),b&&b.d(),p=!1,d()}}}function us(s){let e,t,l,n;function a(h,m){return h[20]?ta:ea}let i=a(s),c=i(s),o=s[20]&&is(s);return{c(){e=w("div"),t=w("div"),c.c(),n=L(),o&&o.c(),this.h()},l(h){e=k(h,"DIV",{class:!0});var m=y(e);t=k(m,"DIV",{class:!0,style:!0});var v=y(t);c.l(v),v.forEach(f),n=S(m),o&&o.l(m),m.forEach(f),this.h()},h(){r(t,"class","flex items-center gap-3 px-3 py-2 rounded-lg"),r(t,"style",l=s[22]&&s[20]?`border-left: 3px solid ${s[19]};`:""),se(t,"bg-base-200",s[22]&&s[20]),se(t,"opacity-50",!s[20]),r(e,"class","mb-3")},m(h,m){D(h,e,m),u(e,t),c.m(t,null),u(e,n),o&&o.m(e,null)},p(h,m){i===(i=a(h))&&c?c.p(h,m):(c.d(1),c=i(h),c&&(c.c(),c.m(t,null))),m&24&&l!==(l=h[22]&&h[20]?`border-left: 3px solid ${h[19]};`:"")&&r(t,"style",l),m&56&&se(t,"bg-base-200",h[22]&&h[20]),m&48&&se(t,"opacity-50",!h[20]),h[20]?o?o.p(h,m):(o=is(h),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},d(h){h&&f(e),c.d(),o&&o.d()}}}function fs(s){let e,t='<p>No zones available</p> <p class="text-sm mt-1">Contact admin for access</p>';return{c(){e=w("div"),e.innerHTML=t,this.h()},l(l){e=k(l,"DIV",{class:!0,"data-svelte-h":!0}),W(e)!=="svelte-shlctw"&&(e.innerHTML=t),this.h()},h(){r(e,"class","text-center py-8 text-base-content/50")},m(l,n){D(l,e,n)},d(l){l&&f(e)}}}function la(s){let e,t,l,n=s[0]&&as(s);return{c(){n&&n.c(),e=ke()},l(a){n&&n.l(a),e=ke()},m(a,i){n&&n.m(a,i),D(a,e,i),t||(l=Z(window,"keydown",s[8]),t=!0)},p(a,[i]){a[0]?n?(n.p(a,i),i&1&&te(n,1)):(n=as(a),n.c(),te(n,1),n.m(e.parentNode,e)):n&&(Ie(),ae(n,1,1,()=>{n=null}),Te())},i(a){te(n)},o(a){ae(n)},d(a){a&&f(e),n&&n.d(a),t=!1,l()}}}function sa(s){return s.branding?.primaryColor||s.ui?.color||"#6366f1"}function na(s,e,t){let l,n,a,i,c,o,h,m,v,g,p;ve(s,Dt,x=>t(11,v=x)),ve(s,tl,x=>t(12,g=x)),ve(s,zs,x=>t(13,p=x));let{isOpen:d=!1}=e,{onClose:b}=e;function _(x){if(a)return!0;if(!i)return!1;const E=x.access?.visibleToCohorts||[],I=x.access?.hiddenFromCohorts||[];if(E.length===0&&I.length===0)return!0;const A=n;return I.some(B=>A.includes(B))?!1:E.length===0?!0:E.some(B=>A.includes(B)||B==="cross-access")}function M(){b()}function C(){b()}function T(x){x.key==="Escape"&&b()}const z=x=>x.key==="Enter"&&C();return s.$$set=x=>{"isOpen"in x&&t(0,d=x.isOpen),"onClose"in x&&t(1,b=x.onClose)},s.$$.update=()=>{s.$$.dirty&12288&&(n=p?.cohorts??g.profile?.cohorts??[]),s.$$.dirty&12288&&(a=p?.isAdmin??g.profile?.isAdmin??!1),s.$$.dirty&12288&&(i=p?.isWhitelisted??g.profile?.isApproved??!1),s.$$.dirty&2048&&t(10,c=v?.url?.pathname??""),s.$$.dirty&1024&&t(9,o=c?c.replace(ne||"","").split("/").filter(Boolean):[]),s.$$.dirty&512&&t(3,h=o[0]||null),s.$$.dirty&512&&t(2,m=o[1]||null)},t(4,l=Ns()),[d,b,m,h,l,_,M,C,T,o,c,v,g,p,z]}class ra extends He{constructor(e){super(),Oe(this,e,na,la,Pe,{isOpen:0,onClose:1})}}const{document:Jt}=Is;function ds(s){let e,t,l,n,a,i,c,o,h,m,v,g="Install",p,d,b="Dismiss",_,M;return{c(){e=w("div"),t=K("svg"),l=K("path"),n=L(),a=w("span"),i=Q("Install "),c=Q(s[19]),o=Q(" app for offline access"),h=L(),m=w("div"),v=w("button"),v.textContent=g,p=L(),d=w("button"),d.textContent=b,this.h()},l(C){e=k(C,"DIV",{class:!0,role:!0,"aria-live":!0});var T=y(e);t=q(T,"svg",{xmlns:!0,fill:!0,viewBox:!0,class:!0,"aria-hidden":!0});var z=y(t);l=q(z,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),y(l).forEach(f),z.forEach(f),n=S(T),a=k(T,"SPAN",{});var x=y(a);i=J(x,"Install "),c=J(x,s[19]),o=J(x," app for offline access"),x.forEach(f),h=S(T),m=k(T,"DIV",{class:!0});var E=y(m);v=k(E,"BUTTON",{class:!0,"aria-label":!0,"data-svelte-h":!0}),W(v)!=="svelte-1ae1y8b"&&(v.textContent=g),p=S(E),d=k(E,"BUTTON",{class:!0,"aria-label":!0,"data-svelte-h":!0}),W(d)!=="svelte-1kwyjeb"&&(d.textContent=b),E.forEach(f),T.forEach(f),this.h()},h(){r(l,"stroke-linecap","round"),r(l,"stroke-linejoin","round"),r(l,"stroke-width","2"),r(l,"d","M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"),r(t,"xmlns","http://www.w3.org/2000/svg"),r(t,"fill","none"),r(t,"viewBox","0 0 24 24"),r(t,"class","stroke-current shrink-0 w-6 h-6"),r(t,"aria-hidden","true"),r(v,"class","btn btn-sm btn-primary"),r(v,"aria-label","Install application"),r(d,"class","btn btn-sm btn-ghost"),r(d,"aria-label","Dismiss install banner"),r(m,"class","flex gap-2"),r(e,"class","alert alert-info fixed top-0 left-0 right-0 z-50 rounded-none"),r(e,"role","banner"),r(e,"aria-live","polite")},m(C,T){D(C,e,T),u(e,t),u(t,l),u(e,n),u(e,a),u(a,i),u(a,c),u(a,o),u(e,h),u(e,m),u(m,v),u(m,p),u(m,d),_||(M=[Z(v,"click",s[23]),Z(d,"click",s[22])],_=!0)},p:pe,d(C){C&&f(e),_=!1,De(M)}}}function hs(s){let e,t,l,n,a,i="A new version is available",c,o,h="Update Now",m,v;return{c(){e=w("div"),t=K("svg"),l=K("path"),n=L(),a=w("span"),a.textContent=i,c=L(),o=w("button"),o.textContent=h,this.h()},l(g){e=k(g,"DIV",{class:!0,role:!0,"aria-live":!0});var p=y(e);t=q(p,"svg",{xmlns:!0,fill:!0,viewBox:!0,class:!0,"aria-hidden":!0});var d=y(t);l=q(d,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),y(l).forEach(f),d.forEach(f),n=S(p),a=k(p,"SPAN",{"data-svelte-h":!0}),W(a)!=="svelte-1sypjsy"&&(a.textContent=i),c=S(p),o=k(p,"BUTTON",{class:!0,"aria-label":!0,"data-svelte-h":!0}),W(o)!=="svelte-rjtxgf"&&(o.textContent=h),p.forEach(f),this.h()},h(){r(l,"stroke-linecap","round"),r(l,"stroke-linejoin","round"),r(l,"stroke-width","2"),r(l,"d","M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"),r(t,"xmlns","http://www.w3.org/2000/svg"),r(t,"fill","none"),r(t,"viewBox","0 0 24 24"),r(t,"class","stroke-current shrink-0 w-6 h-6"),r(t,"aria-hidden","true"),r(o,"class","btn btn-sm btn-warning"),r(o,"aria-label","Update application now"),r(e,"class","alert alert-warning fixed top-0 left-0 right-0 z-50 rounded-none"),r(e,"role","banner"),r(e,"aria-live","polite")},m(g,p){D(g,e,p),u(e,t),u(t,l),u(e,n),u(e,a),u(e,c),u(e,o),m||(v=Z(o,"click",s[24]),m=!0)},p:pe,d(g){g&&f(e),m=!1,v()}}}function ps(s){let e,t,l,n,a,i,c=s[16]>0&&ms(s);return{c(){e=w("div"),t=K("svg"),l=K("path"),n=L(),a=w("span"),i=Q(`You're offline. Messages will be queued.
			`),c&&c.c(),this.h()},l(o){e=k(o,"DIV",{class:!0,role:!0,"aria-live":!0});var h=y(e);t=q(h,"svg",{xmlns:!0,fill:!0,viewBox:!0,class:!0,"aria-hidden":!0});var m=y(t);l=q(m,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),y(l).forEach(f),m.forEach(f),n=S(h),a=k(h,"SPAN",{});var v=y(a);i=J(v,`You're offline. Messages will be queued.
			`),c&&c.l(v),v.forEach(f),h.forEach(f),this.h()},h(){r(l,"stroke-linecap","round"),r(l,"stroke-linejoin","round"),r(l,"stroke-width","2"),r(l,"d","M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"),r(t,"xmlns","http://www.w3.org/2000/svg"),r(t,"fill","none"),r(t,"viewBox","0 0 24 24"),r(t,"class","stroke-current shrink-0 w-6 h-6"),r(t,"aria-hidden","true"),r(e,"class","alert alert-error fixed bottom-0 left-0 right-0 z-50 rounded-none"),r(e,"role","status"),r(e,"aria-live","assertive")},m(o,h){D(o,e,h),u(e,t),u(t,l),u(e,n),u(e,a),u(a,i),c&&c.m(a,null)},p(o,h){o[16]>0?c?c.p(o,h):(c=ms(o),c.c(),c.m(a,null)):c&&(c.d(1),c=null)},d(o){o&&f(e),c&&c.d()}}}function ms(s){let e,t,l;return{c(){e=Q("("),t=Q(s[16]),l=Q(" queued)")},l(n){e=J(n,"("),t=J(n,s[16]),l=J(n," queued)")},m(n,a){D(n,e,a),D(n,t,a),D(n,l,a)},p(n,a){a[0]&65536&&he(t,n[16])},d(n){n&&(f(e),f(t),f(l))}}}function aa(s){let e,t='<div class="loading loading-spinner loading-lg text-primary"></div> <span class="sr-only">Loading application...</span>';return{c(){e=w("div"),e.innerHTML=t,this.h()},l(l){e=k(l,"DIV",{class:!0,role:!0,"aria-live":!0,"aria-label":!0,"data-svelte-h":!0}),W(e)!=="svelte-1p40hns"&&(e.innerHTML=t),this.h()},h(){r(e,"class","flex items-center justify-center min-h-screen"),r(e,"role","status"),r(e,"aria-live","polite"),r(e,"aria-label","Loading application")},m(l,n){D(l,e,n)},p:pe,i:pe,o:pe,d(l){l&&f(e)}}}function ia(s){let e,t,l,n=s[0],a,i,c,o,h=s[14]&&s[1]&&vs(s),m=s[14]&&s[1]&&!s[7]&&bs(s),v=_s(s),g=s[14]&&s[1]&&s[7]&&ks(s),p=s[14]&&s[1]&&s[7]&&ws(s);return{c(){h&&h.c(),e=L(),t=w("div"),m&&m.c(),l=L(),v.c(),a=L(),g&&g.c(),i=L(),p&&p.c(),c=ke(),this.h()},l(d){h&&h.l(d),e=S(d),t=k(d,"DIV",{class:!0});var b=y(t);m&&m.l(b),l=S(b),v.l(b),b.forEach(f),a=S(d),g&&g.l(d),i=S(d),p&&p.l(d),c=ke(),this.h()},h(){r(t,"class","flex")},m(d,b){h&&h.m(d,b),D(d,e,b),D(d,t,b),m&&m.m(t,null),u(t,l),v.m(t,null),D(d,a,b),g&&g.m(d,b),D(d,i,b),p&&p.m(d,b),D(d,c,b),o=!0},p(d,b){d[14]&&d[1]?h?(h.p(d,b),b[0]&16386&&te(h,1)):(h=vs(d),h.c(),te(h,1),h.m(e.parentNode,e)):h&&(Ie(),ae(h,1,1,()=>{h=null}),Te()),d[14]&&d[1]&&!d[7]?m?(m.p(d,b),b[0]&16514&&te(m,1)):(m=bs(d),m.c(),te(m,1),m.m(t,l)):m&&(Ie(),ae(m,1,1,()=>{m=null}),Te()),b[0]&1&&Pe(n,n=d[0])?(Ie(),ae(v,1,1,pe),Te(),v=_s(d),v.c(),te(v,1),v.m(t,null)):v.p(d,b),d[14]&&d[1]&&d[7]?g?(g.p(d,b),b[0]&16514&&te(g,1)):(g=ks(d),g.c(),te(g,1),g.m(i.parentNode,i)):g&&(Ie(),ae(g,1,1,()=>{g=null}),Te()),d[14]&&d[1]&&d[7]?p?(p.p(d,b),b[0]&16514&&te(p,1)):(p=ws(d),p.c(),te(p,1),p.m(c.parentNode,c)):p&&(Ie(),ae(p,1,1,()=>{p=null}),Te())},i(d){o||(te(h),te(m),te(v),te(g),te(p),o=!0)},o(d){ae(h),ae(m),ae(v),ae(g),ae(p),o=!1},d(d){d&&(f(e),f(t),f(a),f(i),f(c)),h&&h.d(d),m&&m.d(),v.d(d),g&&g.d(d),p&&p.d(d)}}}function vs(s){let e,t;return e=new ar({props:{themePreference:s[3],onThemeToggle:s[20],onProfileClick:s[21]}}),{c(){Ne(e.$$.fragment)},l(l){Le(e.$$.fragment,l)},m(l,n){Se(e,l,n),t=!0},p(l,n){const a={};n[0]&8&&(a.themePreference=l[3]),e.$set(a)},i(l){t||(te(e.$$.fragment,l),t=!0)},o(l){ae(e.$$.fragment,l),t=!1},d(l){Be(e,l)}}}function bs(s){let e,t,l,n;t=new Jr({props:{currentCategoryId:s[13],currentSectionId:s[12],collapsed:s[9],onToggle:s[31]}});let a=s[17]&&gs(s);return{c(){e=w("aside"),Ne(t.$$.fragment),l=L(),a&&a.c(),this.h()},l(i){e=k(i,"ASIDE",{class:!0,style:!0,"aria-label":!0});var c=y(e);Le(t.$$.fragment,c),l=S(c),a&&a.l(c),c.forEach(f),this.h()},h(){r(e,"class","flex-shrink-0 flex flex-col border-r border-base-300 bg-base-100 overflow-y-auto"),$e(e,"max-height","calc(100vh - 64px)"),$e(e,"transition","width 0.3s ease-in-out"),r(e,"aria-label","Navigation sidebar"),se(e,"w-72",!s[9]||!s[10]),se(e,"w-16",s[9]&&s[10])},m(i,c){D(i,e,c),Se(t,e,null),u(e,l),a&&a.m(e,null),n=!0},p(i,c){const o={};c[0]&8192&&(o.currentCategoryId=i[13]),c[0]&4096&&(o.currentSectionId=i[12]),c[0]&512&&(o.collapsed=i[9]),c[0]&512&&(o.onToggle=i[31]),t.$set(o),i[17]?a?(a.p(i,c),c[0]&131072&&te(a,1)):(a=gs(i),a.c(),te(a,1),a.m(e,null)):a&&(Ie(),ae(a,1,1,()=>{a=null}),Te()),(!n||c[0]&1536)&&se(e,"w-72",!i[9]||!i[10]),(!n||c[0]&1536)&&se(e,"w-16",i[9]&&i[10])},i(i){n||(te(t.$$.fragment,i),te(a),n=!0)},o(i){ae(t.$$.fragment,i),ae(a),n=!1},d(i){i&&f(e),Be(t),a&&a.d()}}}function gs(s){let e,t,l;return t=new mn({props:{isExpanded:!s[10],isVisible:s[17],onToggle:s[32],compact:!0}}),{c(){e=w("div"),Ne(t.$$.fragment),this.h()},l(n){e=k(n,"DIV",{class:!0});var a=y(e);Le(t.$$.fragment,a),a.forEach(f),this.h()},h(){r(e,"class","border-t border-base-300")},m(n,a){D(n,e,a),Se(t,e,null),l=!0},p(n,a){const i={};a[0]&1024&&(i.isExpanded=!n[10]),a[0]&131072&&(i.isVisible=n[17]),a[0]&1024&&(i.onToggle=n[32]),t.$set(i)},i(n){l||(te(t.$$.fragment,n),l=!0)},o(n){ae(t.$$.fragment,n),l=!1},d(n){n&&f(e),Be(t)}}}function _s(s){let e,t,l,n,a;const i=s[29].default,c=qs(i,s,s[28],null);return{c(){e=w("main"),c&&c.c(),this.h()},l(o){e=k(o,"MAIN",{id:!0,role:!0,tabindex:!0,class:!0});var h=y(e);c&&c.l(h),h.forEach(f),this.h()},h(){r(e,"id","main-content"),r(e,"role","main"),r(e,"tabindex","-1"),r(e,"class",t="flex-1 min-w-0 "+(s[7]&&s[14]&&s[1]?"pb-20":""))},m(o,h){D(o,e,h),c&&c.m(e,null),a=!0},p(o,h){c&&c.p&&(!a||h[0]&268435456)&&Ks(c,i,o,o[28],a?Gs(i,o[28],h,null):Zs(o[28]),null),(!a||h[0]&16514&&t!==(t="flex-1 min-w-0 "+(o[7]&&o[14]&&o[1]?"pb-20":"")))&&r(e,"class",t)},i(o){a||(te(c,o),o&&ft(()=>{a&&(n&&n.end(1),l=en(e,dt,{duration:150,delay:75}),l.start())}),a=!0)},o(o){ae(c,o),l&&l.invalidate(),o&&(n=$s(e,dt,{duration:75})),a=!1},d(o){o&&f(e),c&&c.d(o),o&&n&&n.end()}}}function ks(s){let e,t,l;function n(i){s[33](i)}let a={};return s[8]!==void 0&&(a.isOpen=s[8]),e=new pn({props:a}),Xt.push(()=>Ms(e,"isOpen",n)),{c(){Ne(e.$$.fragment)},l(i){Le(e.$$.fragment,i)},m(i,c){Se(e,i,c),l=!0},p(i,c){const o={};!t&&c[0]&256&&(t=!0,o.isOpen=i[8],Es(()=>t=!1)),e.$set(o)},i(i){l||(te(e.$$.fragment,i),l=!0)},o(i){ae(e.$$.fragment,i),l=!1},d(i){Be(e,i)}}}function ws(s){let e,t,l,n;return e=new $r({props:{onZonesClick:s[34],onProfileClick:s[21]}}),l=new ra({props:{isOpen:s[11],onClose:s[35]}}),{c(){Ne(e.$$.fragment),t=L(),Ne(l.$$.fragment)},l(a){Le(e.$$.fragment,a),t=S(a),Le(l.$$.fragment,a)},m(a,i){Se(e,a,i),D(a,t,i),Se(l,a,i),n=!0},p(a,i){const c={};i[0]&2048&&(c.onZonesClick=a[34]),e.$set(c);const o={};i[0]&2048&&(o.isOpen=a[11]),i[0]&2048&&(o.onClose=a[35]),l.$set(o)},i(a){n||(te(e.$$.fragment,a),te(l.$$.fragment,a),n=!0)},o(a){ae(e.$$.fragment,a),ae(l.$$.fragment,a),n=!1},d(a){a&&f(t),Be(e,a),Be(l,a)}}}function oa(s){let e,t,l,n="Skip to main content",a,i,c,o,h,m,v,g,p,d,b,_,M,C,T,z,x;Jt.title=e=s[18].name;let E=s[4]&&ds(s),I=s[5]&&hs(s),A=!s[15]&&ps(s);function B(P){s[30](P)}let N={};s[6]!==void 0&&(N.open=s[6]),h=new Vr({props:N}),Xt.push(()=>Ms(h,"open",B));const V=[ia,aa],j=[];function H(P,U){return P[2]?0:1}return p=H(s),d=j[p]=V[p](s),_=new Zn({}),C=new Xn({}),z=new tr({}),{c(){t=L(),l=w("a"),l.textContent=n,a=L(),E&&E.c(),i=L(),I&&I.c(),c=L(),A&&A.c(),o=L(),Ne(h.$$.fragment),v=L(),g=w("div"),d.c(),b=L(),Ne(_.$$.fragment),M=L(),Ne(C.$$.fragment),T=L(),Ne(z.$$.fragment),this.h()},l(P){Ws("svelte-vevsda",Jt.head).forEach(f),t=S(P),l=k(P,"A",{href:!0,class:!0,"data-svelte-h":!0}),W(l)!=="svelte-1i6h3li"&&(l.textContent=n),a=S(P),E&&E.l(P),i=S(P),I&&I.l(P),c=S(P),A&&A.l(P),o=S(P),Le(h.$$.fragment,P),v=S(P),g=k(P,"DIV",{class:!0});var R=y(g);d.l(R),R.forEach(f),b=S(P),Le(_.$$.fragment,P),M=S(P),Le(C.$$.fragment,P),T=S(P),Le(z.$$.fragment,P),this.h()},h(){r(l,"href","#main-content"),r(l,"class","skip-to-main svelte-cou32b"),r(g,"class","min-h-screen w-full transition-base")},m(P,U){D(P,t,U),D(P,l,U),D(P,a,U),E&&E.m(P,U),D(P,i,U),I&&I.m(P,U),D(P,c,U),A&&A.m(P,U),D(P,o,U),Se(h,P,U),D(P,v,U),D(P,g,U),j[p].m(g,null),D(P,b,U),Se(_,P,U),D(P,M,U),Se(C,P,U),D(P,T,U),Se(z,P,U),x=!0},p(P,U){(!x||U[0]&262144)&&e!==(e=P[18].name)&&(Jt.title=e),P[4]?E?E.p(P,U):(E=ds(P),E.c(),E.m(i.parentNode,i)):E&&(E.d(1),E=null),P[5]?I?I.p(P,U):(I=hs(P),I.c(),I.m(c.parentNode,c)):I&&(I.d(1),I=null),P[15]?A&&(A.d(1),A=null):A?A.p(P,U):(A=ps(P),A.c(),A.m(o.parentNode,o));const R={};!m&&U[0]&64&&(m=!0,R.open=P[6],Es(()=>m=!1)),h.$set(R);let le=p;p=H(P),p===le?j[p].p(P,U):(Ie(),ae(j[le],1,1,()=>{j[le]=null}),Te(),d=j[p],d?d.p(P,U):(d=j[p]=V[p](P),d.c()),te(d,1),d.m(g,null))},i(P){x||(te(h.$$.fragment,P),te(d),te(_.$$.fragment,P),te(C.$$.fragment,P),te(z.$$.fragment,P),x=!0)},o(P){ae(h.$$.fragment,P),ae(d),ae(_.$$.fragment,P),ae(C.$$.fragment,P),ae(z.$$.fragment,P),x=!1},d(P){P&&(f(t),f(l),f(a),f(i),f(c),f(o),f(v),f(g),f(b),f(M),f(T)),E&&E.d(P),I&&I.d(P),A&&A.d(P),Be(h,P),j[p].d(),Be(_,P),Be(C,P),Be(z,P)}}}function ca(s,e,t){let l,n,a,i,c,o,h,m,v,g;ve(s,Dt,F=>t(27,o=F)),ve(s,fn,F=>t(1,h=F)),ve(s,As,F=>t(15,m=F)),ve(s,dn,F=>t(16,v=F)),ve(s,vn,F=>t(17,g=F));let{$$slots:p={},$$scope:d}=e;const b=el(),_=b.name.split(" - ")[0];let M=!1,C="dark",T=!1,z=!1,x=!1,E,I=window.innerWidth<768,A=!1,B=!1,N=!0,V=!1;Ss.subscribe(F=>{t(4,T=F)}),cn.subscribe(F=>{t(5,z=F)}),Qt(()=>{t(2,M=!0);try{const G=sessionStorage.getItem("redirect");if(G&&typeof G=="string"){sessionStorage.removeItem("redirect");const be=ne||"/community",ge=o?.url?.pathname??"";if(G.startsWith(be)&&G!==ge){const oe=G.slice(be.length)||"/";tn(`${ne}${oe}`,{replaceState:!0})}}}catch(G){console.warn("SPA redirect handling failed:",G)}const F=localStorage.getItem("theme");t(3,C=F==="light"?"light":"dark"),document.documentElement.setAttribute("data-theme",C),Sn(),jn(),"Notification"in window&&Notification.permission==="default"&&Ps.requestPermission(),Rn();const X=()=>{t(7,I=window.innerWidth<768)};return X(),window.addEventListener("resize",X),hn.fetchUpcomingEvents(14),()=>{window.removeEventListener("resize",X)}}),ys(()=>{E&&(E(),t(25,E=void 0))});function j(){t(3,C=C==="dark"?"light":"dark"),document.documentElement.setAttribute("data-theme",C),localStorage.setItem("theme",C)}function H(){t(6,x=!x)}function P(){t(4,T=!1)}async function U(){await Ls()&&t(4,T=!1)}async function R(){await un()}function le(F){x=F,t(6,x)}const re=()=>t(9,B=!B),O=()=>t(10,N=!N);function ie(F){A=F,t(8,A)}const ce=()=>t(11,V=!0),$=()=>t(11,V=!1);return s.$$set=F=>{"$$scope"in F&&t(28,d=F.$$scope)},s.$$.update=()=>{s.$$.dirty[0]&134217728&&t(0,l=o?.url?.pathname??""),s.$$.dirty[0]&1&&t(14,n=l!==`${ne}/`&&l!==ne&&l!==`${ne}/signup`&&l!==`${ne}/login`&&l!==`${ne}/pending`&&l!==""),s.$$.dirty[0]&1&&t(26,a=l?l.replace(ne||"","").split("/").filter(Boolean):[]),s.$$.dirty[0]&67108864&&t(13,i=a[0]||null),s.$$.dirty[0]&67108864&&t(12,c=a[1]||null),s.$$.dirty[0]&33554434&&(h&&!E?t(25,E=Nt.start(()=>{ht.logout()})):!h&&E&&(E(),t(25,E=void 0),Nt.stop()))},[l,h,M,C,T,z,x,I,A,B,N,V,c,i,n,m,v,g,b,_,j,H,P,U,R,E,a,o,d,p,le,re,O,ie,ce,$]}class La extends He{constructor(e){super(),Oe(this,e,ca,oa,Pe,{},null,[-1,-1])}}export{La as component,Sa as universal};
