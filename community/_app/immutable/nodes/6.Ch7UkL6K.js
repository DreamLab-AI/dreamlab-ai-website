import{s as we,d as u,i as A,l as c,m as ye,g as H,c as v,e as k,j,h as b,k as X,p as Ee,n as G,o as K,a as J,b as f,f as z,t as R,u as $,v as ee,w as ne}from"../chunks/0ZVSoAEn.js";import{S as Ce,i as Ie,t as te,a as re,c as Ve,d as ie,m as ce,b as ue,e as fe,g as De}from"../chunks/DKVmOqaf.js";import{e as de,u as Me,d as Se}from"../chunks/m0NROLOn.js";import{g as Be}from"../chunks/CTVLmyHZ.js";import{b as O}from"../chunks/xKPZ-4ZK.js";import{p as He}from"../chunks/BdMR7A5I.js";import{g as je,a as he,b as Ae,c as Fe,e as Pe,n as Te}from"../chunks/DxD0Wn3l.js";import{u as Le,p as Ne,w as xe}from"../chunks/Cufo8aq4.js";import{c as ze,a as me}from"../chunks/D31DSQKd.js";import{B as Re}from"../chunks/eGtfPii9.js";import"../chunks/CVI4yqfx.js";import"../chunks/D7m-JnSU.js";import{Z as qe}from"../chunks/DE_mfnh5.js";function _e(n,e,t){const r=n.slice();return r[18]=e[t],r}function Ue(n){let e,t,r,s,o,a,l,i,h=n[3].icon+"",d,w,_,I,F=n[3].name+"",T,P,V,E=n[3].description+"",y,g,m,x,D,M,Z,N;e=new Re({props:{items:n[8]}}),s=new qe({props:{category:n[2],compact:!0}});let S=n[3].calendar?.access!=="none"&&pe(n),B=n[7]&&ve();function se(p,C){return p[6].length===0?Je:Ge}let W=se(n),L=W(n);return{c(){fe(e.$$.fragment),t=j(),r=b("div"),fe(s.$$.fragment),o=j(),a=b("div"),l=b("div"),i=b("div"),d=R(h),w=j(),_=b("div"),I=b("h2"),T=R(F),P=j(),V=b("p"),y=R(E),g=j(),m=b("div"),S&&S.c(),x=j(),B&&B.c(),D=j(),M=b("div"),Z=j(),L.c(),this.h()},l(p){ue(e.$$.fragment,p),t=H(p),r=v(p,"DIV",{class:!0});var C=k(r);ue(s.$$.fragment,C),o=H(C),a=v(C,"DIV",{class:!0});var q=k(a);l=v(q,"DIV",{class:!0});var U=k(l);i=v(U,"DIV",{class:!0});var ae=k(i);d=z(ae,h),ae.forEach(u),w=H(U),_=v(U,"DIV",{});var Y=k(_);I=v(Y,"H2",{class:!0});var le=k(I);T=z(le,F),le.forEach(u),P=H(Y),V=v(Y,"P",{class:!0});var oe=k(V);y=z(oe,E),oe.forEach(u),Y.forEach(u),U.forEach(u),g=H(q),m=v(q,"DIV",{class:!0});var Q=k(m);S&&S.l(Q),x=H(Q),B&&B.l(Q),Q.forEach(u),q.forEach(u),D=H(C),M=v(C,"DIV",{class:!0}),k(M).forEach(u),Z=H(C),L.l(C),C.forEach(u),this.h()},h(){c(i,"class","text-4xl"),c(I,"class","text-2xl font-bold"),c(V,"class","text-base-content/70 mt-1"),c(l,"class","flex items-center gap-4"),c(m,"class","flex gap-2"),c(a,"class","flex items-start justify-between gap-4 mb-6"),c(M,"class","divider"),c(r,"class","mt-6")},m(p,C){ce(e,p,C),A(p,t,C),A(p,r,C),ce(s,r,null),f(r,o),f(r,a),f(a,l),f(l,i),f(i,d),f(l,w),f(l,_),f(_,I),f(I,T),f(_,P),f(_,V),f(V,y),f(a,g),f(a,m),S&&S.m(m,null),f(m,x),B&&B.m(m,null),f(r,D),f(r,M),f(r,Z),L.m(r,null),N=!0},p(p,C){const q={};C&256&&(q.items=p[8]),e.$set(q);const U={};C&4&&(U.category=p[2]),s.$set(U),(!N||C&8)&&h!==(h=p[3].icon+"")&&J(d,h),(!N||C&8)&&F!==(F=p[3].name+"")&&J(T,F),(!N||C&8)&&E!==(E=p[3].description+"")&&J(y,E),p[3].calendar?.access!=="none"?S?S.p(p,C):(S=pe(p),S.c(),S.m(m,x)):S&&(S.d(1),S=null),p[7]?B||(B=ve(),B.c(),B.m(m,null)):B&&(B.d(1),B=null),W===(W=se(p))&&L?L.p(p,C):(L.d(1),L=W(p),L&&(L.c(),L.m(r,null)))},i(p){N||(re(e.$$.fragment,p),re(s.$$.fragment,p),N=!0)},o(p){te(e.$$.fragment,p),te(s.$$.fragment,p),N=!1},d(p){p&&(u(t),u(r)),ie(e,p),ie(s),S&&S.d(),B&&B.d(),L.d()}}}function Oe(n){let e,t,r,s,o,a,l;return{c(){e=b("div"),t=b("span"),r=R(n[5]),s=j(),o=b("a"),a=R("Back to Category"),this.h()},l(i){e=v(i,"DIV",{class:!0});var h=k(e);t=v(h,"SPAN",{});var d=k(t);r=z(d,n[5]),d.forEach(u),s=H(h),o=v(h,"A",{href:!0,class:!0});var w=k(o);a=z(w,"Back to Category"),w.forEach(u),h.forEach(u),this.h()},h(){c(o,"href",l=O+"/"+n[1]),c(o,"class","btn btn-sm btn-ghost"),c(e,"class","alert alert-error")},m(i,h){A(i,e,h),f(e,t),f(t,r),f(e,s),f(e,o),f(o,a)},p(i,h){h&32&&J(r,i[5]),h&2&&l!==(l=O+"/"+i[1])&&c(o,"href",l)},i:G,o:G,d(i){i&&u(e)}}}function Ze(n){let e,t='<span class="loading loading-spinner loading-lg text-primary"></span>';return{c(){e=b("div"),e.innerHTML=t,this.h()},l(r){e=v(r,"DIV",{class:!0,"data-svelte-h":!0}),K(e)!=="svelte-f5e84o"&&(e.innerHTML=t),this.h()},h(){c(e,"class","flex justify-center items-center min-h-[400px]")},m(r,s){A(r,e,s)},p:G,i:G,o:G,d(r){r&&u(e)}}}function pe(n){let e,t,r,s,o;return{c(){e=b("a"),t=ee("svg"),r=ee("path"),s=R(`
              Calendar`),this.h()},l(a){e=v(a,"A",{href:!0,class:!0});var l=k(e);t=$(l,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var i=k(t);r=$(i,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),k(r).forEach(u),i.forEach(u),s=z(l,`
              Calendar`),l.forEach(u),this.h()},h(){c(r,"stroke-linecap","round"),c(r,"stroke-linejoin","round"),c(r,"stroke-width","2"),c(r,"d","M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"),c(t,"xmlns","http://www.w3.org/2000/svg"),c(t,"class","h-5 w-5"),c(t,"fill","none"),c(t,"viewBox","0 0 24 24"),c(t,"stroke","currentColor"),c(e,"href",o=O+"/"+n[1]+"/"+n[0]+"/calendar"),c(e,"class","btn btn-outline btn-secondary")},m(a,l){A(a,e,l),f(e,t),f(t,r),f(e,s)},p(a,l){l&3&&o!==(o=O+"/"+a[1]+"/"+a[0]+"/calendar")&&c(e,"href",o)},d(a){a&&u(e)}}}function ve(n){let e,t=`<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg>
              New Forum`;return{c(){e=b("button"),e.innerHTML=t,this.h()},l(r){e=v(r,"BUTTON",{class:!0,"data-svelte-h":!0}),K(e)!=="svelte-11mb7s2"&&(e.innerHTML=t),this.h()},h(){c(e,"class","btn btn-primary")},m(r,s){A(r,e,s)},d(r){r&&u(e)}}}function Ge(n){let e,t=[],r=new Map,s=de(n[6]);const o=a=>a[18].id;for(let a=0;a<s.length;a+=1){let l=_e(n,s,a),i=o(l);r.set(i,t[a]=ge(i,l))}return{c(){e=b("div");for(let a=0;a<t.length;a+=1)t[a].c();this.h()},l(a){e=v(a,"DIV",{class:!0});var l=k(e);for(let i=0;i<t.length;i+=1)t[i].l(l);l.forEach(u),this.h()},h(){c(e,"class","space-y-3")},m(a,l){A(a,e,l);for(let i=0;i<t.length;i+=1)t[i]&&t[i].m(e,null)},p(a,l){l&67&&(s=de(a[6]),t=Me(t,l,o,1,a,s,r,e,Se,ge,null,_e))},d(a){a&&u(e);for(let l=0;l<t.length;l+=1)t[l].d()}}}function Je(n){let e,t,r,s="No forums in this section yet.",o,a=n[7]&&ke();return{c(){e=b("div"),t=b("div"),r=b("p"),r.textContent=s,o=j(),a&&a.c(),this.h()},l(l){e=v(l,"DIV",{class:!0});var i=k(e);t=v(i,"DIV",{class:!0});var h=k(t);r=v(h,"P",{class:!0,"data-svelte-h":!0}),K(r)!=="svelte-vugkgx"&&(r.textContent=s),o=H(h),a&&a.l(h),h.forEach(u),i.forEach(u),this.h()},h(){c(r,"class","text-base-content/70"),c(t,"class","card-body text-center"),c(e,"class","card bg-base-200")},m(l,i){A(l,e,i),f(e,t),f(t,r),f(t,o),a&&a.m(t,null)},p(l,i){l[7]?a||(a=ke(),a.c(),a.m(t,null)):a&&(a.d(1),a=null)},d(l){l&&u(e),a&&a.d()}}}function Ke(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8h2a2 2 0 012 2v6a2 2 0 01-2 2h-2v4l-4-4H9a1.994 1.994 0 01-1.414-.586m0 0L11 14h4a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2v4l.586-.586z"></path></svg>';return{c(){e=b("div"),e.innerHTML=t,this.h()},l(r){e=v(r,"DIV",{class:!0,"data-svelte-h":!0}),K(e)!=="svelte-1rijk9n"&&(e.innerHTML=t),this.h()},h(){c(e,"class","w-12 h-12 rounded-lg bg-primary/10 flex items-center justify-center")},m(r,s){A(r,e,s)},p:G,d(r){r&&u(e)}}}function We(n){let e,t;return{c(){e=b("img"),this.h()},l(r){e=v(r,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){ne(e.src,t=n[18].picture)||c(e,"src",t),c(e,"alt",""),c(e,"class","w-12 h-12 rounded-lg object-cover")},m(r,s){A(r,e,s)},p(r,s){s&64&&!ne(e.src,t=r[18].picture)&&c(e,"src",t)},d(r){r&&u(e)}}}function be(n){let e,t=n[18].about+"",r;return{c(){e=b("p"),r=R(t),this.h()},l(s){e=v(s,"P",{class:!0});var o=k(e);r=z(o,t),o.forEach(u),this.h()},h(){c(e,"class","text-sm text-base-content/70 line-clamp-1")},m(s,o){A(s,e,o),f(e,r)},p(s,o){o&64&&t!==(t=s[18].about+"")&&J(r,t)},d(s){s&&u(e)}}}function ge(n,e){let t,r,s,o,a,l,i=e[18].name+"",h,d,w,_,I,F,T;function P(g,m){return g[18].picture?We:Ke}let V=P(e),E=V(e),y=e[18].about&&be(e);return{key:n,first:null,c(){t=b("a"),r=b("div"),s=b("div"),E.c(),o=j(),a=b("div"),l=b("h3"),h=R(i),d=j(),y&&y.c(),w=j(),_=ee("svg"),I=ee("path"),F=j(),this.h()},l(g){t=v(g,"A",{href:!0,class:!0});var m=k(t);r=v(m,"DIV",{class:!0});var x=k(r);s=v(x,"DIV",{class:!0});var D=k(s);E.l(D),o=H(D),a=v(D,"DIV",{class:!0});var M=k(a);l=v(M,"H3",{class:!0});var Z=k(l);h=z(Z,i),Z.forEach(u),d=H(M),y&&y.l(M),M.forEach(u),w=H(D),_=$(D,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var N=k(_);I=$(N,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),k(I).forEach(u),N.forEach(u),D.forEach(u),x.forEach(u),F=H(m),m.forEach(u),this.h()},h(){c(l,"class","font-bold"),c(a,"class","flex-1"),c(I,"stroke-linecap","round"),c(I,"stroke-linejoin","round"),c(I,"stroke-width","2"),c(I,"d","M9 5l7 7-7 7"),c(_,"xmlns","http://www.w3.org/2000/svg"),c(_,"class","h-5 w-5 text-base-content/40"),c(_,"fill","none"),c(_,"viewBox","0 0 24 24"),c(_,"stroke","currentColor"),c(s,"class","flex items-center gap-3"),c(r,"class","card-body p-4"),c(t,"href",T=O+"/"+e[1]+"/"+e[0]+"/"+e[18].id),c(t,"class","card bg-base-100 shadow hover:shadow-md transition-shadow cursor-pointer block"),this.first=t},m(g,m){A(g,t,m),f(t,r),f(r,s),E.m(s,null),f(s,o),f(s,a),f(a,l),f(l,h),f(a,d),y&&y.m(a,null),f(s,w),f(s,_),f(_,I),f(t,F)},p(g,m){e=g,V===(V=P(e))&&E?E.p(e,m):(E.d(1),E=V(e),E&&(E.c(),E.m(s,o))),m&64&&i!==(i=e[18].name+"")&&J(h,i),e[18].about?y?y.p(e,m):(y=be(e),y.c(),y.m(a,null)):y&&(y.d(1),y=null),m&67&&T!==(T=O+"/"+e[1]+"/"+e[0]+"/"+e[18].id)&&c(t,"href",T)},d(g){g&&u(t),E.d(),y&&y.d()}}}function ke(n){let e,t="Be the first to create one!";return{c(){e=b("p"),e.textContent=t,this.h()},l(r){e=v(r,"P",{class:!0,"data-svelte-h":!0}),K(e)!=="svelte-1omq2dy"&&(e.textContent=t),this.h()},h(){c(e,"class","text-sm text-base-content/50 mt-2")},m(r,s){A(r,e,s)},d(r){r&&u(e)}}}function Ye(n){let e,t,r,s,o,a;document.title=e=(n[3]?.name??"Section")+" - "+n[9].name;const l=[Ze,Oe,Ue],i=[];function h(d,w){return d[4]?0:d[5]?1:d[3]&&d[2]?2:-1}return~(s=h(n))&&(o=i[s]=l[s](n)),{c(){t=j(),r=b("div"),o&&o.c(),this.h()},l(d){ye("svelte-n92ddi",document.head).forEach(u),t=H(d),r=v(d,"DIV",{class:!0});var _=k(r);o&&o.l(_),_.forEach(u),this.h()},h(){c(r,"class","container mx-auto p-4 max-w-6xl")},m(d,w){A(d,t,w),A(d,r,w),~s&&i[s].m(r,null),a=!0},p(d,[w]){(!a||w&520)&&e!==(e=(d[3]?.name??"Section")+" - "+d[9].name)&&(document.title=e);let _=s;s=h(d),s===_?~s&&i[s].p(d,w):(o&&(De(),te(i[_],1,1,()=>{i[_]=null}),Ve()),~s?(o=i[s],o?o.p(d,w):(o=i[s]=l[s](d),o.c()),re(o,1),o.m(r,null)):o=null)},i(d){a||(re(o),a=!0)},o(d){te(o),a=!1},d(d){d&&(u(t),u(r)),~s&&i[s].d()}}}function Qe(n,e,t){let r,s,o,a,l,i,h,d,w,_,I,F;X(n,he,g=>t(16,w=g)),X(n,Le,g=>t(12,_=g)),X(n,Ne,g=>t(13,I=g)),X(n,He,g=>t(14,F=g));const T=je();let P=!0,V=null,E=[];async function y(){const g=Te();if(g)try{const m={kinds:[40],"#section":[s],limit:50},x=await g.fetchEvents(m);t(6,E=Array.from(x).map(D=>{let M={name:"Unnamed Forum",about:"",picture:""};try{M=JSON.parse(D.content)}catch{}return{id:D.id,name:M.name||"Unnamed Forum",about:M.about||"",picture:M.picture,createdAt:D.created_at??0,pubkey:D.pubkey}})),E.sort((D,M)=>M.createdAt-D.createdAt)}catch(m){console.error("Failed to load forums:",m),t(5,V=m instanceof Error?m.message:"Failed to load forums")}}return Ee(async()=>{if(await he.waitForReady(),!w.isAuthenticated||!w.publicKey){Be(`${O}/`);return}if(!a||!l){t(5,V=`Section "${s}" not found`),t(4,P=!1);return}if(l.id!==r){t(5,V=`Section "${s}" is not in category "${r}"`),t(4,P=!1);return}const g=await xe();if(g&&!me(g,s)){t(5,V="You do not have access to this section"),t(4,P=!1);return}try{await Pe(w),await y()}catch(m){console.error("Failed to connect:",m),t(5,V=m instanceof Error?m.message:"Connection failed")}finally{t(4,P=!1)}}),n.$$.update=()=>{n.$$.dirty&16384&&t(1,r=F.params.category),n.$$.dirty&16384&&t(0,s=F.params.section),n.$$.dirty&1&&t(11,o=Ae(s)),n.$$.dirty&2048&&t(3,a=o?.section),n.$$.dirty&2048&&t(2,l=o?.category),n.$$.dirty&15&&t(8,i=a&&l?Fe(r,s):[]),n.$$.dirty&4096&&t(10,h=_),n.$$.dirty&9217&&I&&h&&me(h,s),n.$$.dirty&12289&&t(7,d=I&&_?ze(_,s):!1)},[s,r,l,a,P,V,E,d,i,T,h,o,_,I,F]}class ft extends Ce{constructor(e){super(),Ie(this,e,Qe,Ye,we,{})}}export{ft as component};
