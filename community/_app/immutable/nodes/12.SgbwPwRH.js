import{s as ns,d as r,r as os,i as le,b as e,q as Fe,l,m as vs,g as m,c as n,e as d,o as Z,u as Te,f as k,j as b,h as v,v as Se,t as E,k as cs,p as ds,n as qe,a as W,z as us,A as je,w as Qt}from"../chunks/0ZVSoAEn.js";import{S as hs,i as fs,t as Qe,a as Ge,c as rs,g as is,d as ps,m as _s,b as ms,e as bs}from"../chunks/DKVmOqaf.js";import{g as gs}from"../chunks/D0QH3NT1.js";import{e as Xt}from"../chunks/m0NROLOn.js";import{g as At}from"../chunks/CTVLmyHZ.js";import{b as Ht}from"../chunks/xKPZ-4ZK.js";import{a as Yt}from"../chunks/DxD0Wn3l.js";import"../chunks/DFQe3-5X.js";import{c as zs,A as Cs}from"../chunks/CH2AtOeB.js";import{verifyWhitelistStatus as ks}from"../chunks/BPZifr_e.js";const{document:Zt}=gs;function $t(o,t,s){const a=o.slice();return a[16]=t[s],a}function Es(o){let t,s,a,i,c='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>',T,u,p,h=ce(o[0].totalChannels)+"",g,U,_,w="Total Channels",z,D,R=o[0].activeChannels+"",J,j,C,V,A,I='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg>',M,S,H,ae=ce(o[0].totalMessages)+"",oe,F,ee,B="Total Messages",G,P,O=ce(o[9]())+"",y,de,re,$,x,Ke='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg>',Le,te,fe,pe=ce(o[0].totalUsers)+"",ze,at,Ce,Bt="Total Users",ot,ke,Nt=o[10]().toFixed(1)+"",rt,it,nt,me,Ee,Ut='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 20V10"></path><path d="M12 20V4"></path><path d="M6 20v-6"></path></svg>',vt,ue,De,We=(o[0].totalChannels===0?"0":(o[0].activeChannels/o[0].totalChannels*100).toFixed(0))+"",Xe,ct,dt,ye,Ot="Engagement Rate",ut,Ve,Rt="Based on 7-day activity",ht,be,ge,Ie,jt="Channel Comparison",ft,he,ie,pt,_t,ne,mt,bt,ve,gt,zt,_e,Me,Ft='<div class="col-channel svelte-1lvz8ob">Channel</div> <div class="col-stat svelte-1lvz8ob">Messages</div> <div class="col-stat svelte-1lvz8ob">Members</div> <div class="col-stat svelte-1lvz8ob">Avg/Day</div> <div class="col-stat svelte-1lvz8ob">Peak Hour</div> <div class="col-top-poster svelte-1lvz8ob">Top Poster</div>',Ct,kt,Ye,Ae,we,Et,Je=new Date(o[0].lastUpdated).toLocaleString()+"",Ze,se,Dt,qt,Q=o[1]==="messages"&&xt(o),X=o[1]==="members"&&es(o),Y=o[1]==="activity"&&ts(o),He=Xt(o[5]),K=[];for(let f=0;f<He.length;f+=1)K[f]=ls($t(o,He,f));let q=o[5].length>0&&o[5][0].activityByDay.length>0&&as(o);return{c(){t=v("div"),s=v("div"),a=v("div"),i=v("div"),i.innerHTML=c,T=b(),u=v("div"),p=v("div"),g=E(h),U=b(),_=v("div"),_.textContent=w,z=b(),D=v("div"),J=E(R),j=E(" active in last 7 days"),C=b(),V=v("div"),A=v("div"),A.innerHTML=I,M=b(),S=v("div"),H=v("div"),oe=E(ae),F=b(),ee=v("div"),ee.textContent=B,G=b(),P=v("div"),y=E(O),de=E(" including deleted"),re=b(),$=v("div"),x=v("div"),x.innerHTML=Ke,Le=b(),te=v("div"),fe=v("div"),ze=E(pe),at=b(),Ce=v("div"),Ce.textContent=Bt,ot=b(),ke=v("div"),rt=E(Nt),it=E(" avg per channel"),nt=b(),me=v("div"),Ee=v("div"),Ee.innerHTML=Ut,vt=b(),ue=v("div"),De=v("div"),Xe=E(We),ct=E("%"),dt=b(),ye=v("div"),ye.textContent=Ot,ut=b(),Ve=v("div"),Ve.textContent=Rt,ht=b(),be=v("div"),ge=v("div"),Ie=v("h2"),Ie.textContent=jt,ft=b(),he=v("div"),ie=v("button"),pt=E(`Messages
              `),Q&&Q.c(),_t=b(),ne=v("button"),mt=E(`Members
              `),X&&X.c(),bt=b(),ve=v("button"),gt=E(`Activity
              `),Y&&Y.c(),zt=b(),_e=v("div"),Me=v("div"),Me.innerHTML=Ft,Ct=b();for(let f=0;f<K.length;f+=1)K[f].c();kt=b(),q&&q.c(),Ye=b(),Ae=v("div"),we=v("span"),Et=E("Last updated: "),Ze=E(Je),this.h()},l(f){t=n(f,"DIV",{class:!0});var L=d(t);s=n(L,"DIV",{class:!0});var N=d(s);a=n(N,"DIV",{class:!0});var Pe=d(a);i=n(Pe,"DIV",{class:!0,"data-svelte-h":!0}),Z(i)!=="svelte-1d460y5"&&(i.innerHTML=c),T=m(Pe),u=n(Pe,"DIV",{class:!0});var Be=d(u);p=n(Be,"DIV",{class:!0});var Gt=d(p);g=k(Gt,h),Gt.forEach(r),U=m(Be),_=n(Be,"DIV",{class:!0,"data-svelte-h":!0}),Z(_)!=="svelte-kmoo3u"&&(_.textContent=w),z=m(Be),D=n(Be,"DIV",{class:!0});var yt=d(D);J=k(yt,R),j=k(yt," active in last 7 days"),yt.forEach(r),Be.forEach(r),Pe.forEach(r),C=m(N),V=n(N,"DIV",{class:!0});var $e=d(V);A=n($e,"DIV",{class:!0,"data-svelte-h":!0}),Z(A)!=="svelte-jgo8fo"&&(A.innerHTML=I),M=m($e),S=n($e,"DIV",{class:!0});var Ne=d(S);H=n(Ne,"DIV",{class:!0});var Kt=d(H);oe=k(Kt,ae),Kt.forEach(r),F=m(Ne),ee=n(Ne,"DIV",{class:!0,"data-svelte-h":!0}),Z(ee)!=="svelte-1h50s8y"&&(ee.textContent=B),G=m(Ne),P=n(Ne,"DIV",{class:!0});var Vt=d(P);y=k(Vt,O),de=k(Vt," including deleted"),Vt.forEach(r),Ne.forEach(r),$e.forEach(r),re=m(N),$=n(N,"DIV",{class:!0});var xe=d($);x=n(xe,"DIV",{class:!0,"data-svelte-h":!0}),Z(x)!=="svelte-1y6t97o"&&(x.innerHTML=Ke),Le=m(xe),te=n(xe,"DIV",{class:!0});var Ue=d(te);fe=n(Ue,"DIV",{class:!0});var Wt=d(fe);ze=k(Wt,pe),Wt.forEach(r),at=m(Ue),Ce=n(Ue,"DIV",{class:!0,"data-svelte-h":!0}),Z(Ce)!=="svelte-1bt02cg"&&(Ce.textContent=Bt),ot=m(Ue),ke=n(Ue,"DIV",{class:!0});var It=d(ke);rt=k(It,Nt),it=k(It," avg per channel"),It.forEach(r),Ue.forEach(r),xe.forEach(r),nt=m(N),me=n(N,"DIV",{class:!0});var et=d(me);Ee=n(et,"DIV",{class:!0,"data-svelte-h":!0}),Z(Ee)!=="svelte-1wtw24s"&&(Ee.innerHTML=Ut),vt=m(et),ue=n(et,"DIV",{class:!0});var Oe=d(ue);De=n(Oe,"DIV",{class:!0});var Mt=d(De);Xe=k(Mt,We),ct=k(Mt,"%"),Mt.forEach(r),dt=m(Oe),ye=n(Oe,"DIV",{class:!0,"data-svelte-h":!0}),Z(ye)!=="svelte-e2rgmf"&&(ye.textContent=Ot),ut=m(Oe),Ve=n(Oe,"DIV",{class:!0,"data-svelte-h":!0}),Z(Ve)!=="svelte-1r2kldg"&&(Ve.textContent=Rt),Oe.forEach(r),et.forEach(r),N.forEach(r),ht=m(L),be=n(L,"DIV",{class:!0});var tt=d(be);ge=n(tt,"DIV",{class:!0});var st=d(ge);Ie=n(st,"H2",{class:!0,"data-svelte-h":!0}),Z(Ie)!=="svelte-1p1nxo2"&&(Ie.textContent=jt),ft=m(st),he=n(st,"DIV",{class:!0});var Re=d(he);ie=n(Re,"BUTTON",{class:!0});var wt=d(ie);pt=k(wt,`Messages
              `),Q&&Q.l(wt),wt.forEach(r),_t=m(Re),ne=n(Re,"BUTTON",{class:!0});var Pt=d(ne);mt=k(Pt,`Members
              `),X&&X.l(Pt),Pt.forEach(r),bt=m(Re),ve=n(Re,"BUTTON",{class:!0});var Tt=d(ve);gt=k(Tt,`Activity
              `),Y&&Y.l(Tt),Tt.forEach(r),Re.forEach(r),st.forEach(r),zt=m(tt),_e=n(tt,"DIV",{class:!0});var lt=d(_e);Me=n(lt,"DIV",{class:!0,"data-svelte-h":!0}),Z(Me)!=="svelte-j9vcbj"&&(Me.innerHTML=Ft),Ct=m(lt);for(let Lt=0;Lt<K.length;Lt+=1)K[Lt].l(lt);lt.forEach(r),tt.forEach(r),kt=m(L),q&&q.l(L),Ye=m(L),Ae=n(L,"DIV",{class:!0});var Jt=d(Ae);we=n(Jt,"SPAN",{class:!0});var St=d(we);Et=k(St,"Last updated: "),Ze=k(St,Je),St.forEach(r),Jt.forEach(r),L.forEach(r),this.h()},h(){l(i,"class","metric-icon channels svelte-1lvz8ob"),l(p,"class","metric-value svelte-1lvz8ob"),l(_,"class","metric-label svelte-1lvz8ob"),l(D,"class","metric-detail svelte-1lvz8ob"),l(u,"class","metric-content svelte-1lvz8ob"),l(a,"class","metric-card svelte-1lvz8ob"),l(A,"class","metric-icon messages svelte-1lvz8ob"),l(H,"class","metric-value svelte-1lvz8ob"),l(ee,"class","metric-label svelte-1lvz8ob"),l(P,"class","metric-detail svelte-1lvz8ob"),l(S,"class","metric-content svelte-1lvz8ob"),l(V,"class","metric-card svelte-1lvz8ob"),l(x,"class","metric-icon users svelte-1lvz8ob"),l(fe,"class","metric-value svelte-1lvz8ob"),l(Ce,"class","metric-label svelte-1lvz8ob"),l(ke,"class","metric-detail svelte-1lvz8ob"),l(te,"class","metric-content svelte-1lvz8ob"),l($,"class","metric-card svelte-1lvz8ob"),l(Ee,"class","metric-icon engagement svelte-1lvz8ob"),l(De,"class","metric-value svelte-1lvz8ob"),l(ye,"class","metric-label svelte-1lvz8ob"),l(Ve,"class","metric-detail svelte-1lvz8ob"),l(ue,"class","metric-content svelte-1lvz8ob"),l(me,"class","metric-card svelte-1lvz8ob"),l(s,"class","global-metrics svelte-1lvz8ob"),l(Ie,"class","svelte-1lvz8ob"),l(ie,"class","sort-button svelte-1lvz8ob"),je(ie,"active",o[1]==="messages"),l(ne,"class","sort-button svelte-1lvz8ob"),je(ne,"active",o[1]==="members"),l(ve,"class","sort-button svelte-1lvz8ob"),je(ve,"active",o[1]==="activity"),l(he,"class","sort-controls svelte-1lvz8ob"),l(ge,"class","section-header svelte-1lvz8ob"),l(Me,"class","table-header svelte-1lvz8ob"),l(_e,"class","channel-table svelte-1lvz8ob"),l(be,"class","section svelte-1lvz8ob"),l(we,"class","last-updated svelte-1lvz8ob"),l(Ae,"class","stats-footer svelte-1lvz8ob"),l(t,"class","stats-content svelte-1lvz8ob")},m(f,L){le(f,t,L),e(t,s),e(s,a),e(a,i),e(a,T),e(a,u),e(u,p),e(p,g),e(u,U),e(u,_),e(u,z),e(u,D),e(D,J),e(D,j),e(s,C),e(s,V),e(V,A),e(V,M),e(V,S),e(S,H),e(H,oe),e(S,F),e(S,ee),e(S,G),e(S,P),e(P,y),e(P,de),e(s,re),e(s,$),e($,x),e($,Le),e($,te),e(te,fe),e(fe,ze),e(te,at),e(te,Ce),e(te,ot),e(te,ke),e(ke,rt),e(ke,it),e(s,nt),e(s,me),e(me,Ee),e(me,vt),e(me,ue),e(ue,De),e(De,Xe),e(De,ct),e(ue,dt),e(ue,ye),e(ue,ut),e(ue,Ve),e(t,ht),e(t,be),e(be,ge),e(ge,Ie),e(ge,ft),e(ge,he),e(he,ie),e(ie,pt),Q&&Q.m(ie,null),e(he,_t),e(he,ne),e(ne,mt),X&&X.m(ne,null),e(he,bt),e(he,ve),e(ve,gt),Y&&Y.m(ve,null),e(be,zt),e(be,_e),e(_e,Me),e(_e,Ct);for(let N=0;N<K.length;N+=1)K[N]&&K[N].m(_e,null);e(t,kt),q&&q.m(t,null),e(t,Ye),e(t,Ae),e(Ae,we),e(we,Et),e(we,Ze),se=!0,Dt||(qt=[Fe(ie,"click",o[11]),Fe(ne,"click",o[12]),Fe(ve,"click",o[13])],Dt=!0)},p(f,L){if((!se||L&1)&&h!==(h=ce(f[0].totalChannels)+"")&&W(g,h),(!se||L&1)&&R!==(R=f[0].activeChannels+"")&&W(J,R),(!se||L&1)&&ae!==(ae=ce(f[0].totalMessages)+"")&&W(oe,ae),(!se||L&1)&&pe!==(pe=ce(f[0].totalUsers)+"")&&W(ze,pe),(!se||L&1)&&We!==(We=(f[0].totalChannels===0?"0":(f[0].activeChannels/f[0].totalChannels*100).toFixed(0))+"")&&W(Xe,We),f[1]==="messages"?Q?Q.p(f,L):(Q=xt(f),Q.c(),Q.m(ie,null)):Q&&(Q.d(1),Q=null),(!se||L&2)&&je(ie,"active",f[1]==="messages"),f[1]==="members"?X?X.p(f,L):(X=es(f),X.c(),X.m(ne,null)):X&&(X.d(1),X=null),(!se||L&2)&&je(ne,"active",f[1]==="members"),f[1]==="activity"?Y?Y.p(f,L):(Y=ts(f),Y.c(),Y.m(ve,null)):Y&&(Y.d(1),Y=null),(!se||L&2)&&je(ve,"active",f[1]==="activity"),L&32){He=Xt(f[5]);let N;for(N=0;N<He.length;N+=1){const Pe=$t(f,He,N);K[N]?K[N].p(Pe,L):(K[N]=ls(Pe),K[N].c(),K[N].m(_e,null))}for(;N<K.length;N+=1)K[N].d(1);K.length=He.length}f[5].length>0&&f[5][0].activityByDay.length>0?q?(q.p(f,L),L&32&&Ge(q,1)):(q=as(f),q.c(),Ge(q,1),q.m(t,Ye)):q&&(is(),Qe(q,1,1,()=>{q=null}),rs()),(!se||L&1)&&Je!==(Je=new Date(f[0].lastUpdated).toLocaleString()+"")&&W(Ze,Je)},i(f){se||(Ge(q),se=!0)},o(f){Qe(q),se=!1},d(f){f&&r(t),Q&&Q.d(),X&&X.d(),Y&&Y.d(),us(K,f),q&&q.d(),Dt=!1,os(qt)}}}function Ds(o){let t,s,a,i,c,T="Retry",u,p;return{c(){t=v("div"),s=v("p"),a=E(o[4]),i=b(),c=v("button"),c.textContent=T,this.h()},l(h){t=n(h,"DIV",{class:!0});var g=d(t);s=n(g,"P",{class:!0});var U=d(s);a=k(U,o[4]),U.forEach(r),i=m(g),c=n(g,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(c)!=="svelte-17bkin7"&&(c.textContent=T),g.forEach(r),this.h()},h(){l(s,"class","error-message svelte-1lvz8ob"),l(c,"class","retry-button svelte-1lvz8ob"),l(t,"class","error-state svelte-1lvz8ob")},m(h,g){le(h,t,g),e(t,s),e(s,a),e(t,i),e(t,c),u||(p=Fe(c,"click",o[6]),u=!0)},p(h,g){g&16&&W(a,h[4])},i:qe,o:qe,d(h){h&&r(t),u=!1,p()}}}function ys(o){let t,s='<div class="spinner svelte-1lvz8ob"></div> <p>Loading platform statistics...</p>';return{c(){t=v("div"),t.innerHTML=s,this.h()},l(a){t=n(a,"DIV",{class:!0,"data-svelte-h":!0}),Z(t)!=="svelte-kzwwaj"&&(t.innerHTML=s),this.h()},h(){l(t,"class","loading-state svelte-1lvz8ob")},m(a,i){le(a,t,i)},p:qe,i:qe,o:qe,d(a){a&&r(t)}}}function xt(o){let t,s=o[2]==="desc"?"↓":"↑",a;return{c(){t=v("span"),a=E(s),this.h()},l(i){t=n(i,"SPAN",{class:!0});var c=d(t);a=k(c,s),c.forEach(r),this.h()},h(){l(t,"class","sort-arrow svelte-1lvz8ob")},m(i,c){le(i,t,c),e(t,a)},p(i,c){c&4&&s!==(s=i[2]==="desc"?"↓":"↑")&&W(a,s)},d(i){i&&r(t)}}}function es(o){let t,s=o[2]==="desc"?"↓":"↑",a;return{c(){t=v("span"),a=E(s),this.h()},l(i){t=n(i,"SPAN",{class:!0});var c=d(t);a=k(c,s),c.forEach(r),this.h()},h(){l(t,"class","sort-arrow svelte-1lvz8ob")},m(i,c){le(i,t,c),e(t,a)},p(i,c){c&4&&s!==(s=i[2]==="desc"?"↓":"↑")&&W(a,s)},d(i){i&&r(t)}}}function ts(o){let t,s=o[2]==="desc"?"↓":"↑",a;return{c(){t=v("span"),a=E(s),this.h()},l(i){t=n(i,"SPAN",{class:!0});var c=d(t);a=k(c,s),c.forEach(r),this.h()},h(){l(t,"class","sort-arrow svelte-1lvz8ob")},m(i,c){le(i,t,c),e(t,a)},p(i,c){c&4&&s!==(s=i[2]==="desc"?"↓":"↑")&&W(a,s)},d(i){i&&r(t)}}}function Vs(o){let t,s="N/A";return{c(){t=v("span"),t.textContent=s,this.h()},l(a){t=n(a,"SPAN",{class:!0,"data-svelte-h":!0}),Z(t)!=="svelte-1xu032k"&&(t.textContent=s),this.h()},h(){l(t,"class","text-muted svelte-1lvz8ob")},m(a,i){le(a,t,i)},p:qe,d(a){a&&r(t)}}}function Is(o){let t,s,a,i=(o[16].topPosters[0].name||`${o[16].topPosters[0].pubkey.slice(0,8)}...`)+"",c,T,u,p,h=o[16].topPosters[0].messageCount+"",g,U,_=o[16].topPosters[0].avatar&&ss(o);return{c(){t=v("div"),_&&_.c(),s=b(),a=v("span"),c=E(i),T=b(),u=v("span"),p=E("("),g=E(h),U=E(")"),this.h()},l(w){t=n(w,"DIV",{class:!0});var z=d(t);_&&_.l(z),s=m(z),a=n(z,"SPAN",{});var D=d(a);c=k(D,i),D.forEach(r),T=m(z),u=n(z,"SPAN",{class:!0});var R=d(u);p=k(R,"("),g=k(R,h),U=k(R,")"),R.forEach(r),z.forEach(r),this.h()},h(){l(u,"class","poster-count svelte-1lvz8ob"),l(t,"class","top-poster svelte-1lvz8ob")},m(w,z){le(w,t,z),_&&_.m(t,null),e(t,s),e(t,a),e(a,c),e(t,T),e(t,u),e(u,p),e(u,g),e(u,U)},p(w,z){w[16].topPosters[0].avatar?_?_.p(w,z):(_=ss(w),_.c(),_.m(t,s)):_&&(_.d(1),_=null),z&32&&i!==(i=(w[16].topPosters[0].name||`${w[16].topPosters[0].pubkey.slice(0,8)}...`)+"")&&W(c,i),z&32&&h!==(h=w[16].topPosters[0].messageCount+"")&&W(g,h)},d(w){w&&r(t),_&&_.d()}}}function ss(o){let t,s;return{c(){t=v("img"),this.h()},l(a){t=n(a,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){Qt(t.src,s=o[16].topPosters[0].avatar)||l(t,"src",s),l(t,"alt",""),l(t,"class","poster-avatar-small svelte-1lvz8ob")},m(a,i){le(a,t,i)},p(a,i){i&32&&!Qt(t.src,s=a[16].topPosters[0].avatar)&&l(t,"src",s)},d(a){a&&r(t)}}}function ls(o){let t,s,a,i=o[16].channelId.slice(0,16)+"",c,T,u,p,h,g=ce(o[16].messageCount)+"",U,_,w,z,D=ce(o[16].uniquePosters)+"",R,J,j,C,V=o[16].avgMessagesPerDay.toFixed(1)+"",A,I,M,S=o[16].peakHour+"",H,ae,oe,F,ee;function B(O,y){return O[16].topPosters[0]?Is:Vs}let G=B(o),P=G(o);return{c(){t=v("div"),s=v("div"),a=v("div"),c=E(i),T=E("..."),u=b(),p=v("div"),h=v("strong"),U=E(g),_=b(),w=v("div"),z=v("strong"),R=E(D),J=b(),j=v("div"),C=v("strong"),A=E(V),I=b(),M=v("div"),H=E(S),ae=E(":00"),oe=b(),F=v("div"),P.c(),ee=b(),this.h()},l(O){t=n(O,"DIV",{class:!0});var y=d(t);s=n(y,"DIV",{class:!0});var de=d(s);a=n(de,"DIV",{class:!0});var re=d(a);c=k(re,i),T=k(re,"..."),re.forEach(r),de.forEach(r),u=m(y),p=n(y,"DIV",{class:!0});var $=d(p);h=n($,"STRONG",{});var x=d(h);U=k(x,g),x.forEach(r),$.forEach(r),_=m(y),w=n(y,"DIV",{class:!0});var Ke=d(w);z=n(Ke,"STRONG",{});var Le=d(z);R=k(Le,D),Le.forEach(r),Ke.forEach(r),J=m(y),j=n(y,"DIV",{class:!0});var te=d(j);C=n(te,"STRONG",{});var fe=d(C);A=k(fe,V),fe.forEach(r),te.forEach(r),I=m(y),M=n(y,"DIV",{class:!0});var pe=d(M);H=k(pe,S),ae=k(pe,":00"),pe.forEach(r),oe=m(y),F=n(y,"DIV",{class:!0});var ze=d(F);P.l(ze),ze.forEach(r),ee=m(y),y.forEach(r),this.h()},h(){l(a,"class","channel-id svelte-1lvz8ob"),l(s,"class","col-channel svelte-1lvz8ob"),l(p,"class","col-stat svelte-1lvz8ob"),l(w,"class","col-stat svelte-1lvz8ob"),l(j,"class","col-stat svelte-1lvz8ob"),l(M,"class","col-stat svelte-1lvz8ob"),l(F,"class","col-top-poster svelte-1lvz8ob"),l(t,"class","table-row svelte-1lvz8ob")},m(O,y){le(O,t,y),e(t,s),e(s,a),e(a,c),e(a,T),e(t,u),e(t,p),e(p,h),e(h,U),e(t,_),e(t,w),e(w,z),e(z,R),e(t,J),e(t,j),e(j,C),e(C,A),e(t,I),e(t,M),e(M,H),e(M,ae),e(t,oe),e(t,F),P.m(F,null),e(t,ee)},p(O,y){y&32&&i!==(i=O[16].channelId.slice(0,16)+"")&&W(c,i),y&32&&g!==(g=ce(O[16].messageCount)+"")&&W(U,g),y&32&&D!==(D=ce(O[16].uniquePosters)+"")&&W(R,D),y&32&&V!==(V=O[16].avgMessagesPerDay.toFixed(1)+"")&&W(A,V),y&32&&S!==(S=O[16].peakHour+"")&&W(H,S),G===(G=B(O))&&P?P.p(O,y):(P.d(1),P=G(O),P&&(P.c(),P.m(F,null)))},d(O){O&&r(t),P.d()}}}function as(o){let t,s,a="Platform Activity Trend",i,c,T;return c=new Cs({props:{data:o[5][0].activityByDay,days:30,height:300}}),{c(){t=v("div"),s=v("h2"),s.textContent=a,i=b(),bs(c.$$.fragment),this.h()},l(u){t=n(u,"DIV",{class:!0});var p=d(t);s=n(p,"H2",{class:!0,"data-svelte-h":!0}),Z(s)!=="svelte-25o3vf"&&(s.textContent=a),i=m(p),ms(c.$$.fragment,p),p.forEach(r),this.h()},h(){l(s,"class","svelte-1lvz8ob"),l(t,"class","section svelte-1lvz8ob")},m(u,p){le(u,t,p),e(t,s),e(t,i),_s(c,t,null),T=!0},p(u,p){const h={};p&32&&(h.data=u[5][0].activityByDay),c.$set(h)},i(u){T||(Ge(c.$$.fragment,u),T=!0)},o(u){Qe(c.$$.fragment,u),T=!1},d(u){u&&r(t),ps(c)}}}function Ms(o){let t,s,a,i,c='<h1 class="svelte-1lvz8ob">Platform Statistics</h1> <p class="subtitle svelte-1lvz8ob">Comprehensive analytics for all channels</p>',T,u,p,h,g,U,_,w,z,D,R,J,j,C,V,A,I,M,S,H,ae;const oe=[ys,Ds,Es],F=[];function ee(B,G){return B[3]?0:B[4]?1:B[0]?2:-1}return~(I=ee(o))&&(M=F[I]=oe[I](o)),{c(){t=b(),s=v("div"),a=v("div"),i=v("div"),i.innerHTML=c,T=b(),u=v("div"),p=v("button"),h=Se("svg"),g=Se("path"),U=Se("path"),_=E(`
        Refresh`),w=b(),z=v("button"),D=Se("svg"),R=Se("path"),J=Se("polyline"),j=Se("line"),C=E(`
        Export CSV`),A=b(),M&&M.c(),this.h()},l(B){vs("svelte-bmu1xn",Zt.head).forEach(r),t=m(B),s=n(B,"DIV",{class:!0});var P=d(s);a=n(P,"DIV",{class:!0});var O=d(a);i=n(O,"DIV",{class:!0,"data-svelte-h":!0}),Z(i)!=="svelte-ap9gjh"&&(i.innerHTML=c),T=m(O),u=n(O,"DIV",{class:!0});var y=d(u);p=n(y,"BUTTON",{class:!0});var de=d(p);h=Te(de,"svg",{width:!0,height:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0});var re=d(h);g=Te(re,"path",{d:!0}),d(g).forEach(r),U=Te(re,"path",{d:!0}),d(U).forEach(r),re.forEach(r),_=k(de,`
        Refresh`),de.forEach(r),w=m(y),z=n(y,"BUTTON",{class:!0});var $=d(z);D=Te($,"svg",{width:!0,height:!0,viewBox:!0,fill:!0,stroke:!0,"stroke-width":!0});var x=d(D);R=Te(x,"path",{d:!0}),d(R).forEach(r),J=Te(x,"polyline",{points:!0}),d(J).forEach(r),j=Te(x,"line",{x1:!0,y1:!0,x2:!0,y2:!0}),d(j).forEach(r),x.forEach(r),C=k($,`
        Export CSV`),$.forEach(r),y.forEach(r),O.forEach(r),A=m(P),M&&M.l(P),P.forEach(r),this.h()},h(){Zt.title="Platform Statistics - Admin",l(i,"class","header-content svelte-1lvz8ob"),l(g,"d","M23 4v6h-6M1 20v-6h6"),l(U,"d","M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"),l(h,"width","16"),l(h,"height","16"),l(h,"viewBox","0 0 24 24"),l(h,"fill","none"),l(h,"stroke","currentColor"),l(h,"stroke-width","2"),l(p,"class","refresh-button svelte-1lvz8ob"),p.disabled=o[3],l(R,"d","M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"),l(J,"points","7 10 12 15 17 10"),l(j,"x1","12"),l(j,"y1","15"),l(j,"x2","12"),l(j,"y2","3"),l(D,"width","16"),l(D,"height","16"),l(D,"viewBox","0 0 24 24"),l(D,"fill","none"),l(D,"stroke","currentColor"),l(D,"stroke-width","2"),l(z,"class","export-button svelte-1lvz8ob"),z.disabled=V=!o[0],l(u,"class","header-actions svelte-1lvz8ob"),l(a,"class","page-header svelte-1lvz8ob"),l(s,"class","admin-stats-page svelte-1lvz8ob")},m(B,G){le(B,t,G),le(B,s,G),e(s,a),e(a,i),e(a,T),e(a,u),e(u,p),e(p,h),e(h,g),e(h,U),e(p,_),e(u,w),e(u,z),e(z,D),e(D,R),e(D,J),e(D,j),e(z,C),e(s,A),~I&&F[I].m(s,null),S=!0,H||(ae=[Fe(p,"click",o[6]),Fe(z,"click",o[8])],H=!0)},p(B,[G]){(!S||G&8)&&(p.disabled=B[3]),(!S||G&1&&V!==(V=!B[0]))&&(z.disabled=V);let P=I;I=ee(B),I===P?~I&&F[I].p(B,G):(M&&(is(),Qe(F[P],1,1,()=>{F[P]=null}),rs()),~I?(M=F[I],M?M.p(B,G):(M=F[I]=oe[I](B),M.c()),Ge(M,1),M.m(s,null)):M=null)},i(B){S||(Ge(M),S=!0)},o(B){Qe(M),S=!1},d(B){B&&(r(t),r(s)),~I&&F[I].d(),H=!1,os(ae)}}}function ce(o){return o.toLocaleString()}function ws(o,t,s){let a,i;cs(o,Yt,C=>s(15,i=C));let c=null,T=!1,u=null,p=!1,h="messages",g="desc";ds(async()=>{if(await Yt.waitForReady(),!i.publicKey){At(`${Ht}/`);return}try{if(p=(await Promise.race([ks(i.publicKey),new Promise(V=>setTimeout(()=>V(void 0),8e3))]))?.isAdmin??!1,!p){s(4,u="Access denied: Admin privileges required"),setTimeout(()=>At(`${Ht}/chat`),2e3);return}U()}catch(C){console.error("Failed to verify admin status:",C),s(4,u="Failed to verify admin privileges"),setTimeout(()=>At(`${Ht}/chat`),2e3)}});async function U(){s(3,T=!0),s(4,u=null);try{s(0,c=await zs.getPlatformStats())}catch(C){s(4,u=C instanceof Error?C.message:"Failed to load statistics"),console.error("Failed to load platform stats:",C)}finally{s(3,T=!1)}}function _(C){h===C?s(2,g=g==="desc"?"asc":"desc"):(s(1,h=C),s(2,g="desc"))}async function w(){if(!c)return;const C=["Channel ID","Messages","Members","Avg Messages/Day","Peak Hour","Top Poster","Top Poster Messages"],V=c.channelStats.map(H=>[H.channelId,H.messageCount.toString(),H.uniquePosters.toString(),H.avgMessagesPerDay.toFixed(2),H.peakHour.toString(),H.topPosters[0]?.name||H.topPosters[0]?.pubkey.slice(0,16)||"N/A",H.topPosters[0]?.messageCount.toString()||"0"]),A=[C.join(","),...V.map(H=>H.join(","))].join(`
`),I=new Blob([A],{type:"text/csv"}),M=URL.createObjectURL(I),S=document.createElement("a");S.href=M,S.download=`platform-stats-${new Date().toISOString().split("T")[0]}.csv`,S.click(),URL.revokeObjectURL(M)}function z(){return c?c.channelStats.reduce((C,V)=>C+V.messageCount,0):0}function D(){return!c||c.totalChannels===0?0:c.channelStats.reduce((V,A)=>V+A.uniquePosters,0)/c.totalChannels}const R=()=>_("messages"),J=()=>_("members"),j=()=>_("activity");return o.$$.update=()=>{o.$$.dirty&7&&s(5,a=c?.channelStats?[...c.channelStats].sort((C,V)=>{let A,I;switch(h){case"messages":A=C.messageCount,I=V.messageCount;break;case"members":A=C.uniquePosters,I=V.uniquePosters;break;case"activity":A=C.avgMessagesPerDay,I=V.avgMessagesPerDay;break}return g==="desc"?I-A:A-I}):[])},[c,h,g,T,u,a,U,_,w,z,D,R,J,j]}class Rs extends hs{constructor(t){super(),fs(this,t,ws,Ms,ns,{})}}export{Rs as component};
