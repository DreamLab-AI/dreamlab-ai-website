const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./DxD0Wn3l.js","./CmsKOCeN.js","./xKPZ-4ZK.js","./0ZVSoAEn.js","./BToyndCo.js"])))=>i.map(i=>d[i]);
import{w as he,d as je}from"./xKPZ-4ZK.js";import{B as Fe,s as be,n as me,d as f,i as C,g as S,x as te,j as N,C as Ke,r as pe,P as Te,b as c,q as P,l as u,c as w,e as _,o as x,h as k,Z as We,a as le,f as se,t as ae,u as R,v as V,w as Ue,K as Ze,A as ee,L as Qe,p as Xe}from"./0ZVSoAEn.js";import{_ as $e}from"./CmsKOCeN.js";import{S as ve,i as _e,t as Q,a as J,g as xe,c as Je,d as ge,m as we,b as ke,e as ye,f as et}from"./DKVmOqaf.js";import{profileCache as ze}from"./D7m-JnSU.js";import{g as Ye}from"./9tEgXtNp.js";import{A as tt}from"./CxHM64pP.js";import{c as lt,m as Be}from"./B4OHgsDO.js";import{j as st}from"./DxD0Wn3l.js";const Ge="Nostr-BBS-settings",at="wss://dreamlab-nostr-relay.solitary-paper-764d.workers.dev";function Me(){return at}function ue(){return{relayMode:"private",privateRelayUrl:Me(),federatedRelays:["wss://relay.damus.io","wss://relay.nostr.band","wss://nos.lol","wss://relay.primal.net"]}}function nt(){try{const s=localStorage.getItem(Ge);if(s){const e=JSON.parse(s);return{...ue(),...e,privateRelayUrl:Me()}}}catch(s){console.error("Failed to load settings:",s)}return ue()}function ie(s){try{localStorage.setItem(Ge,JSON.stringify(s))}catch(e){console.error("Failed to save settings:",e)}}function rt(){const{subscribe:s,set:e,update:t}=he(ue());return e(nt()),{subscribe:s,setRelayMode:l=>{t(a=>{const n={...a,relayMode:l};return ie(n),n})},setPrivateRelayUrl:l=>{t(a=>{const n={...a,privateRelayUrl:l};return ie(n),n})},setFederatedRelays:l=>{t(a=>{const n={...a,federatedRelays:l};return ie(n),n})},reset:()=>{const l=ue();e(l),ie(l)}}}const it=rt();function qt(){const s=Fe(it);return s.relayMode==="private"?[Me()]:s.federatedRelays}const ut={channels:[],messages:{},selectedChannelId:null,joinRequests:[],isLoading:!1},j=he(ut);function ot(){return Fe(j)}const Ht={subscribe:j.subscribe,setChannels:s=>{j.update(e=>({...e,channels:s}))},addChannel:s=>{j.update(e=>({...e,channels:[...e.channels,s]}))},selectChannel:s=>{j.update(e=>({...e,selectedChannelId:s}))},setMessages:(s,e)=>{j.update(t=>({...t,messages:{...t.messages,[s]:e}}))},addMessage:s=>{j.update(e=>{const t=e.messages[s.channelId]||[];return{...e,messages:{...e.messages,[s.channelId]:[...t,s]}}})},deleteMessage:(s,e)=>{j.update(t=>({...t,messages:{...t.messages,[s]:(t.messages[s]||[]).filter(l=>l.id!==e)}}))},requestJoin:(s,e)=>{const t={channelId:s,requesterPubkey:e,status:"pending",createdAt:Date.now()};j.update(l=>({...l,joinRequests:[...l.joinRequests,t]}))},getMemberStatus:(s,e)=>{if(!e)return"non-member";const l=ot().channels.find(a=>a.id===s);return l?l.admins.includes(e)?"admin":l.members.includes(e)?"member":l.pendingRequests.includes(e)?"pending":"non-member":"non-member"},approveMember:(s,e)=>{j.update(t=>({...t,channels:t.channels.map(l=>l.id!==s?l:{...l,members:l.members.includes(e)?l.members:[...l.members,e],pendingRequests:l.pendingRequests.filter(a=>a!==e)})}))},setLoading:s=>{j.update(e=>({...e,isLoading:s}))}};let ce=null,de=null;function ft(){return ce||(ce=je(j,s=>s.channels.find(e=>e.id===s.selectedChannelId)||null)),ce}function ct(){return de||($e(async()=>{const{authStore:s}=await import("./DxD0Wn3l.js").then(e=>e.aa);return{authStore:s}},__vite__mapDeps([0,1,2,3,4]),import.meta.url).then(({authStore:s})=>{const e=ft();de=je([e,s],([t,l])=>{if(!t||!l.publicKey)return"non-member";const a=l.publicKey;return t.admins.includes(a)?"admin":t.members.includes(a)?"member":t.pendingRequests.includes(a)?"pending":"non-member"})}),he("non-member"))}const Pt={subscribe:s=>ct().subscribe(s)};function dt(s){let e,t,l,a;function n(o,d){return o[5]?bt:ht}let r=n(s),i=r(s);return{c(){e=k("button"),i.c(),this.h()},l(o){e=w(o,"BUTTON",{class:!0});var d=_(e);i.l(d),d.forEach(f),this.h()},h(){u(e,"class",t="btn "+(s[5]?"btn-error":"btn-ghost")+" btn-sm")},m(o,d){C(o,e,d),i.m(e,null),l||(a=P(e,"click",s[6]),l=!0)},p(o,d){r!==(r=n(o))&&(i.d(1),i=r(o),i&&(i.c(),i.m(e,null))),d&32&&t!==(t="btn "+(o[5]?"btn-error":"btn-ghost")+" btn-sm")&&u(e,"class",t)},d(o){o&&f(e),i.d(),l=!1,a()}}}function mt(s){let e,t,l,a,n;function r(v,h){return v[5]?vt:pt}let i=r(s),o=i(s),d=s[1]&&Ie(s);return{c(){e=k("button"),o.c(),t=N(),d&&d.c(),this.h()},l(v){e=w(v,"BUTTON",{class:!0,"aria-label":!0});var h=_(e);o.l(h),t=S(h),d&&d.l(h),h.forEach(f),this.h()},h(){u(e,"class","btn btn-ghost btn-xs"),u(e,"aria-label",l=s[5]?"Unmute user":"Mute user")},m(v,h){C(v,e,h),o.m(e,null),c(e,t),d&&d.m(e,null),a||(n=P(e,"click",s[6]),a=!0)},p(v,h){i!==(i=r(v))&&(o.d(1),o=i(v),o&&(o.c(),o.m(e,t))),v[1]?d?d.p(v,h):(d=Ie(v),d.c(),d.m(e,null)):d&&(d.d(1),d=null),h&32&&l!==(l=v[5]?"Unmute user":"Mute user")&&u(e,"aria-label",l)},d(v){v&&f(e),o.d(),d&&d.d(),a=!1,n()}}}function ht(s){let e,t,l,a,n,r="Mute User";return{c(){e=V("svg"),t=V("path"),l=V("path"),a=N(),n=k("span"),n.textContent=r,this.h()},l(i){e=R(i,"svg",{xmlns:!0,class:!0,viewBox:!0,fill:!0});var o=_(e);t=R(o,"path",{d:!0}),_(t).forEach(f),l=R(o,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),_(l).forEach(f),o.forEach(f),a=S(i),n=w(i,"SPAN",{"data-svelte-h":!0}),x(n)!=="svelte-1m9o542"&&(n.textContent=r),this.h()},h(){u(t,"d","M10 12a2 2 0 100-4 2 2 0 000 4z"),u(l,"fill-rule","evenodd"),u(l,"d","M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z"),u(l,"clip-rule","evenodd"),u(e,"xmlns","http://www.w3.org/2000/svg"),u(e,"class","h-5 w-5"),u(e,"viewBox","0 0 20 20"),u(e,"fill","currentColor")},m(i,o){C(i,e,o),c(e,t),c(e,l),C(i,a,o),C(i,n,o)},d(i){i&&(f(e),f(a),f(n))}}}function bt(s){let e,t,l,a,n,r="Unmute User";return{c(){e=V("svg"),t=V("path"),l=V("path"),a=N(),n=k("span"),n.textContent=r,this.h()},l(i){e=R(i,"svg",{xmlns:!0,class:!0,viewBox:!0,fill:!0});var o=_(e);t=R(o,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),_(t).forEach(f),l=R(o,"path",{d:!0}),_(l).forEach(f),o.forEach(f),a=S(i),n=w(i,"SPAN",{"data-svelte-h":!0}),x(n)!=="svelte-1smeqx1"&&(n.textContent=r),this.h()},h(){u(t,"fill-rule","evenodd"),u(t,"d","M3.707 2.293a1 1 0 00-1.414 1.414l14 14a1 1 0 001.414-1.414l-1.473-1.473A10.014 10.014 0 0019.542 10C18.268 5.943 14.478 3 10 3a9.958 9.958 0 00-4.512 1.074l-1.78-1.781zm4.261 4.26l1.514 1.515a2.003 2.003 0 012.45 2.45l1.514 1.514a4 4 0 00-5.478-5.478z"),u(t,"clip-rule","evenodd"),u(l,"d","M12.454 16.697L9.75 13.992a4 4 0 01-3.742-3.741L2.335 6.578A9.98 9.98 0 00.458 10c1.274 4.057 5.065 7 9.542 7 .847 0 1.669-.105 2.454-.303z"),u(e,"xmlns","http://www.w3.org/2000/svg"),u(e,"class","h-5 w-5"),u(e,"viewBox","0 0 20 20"),u(e,"fill","currentColor")},m(i,o){C(i,e,o),c(e,t),c(e,l),C(i,a,o),C(i,n,o)},d(i){i&&(f(e),f(a),f(n))}}}function pt(s){let e,t,l;return{c(){e=V("svg"),t=V("path"),l=V("path"),this.h()},l(a){e=R(a,"svg",{xmlns:!0,class:!0,viewBox:!0,fill:!0});var n=_(e);t=R(n,"path",{d:!0}),_(t).forEach(f),l=R(n,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),_(l).forEach(f),n.forEach(f),this.h()},h(){u(t,"d","M10 12a2 2 0 100-4 2 2 0 000 4z"),u(l,"fill-rule","evenodd"),u(l,"d","M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z"),u(l,"clip-rule","evenodd"),u(e,"xmlns","http://www.w3.org/2000/svg"),u(e,"class","h-4 w-4"),u(e,"viewBox","0 0 20 20"),u(e,"fill","currentColor")},m(a,n){C(a,e,n),c(e,t),c(e,l)},d(a){a&&f(e)}}}function vt(s){let e,t,l;return{c(){e=V("svg"),t=V("path"),l=V("path"),this.h()},l(a){e=R(a,"svg",{xmlns:!0,class:!0,viewBox:!0,fill:!0});var n=_(e);t=R(n,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),_(t).forEach(f),l=R(n,"path",{d:!0}),_(l).forEach(f),n.forEach(f),this.h()},h(){u(t,"fill-rule","evenodd"),u(t,"d","M3.707 2.293a1 1 0 00-1.414 1.414l14 14a1 1 0 001.414-1.414l-1.473-1.473A10.014 10.014 0 0019.542 10C18.268 5.943 14.478 3 10 3a9.958 9.958 0 00-4.512 1.074l-1.78-1.781zm4.261 4.26l1.514 1.515a2.003 2.003 0 012.45 2.45l1.514 1.514a4 4 0 00-5.478-5.478z"),u(t,"clip-rule","evenodd"),u(l,"d","M12.454 16.697L9.75 13.992a4 4 0 01-3.742-3.741L2.335 6.578A9.98 9.98 0 00.458 10c1.274 4.057 5.065 7 9.542 7 .847 0 1.669-.105 2.454-.303z"),u(e,"xmlns","http://www.w3.org/2000/svg"),u(e,"class","h-4 w-4"),u(e,"viewBox","0 0 20 20"),u(e,"fill","currentColor")},m(a,n){C(a,e,n),c(e,t),c(e,l)},d(a){a&&f(e)}}}function Ie(s){let e,t=s[5]?"Unmute":"Mute",l;return{c(){e=k("span"),l=ae(t),this.h()},l(a){e=w(a,"SPAN",{class:!0});var n=_(e);l=se(n,t),n.forEach(f),this.h()},h(){u(e,"class","ml-1")},m(a,n){C(a,e,n),c(e,l)},p(a,n){n&32&&t!==(t=a[5]?"Unmute":"Mute")&&le(l,t)},d(a){a&&f(e)}}}function Ae(s){let e,t,l,a="Mute User",n,r,i="Are you sure you want to mute this user? You won't see their messages, DMs, or notifications.",o,d,v,h='<span class="label-text">Reason (optional)</span>',b,E,D,m,p,M="Cancel",g,T,y="Mute User",K,U,X,$;return{c(){e=k("div"),t=k("div"),l=k("h3"),l.textContent=a,n=N(),r=k("p"),r.textContent=i,o=N(),d=k("div"),v=k("label"),v.innerHTML=h,b=N(),E=k("input"),D=N(),m=k("div"),p=k("button"),p.textContent=M,g=N(),T=k("button"),T.textContent=y,K=N(),U=k("div"),this.h()},l(z){e=w(z,"DIV",{class:!0});var B=_(e);t=w(B,"DIV",{class:!0});var F=_(t);l=w(F,"H3",{class:!0,"data-svelte-h":!0}),x(l)!=="svelte-toefa9"&&(l.textContent=a),n=S(F),r=w(F,"P",{class:!0,"data-svelte-h":!0}),x(r)!=="svelte-2x92m8"&&(r.textContent=i),o=S(F),d=w(F,"DIV",{class:!0});var Y=_(d);v=w(Y,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),x(v)!=="svelte-ortkjm"&&(v.innerHTML=h),b=S(Y),E=w(Y,"INPUT",{id:!0,type:!0,placeholder:!0,class:!0}),Y.forEach(f),D=S(F),m=w(F,"DIV",{class:!0});var H=_(m);p=w(H,"BUTTON",{class:!0,"data-svelte-h":!0}),x(p)!=="svelte-b4k9mk"&&(p.textContent=M),g=S(H),T=w(H,"BUTTON",{class:!0,"data-svelte-h":!0}),x(T)!=="svelte-t8h8jt"&&(T.textContent=y),H.forEach(f),F.forEach(f),K=S(B),U=w(B,"DIV",{class:!0}),_(U).forEach(f),B.forEach(f),this.h()},h(){u(l,"class","font-bold text-lg"),u(r,"class","py-4"),u(v,"class","label"),u(v,"for","mute-reason"),u(E,"id","mute-reason"),u(E,"type","text"),u(E,"placeholder","Why are you muting this user?"),u(E,"class","input input-bordered"),u(d,"class","form-control"),u(p,"class","btn btn-ghost"),u(T,"class","btn btn-error"),u(m,"class","modal-action"),u(t,"class","modal-box"),u(U,"class","modal-backdrop svelte-1jdm9d6"),u(e,"class","modal modal-open")},m(z,B){C(z,e,B),c(e,t),c(t,l),c(t,n),c(t,r),c(t,o),c(t,d),c(d,v),c(d,b),c(d,E),Te(E,s[3]),c(t,D),c(t,m),c(m,p),c(m,g),c(m,T),c(e,K),c(e,U),X||($=[P(E,"input",s[10]),P(p,"click",s[8]),P(T,"click",s[7]),P(U,"click",s[8])],X=!0)},p(z,B){B&8&&E.value!==z[3]&&Te(E,z[3])},d(z){z&&f(e),X=!1,pe($)}}}function _t(s){let e,t;function l(i,o){return i[0]?mt:dt}let a=l(s),n=a(s),r=s[2]&&Ae(s);return{c(){n.c(),e=N(),r&&r.c(),t=te()},l(i){n.l(i),e=S(i),r&&r.l(i),t=te()},m(i,o){n.m(i,o),C(i,e,o),r&&r.m(i,o),C(i,t,o)},p(i,[o]){a===(a=l(i))&&n?n.p(i,o):(n.d(1),n=a(i),n&&(n.c(),n.m(e.parentNode,e))),i[2]?r?r.p(i,o):(r=Ae(i),r.c(),r.m(t.parentNode,t)):r&&(r.d(1),r=null)},i:me,o:me,d(i){i&&(f(e),f(t)),n.d(i),r&&r.d(i)}}}function gt(s,e,t){let l,a,n=me,r=()=>(n(),n=We(l,M=>t(5,a=M)),l);s.$$.on_destroy.push(()=>n());let{pubkey:i}=e,{compact:o=!1}=e,{showLabel:d=!0}=e;const v=Ke();let h=!1,b="";function E(){a?(Be.unmuteUser(i),v("unmuted")):t(2,h=!0)}function D(){Be.muteUser(i,b||void 0),t(2,h=!1),t(3,b=""),v("muted")}function m(){t(2,h=!1),t(3,b="")}function p(){b=this.value,t(3,b)}return s.$$set=M=>{"pubkey"in M&&t(9,i=M.pubkey),"compact"in M&&t(0,o=M.compact),"showLabel"in M&&t(1,d=M.showLabel)},s.$$.update=()=>{s.$$.dirty&512&&r(t(4,l=lt(i)))},[o,d,h,b,l,a,E,D,m,i,p]}class wt extends ve{constructor(e){super(),_e(this,e,gt,_t,be,{pubkey:9,compact:0,showLabel:1})}}function Re(s){let e,t,l,a='<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg>',n,r,i,o,d,v,h,b,E,D,m,p,M,g,T,y,K,U,X='<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor"><path d="M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z"></path><path d="M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z"></path></svg>',$,z,B,F=`<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"></path><path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"></path></svg>
            Send DM`,Y,H,oe,W,G,fe,Ee,I=s[3]&&Ve(s),A=s[2]&&qe(s);return H=new wt({props:{pubkey:s[1],compact:!1}}),{c(){e=k("div"),t=k("div"),l=k("button"),l.innerHTML=a,n=N(),r=k("div"),i=k("div"),o=k("div"),d=k("img"),h=N(),b=k("h2"),E=ae(s[5]),D=N(),I&&I.c(),m=N(),A&&A.c(),p=N(),M=k("div"),g=k("div"),T=k("code"),y=ae(s[6]),K=N(),U=k("button"),U.innerHTML=X,$=N(),z=k("div"),B=k("button"),B.innerHTML=F,Y=N(),ye(H.$$.fragment),oe=N(),W=k("div"),this.h()},l(L){e=w(L,"DIV",{class:!0,role:!0,"aria-modal":!0,"aria-labelledby":!0});var q=_(e);t=w(q,"DIV",{class:!0});var Z=_(t);l=w(Z,"BUTTON",{class:!0,"aria-label":!0,"data-svelte-h":!0}),x(l)!=="svelte-fl45yq"&&(l.innerHTML=a),n=S(Z),r=w(Z,"DIV",{class:!0});var O=_(r);i=w(O,"DIV",{class:!0});var Ce=_(i);o=w(Ce,"DIV",{class:!0});var Se=_(o);d=w(Se,"IMG",{src:!0,alt:!0}),Se.forEach(f),Ce.forEach(f),h=S(O),b=w(O,"H2",{id:!0,class:!0});var Ne=_(b);E=se(Ne,s[5]),Ne.forEach(f),D=S(O),I&&I.l(O),m=S(O),A&&A.l(O),p=S(O),M=w(O,"DIV",{class:!0});var Le=_(M);g=w(Le,"DIV",{class:!0});var ne=_(g);T=w(ne,"CODE",{class:!0});var De=_(T);y=se(De,s[6]),De.forEach(f),K=S(ne),U=w(ne,"BUTTON",{class:!0,"aria-label":!0,"data-svelte-h":!0}),x(U)!=="svelte-135sd9z"&&(U.innerHTML=X),ne.forEach(f),Le.forEach(f),$=S(O),z=w(O,"DIV",{class:!0});var re=_(z);B=w(re,"BUTTON",{class:!0,"data-svelte-h":!0}),x(B)!=="svelte-13u28ox"&&(B.innerHTML=F),Y=S(re),ke(H.$$.fragment,re),re.forEach(f),O.forEach(f),Z.forEach(f),oe=S(q),W=w(q,"DIV",{class:!0,"aria-hidden":!0}),_(W).forEach(f),q.forEach(f),this.h()},h(){u(l,"class","btn btn-sm btn-circle btn-ghost absolute right-2 top-2"),u(l,"aria-label","Close user profile"),Ue(d.src,v=s[4])||u(d,"src",v),u(d,"alt",s[5]),u(o,"class","w-24 h-24 rounded-full ring ring-primary ring-offset-base-100 ring-offset-2"),u(i,"class","avatar mb-4"),u(b,"id","user-profile-modal-title"),u(b,"class","text-2xl font-bold mb-1"),u(T,"class","text-xs flex-1 truncate"),u(U,"class","btn btn-ghost btn-xs"),u(U,"aria-label","Copy npub"),u(g,"class","flex items-center gap-2 bg-base-200 rounded-lg p-3"),u(M,"class","w-full px-4 mb-4"),u(B,"class","btn btn-primary"),u(z,"class","flex flex-wrap gap-2 justify-center"),u(r,"class","flex flex-col items-center py-6"),u(t,"class","modal-box max-w-2xl"),u(W,"class","modal-backdrop svelte-1jdm9d6"),u(W,"aria-hidden","true"),u(e,"class","modal modal-open"),u(e,"role","dialog"),u(e,"aria-modal","true"),u(e,"aria-labelledby","user-profile-modal-title")},m(L,q){C(L,e,q),c(e,t),c(t,l),c(t,n),c(t,r),c(r,i),c(i,o),c(o,d),c(r,h),c(r,b),c(b,E),c(r,D),I&&I.m(r,null),c(r,m),A&&A.m(r,null),c(r,p),c(r,M),c(M,g),c(g,T),c(T,y),c(g,K),c(g,U),c(r,$),c(r,z),c(z,B),c(z,Y),we(H,z,null),c(e,oe),c(e,W),G=!0,fe||(Ee=[P(l,"click",s[7]),P(U,"click",s[12]),P(B,"click",s[8]),P(W,"click",s[7]),P(e,"keydown",s[9])],fe=!0)},p(L,q){(!G||q&16&&!Ue(d.src,v=L[4]))&&u(d,"src",v),(!G||q&32)&&u(d,"alt",L[5]),(!G||q&32)&&le(E,L[5]),L[3]?I?I.p(L,q):(I=Ve(L),I.c(),I.m(r,m)):I&&(I.d(1),I=null),L[2]?A?A.p(L,q):(A=qe(L),A.c(),A.m(r,p)):A&&(A.d(1),A=null),(!G||q&64)&&le(y,L[6]);const Z={};q&2&&(Z.pubkey=L[1]),H.$set(Z)},i(L){G||(J(H.$$.fragment,L),G=!0)},o(L){Q(H.$$.fragment,L),G=!1},d(L){L&&f(e),I&&I.d(),A&&A.d(),ge(H),fe=!1,pe(Ee)}}}function Ve(s){let e,t,l,a,n;return{c(){e=k("div"),t=V("svg"),l=V("path"),a=N(),n=ae(s[3]),this.h()},l(r){e=w(r,"DIV",{class:!0});var i=_(e);t=R(i,"svg",{xmlns:!0,class:!0,viewBox:!0,fill:!0});var o=_(t);l=R(o,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),_(l).forEach(f),o.forEach(f),a=S(i),n=se(i,s[3]),i.forEach(f),this.h()},h(){u(l,"fill-rule","evenodd"),u(l,"d","M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"),u(l,"clip-rule","evenodd"),u(t,"xmlns","http://www.w3.org/2000/svg"),u(t,"class","h-3 w-3"),u(t,"viewBox","0 0 20 20"),u(t,"fill","currentColor"),u(e,"class","badge badge-success gap-2 mb-3")},m(r,i){C(r,e,i),c(e,t),c(t,l),c(e,a),c(e,n)},p(r,i){i&8&&le(n,r[3])},d(r){r&&f(e)}}}function qe(s){let e,t;return{c(){e=k("p"),t=ae(s[2]),this.h()},l(l){e=w(l,"P",{class:!0});var a=_(e);t=se(a,s[2]),a.forEach(f),this.h()},h(){u(e,"class","text-base-content/80 text-center mb-4 px-4")},m(l,a){C(l,e,a),c(e,t)},p(l,a){a&4&&le(t,l[2])},d(l){l&&f(e)}}}function kt(s){let e,t,l=s[0]&&Re(s);return{c(){l&&l.c(),e=te()},l(a){l&&l.l(a),e=te()},m(a,n){l&&l.m(a,n),C(a,e,n),t=!0},p(a,[n]){a[0]?l?(l.p(a,n),n&1&&J(l,1)):(l=Re(a),l.c(),J(l,1),l.m(e.parentNode,e)):l&&(xe(),Q(l,1,1,()=>{l=null}),Je())},i(a){t||(J(l),t=!0)},o(a){Q(l),t=!1},d(a){a&&f(e),l&&l.d(a)}}}function yt(s){navigator.clipboard.writeText(s)}function Mt(s,e,t){let l,a,n,{pubkey:r}=e,{name:i=null}=e,{avatar:o=null}=e,{about:d=null}=e,{nip05:v=null}=e,{show:h=!1}=e;const b=Ke();let E=null;function D(){t(0,h=!1),b("close"),E&&(E.focus(),E=null)}function m(){b("startDM",{pubkey:r}),D()}function p(g){if(g.key==="Escape"&&D(),g.key==="Tab"){const T=document.querySelector(".modal.modal-open");if(!T)return;const y=T.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),K=y[0],U=y[y.length-1];g.shiftKey&&document.activeElement===K?(g.preventDefault(),U.focus()):!g.shiftKey&&document.activeElement===U&&(g.preventDefault(),K.focus())}}const M=()=>yt(l);return s.$$set=g=>{"pubkey"in g&&t(1,r=g.pubkey),"name"in g&&t(10,i=g.name),"avatar"in g&&t(11,o=g.avatar),"about"in g&&t(2,d=g.about),"nip05"in g&&t(3,v=g.nip05),"show"in g&&t(0,h=g.show)},s.$$.update=()=>{s.$$.dirty&2&&t(6,l=st.npubEncode(r)),s.$$.dirty&1026&&t(5,a=i||`${r.slice(0,8)}...${r.slice(-4)}`),s.$$.dirty&2050&&t(4,n=o||Ye(r,80)),s.$$.dirty&1&&h&&typeof window<"u"&&(E=document.activeElement,setTimeout(()=>{const g=document.querySelector(".modal.modal-open button");g&&g.focus()},0))},[h,r,d,v,n,a,l,D,m,p,i,o,M]}class Et extends ve{constructor(e){super(),_e(this,e,Mt,kt,be,{pubkey:1,name:10,avatar:11,about:2,nip05:3,show:0})}}function He(s){let e,t;return e=new tt({props:{src:s[10],pubkey:s[0],size:s[2],alt:s[7]}}),{c(){ye(e.$$.fragment)},l(l){ke(e.$$.fragment,l)},m(l,a){we(e,l,a),t=!0},p(l,a){const n={};a&1024&&(n.src=l[10]),a&1&&(n.pubkey=l[0]),a&4&&(n.size=l[2]),a&128&&(n.alt=l[7]),e.$set(n)},i(l){t||(J(e.$$.fragment,l),t=!0)},o(l){Q(e.$$.fragment,l),t=!1},d(l){ge(e,l)}}}function Pe(s){let e,t,l,a,n=s[6]?.nip05&&Oe();return{c(){e=k("span"),t=ae(s[9]),l=N(),n&&n.c(),a=te(),this.h()},l(r){e=w(r,"SPAN",{class:!0});var i=_(e);t=se(i,s[9]),i.forEach(f),l=S(r),n&&n.l(r),a=te(),this.h()},h(){u(e,"class","user-name svelte-vf73on"),ee(e,"font-semibold",s[4])},m(r,i){C(r,e,i),c(e,t),C(r,l,i),n&&n.m(r,i),C(r,a,i)},p(r,i){i&512&&le(t,r[9]),i&16&&ee(e,"font-semibold",r[4]),r[6]?.nip05?n||(n=Oe(),n.c(),n.m(a.parentNode,a)):n&&(n.d(1),n=null)},d(r){r&&(f(e),f(l),f(a)),n&&n.d(r)}}}function Oe(s){let e,t;return{c(){e=V("svg"),t=V("path"),this.h()},l(l){e=R(l,"svg",{xmlns:!0,class:!0,viewBox:!0,fill:!0,"aria-label":!0});var a=_(e);t=R(a,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),_(t).forEach(f),a.forEach(f),this.h()},h(){u(t,"fill-rule","evenodd"),u(t,"d","M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"),u(t,"clip-rule","evenodd"),u(e,"xmlns","http://www.w3.org/2000/svg"),u(e,"class","h-4 w-4 text-success flex-shrink-0"),u(e,"viewBox","0 0 20 20"),u(e,"fill","currentColor"),u(e,"aria-label","Verified")},m(l,a){C(l,e,a),c(e,t)},d(l){l&&f(e)}}}function Ct(s){let e,t,l,a,n,r,i,o,d,v,h=s[1]&&He(s),b=s[3]&&Pe(s);function E(m){s[14](m)}let D={pubkey:s[0],name:s[6]?.displayName||null,avatar:s[6]?.avatar||null,about:s[6]?.about||null,nip05:s[6]?.nip05||null};return s[8]!==void 0&&(D.show=s[8]),r=new Et({props:D}),Ze.push(()=>et(r,"show",E)),r.$on("startDM",Nt),{c(){e=k("div"),h&&h.c(),t=N(),b&&b.c(),n=N(),ye(r.$$.fragment),this.h()},l(m){e=w(m,"DIV",{class:!0,role:!0,tabindex:!0});var p=_(e);h&&h.l(p),t=S(p),b&&b.l(p),p.forEach(f),n=S(m),ke(r.$$.fragment,m),this.h()},h(){u(e,"class","user-display inline-flex items-center gap-2 svelte-vf73on"),u(e,"role",l=s[5]?"button":"presentation"),u(e,"tabindex",a=s[5]?0:-1),ee(e,"cursor-pointer",s[5]),ee(e,"hover:opacity-80",s[5])},m(m,p){C(m,e,p),h&&h.m(e,null),c(e,t),b&&b.m(e,null),C(m,n,p),we(r,m,p),o=!0,d||(v=[P(e,"click",s[11]),P(e,"keydown",s[13])],d=!0)},p(m,[p]){m[1]?h?(h.p(m,p),p&2&&J(h,1)):(h=He(m),h.c(),J(h,1),h.m(e,t)):h&&(xe(),Q(h,1,1,()=>{h=null}),Je()),m[3]?b?b.p(m,p):(b=Pe(m),b.c(),b.m(e,null)):b&&(b.d(1),b=null),(!o||p&32&&l!==(l=m[5]?"button":"presentation"))&&u(e,"role",l),(!o||p&32&&a!==(a=m[5]?0:-1))&&u(e,"tabindex",a),(!o||p&32)&&ee(e,"cursor-pointer",m[5]),(!o||p&32)&&ee(e,"hover:opacity-80",m[5]);const M={};p&1&&(M.pubkey=m[0]),p&64&&(M.name=m[6]?.displayName||null),p&64&&(M.avatar=m[6]?.avatar||null),p&64&&(M.about=m[6]?.about||null),p&64&&(M.nip05=m[6]?.nip05||null),!i&&p&256&&(i=!0,M.show=m[8],Qe(()=>i=!1)),r.$set(M)},i(m){o||(J(h),J(r.$$.fragment,m),o=!0)},o(m){Q(h),Q(r.$$.fragment,m),o=!1},d(m){m&&(f(e),f(n)),h&&h.d(),b&&b.d(),ge(r,m),d=!1,pe(v)}}}function St(s){return s.length<=16?s:`${s.slice(0,8)}...${s.slice(-4)}`}function Nt(s){const e=new CustomEvent("startDM",{detail:{pubkey:s.detail.pubkey},bubbles:!0});window.dispatchEvent(e)}function Lt(s,e,t){let l,a,n,{pubkey:r}=e,{showAvatar:i=!0}=e,{avatarSize:o="md"}=e,{showName:d=!0}=e,{showFullName:v=!1}=e,{clickable:h=!1}=e,{maxNameLength:b=null}=e,E=null,D=null,m=!1;const p={xs:32,sm:48,md:64,lg:80};Xe(()=>(D=ze.subscribe(y=>{t(6,E=y.profiles.get(r)||null)}),ze.getProfile(r),()=>{D&&D()}));function M(){h&&t(8,m=!0)}const g=y=>y.key==="Enter"&&h&&M();function T(y){m=y,t(8,m)}return s.$$set=y=>{"pubkey"in y&&t(0,r=y.pubkey),"showAvatar"in y&&t(1,i=y.showAvatar),"avatarSize"in y&&t(2,o=y.avatarSize),"showName"in y&&t(3,d=y.showName),"showFullName"in y&&t(4,v=y.showFullName),"clickable"in y&&t(5,h=y.clickable),"maxNameLength"in y&&t(12,b=y.maxNameLength)},s.$$.update=()=>{s.$$.dirty&65&&t(7,l=E?.displayName||St(r)),s.$$.dirty&69&&t(10,a=E?.avatar||Ye(r,p[o])),s.$$.dirty&4224&&t(9,n=b&&l.length>b?l.slice(0,b)+"...":l)},[r,i,o,d,v,h,E,l,m,n,a,M,b,g,T]}class Ot extends ve{constructor(e){super(),_e(this,e,Lt,Ct,be,{pubkey:0,showAvatar:1,avatarSize:2,showName:3,showFullName:4,clickable:5,maxNameLength:12})}}export{Ot as U,Ht as c,qt as g,it as s,Pt as u};
